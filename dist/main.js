(()=>{"use strict";function e(e){const t=e.target.matches("[data-dropdown-button]");if(!t&&null!=e.target.closest("[data-dropdown]"))return;let n;t&&(function(e){const t=e.target.closest(".edit-container");if(null!=e.target.closest(".tile")){const e=document.querySelector("#project-option");e.classList.remove("hidden"),t.appendChild(e)}else if(null!=e.target.closest("li")){const e=document.getElementById("list-option");e.classList.remove("hidden"),t.appendChild(e)}}(e),n=e.target.closest("[data-dropdown]"),setTimeout((function(){n.classList.toggle("active")}),0)),document.querySelectorAll("[data-dropdown].active").forEach((e=>{e!==n&&e.classList.remove("active")}))}function t(e){let t=e.target.parentNode.parentNode,n=t.parentNode;!function(e){e.classList.remove("active")}(t),!0==!document.querySelector("#rename-form").classList.contains("hidden")&&(function(){const e=document.getElementById("rename-form"),t=document.querySelector(".project");e.classList.add("hidden"),t.appendChild(e)}(),document.querySelector("div.hidden").classList.remove("hidden")),function(e){const t=e.parentNode,n=document.getElementById("rename-form");let c=e.querySelector(".project-name").textContent;n.querySelector("input").value=c,t.insertBefore(n,e)}(n),function(){const e=document.querySelector("#rename-form");setTimeout((()=>{e.classList.remove("hidden")}),0)}(),document.querySelector(".project-rename-input").focus()}function n(e){let t=e.target.closest(".tile");if(t.dataset.project,t.classList.contains("selected")){const e=document.querySelector("#today"),t=e.querySelector("[data-name]");e.classList.add("selected"),l(t)}}function c(){const e=document.getElementById("project-option");e.classList.add("hidden"),document.querySelector(".project").appendChild(e);const t=document.querySelector("#list-option");t.classList.add("hidden"),document.querySelector(".list-todo").appendChild(t)}function o(e){return r.reduce(((t,n)=>{let c=n.taskList.find((t=>t.id==e));return null!=c&&(t=c),t}),{})}function d(){const e=document.querySelector("#list-form"),t=document.querySelector("#list-input"),n=document.querySelector("#list-input-detail"),c=document.querySelector("#list-input-date");e.classList.add("hidden"),t.value="",n.value="",c.value=""}let s=Number(localStorage.getItem("currentId"))||0;function l(e){document.querySelector(".title").textContent=e.textContent}function i(e,t,n,c,o,d){const s=document.querySelector("ul"),l=document.createElement("li");l.id=e,s.appendChild(l);const i=document.createElement("div");i.classList.add("unchecked"),l.appendChild(i);const r=document.createElement("div");r.classList.add("list-details"),l.appendChild(r),o&&(i.classList.toggle("checked"),r.classList.toggle("line-through"),r.classList.toggle("fade"));const a=document.createElement("div");a.classList.add("task-title"),a.textContent=t,r.appendChild(a);const u=document.createElement("div");u.classList.add("task-details"),u.textContent=n,r.appendChild(u);const p=document.createElement("div");p.classList.add("date"),p.textContent=c,l.appendChild(p);const f=document.createElement("div");f.classList.add("list-right"),l.appendChild(f);const h=m("star_outline");h.classList.add("star-outline"),f.appendChild(h);const g=m("star");g.classList.add("important"),f.appendChild(g),d?h.classList.add("list-hidden"):g.classList.add("list-hidden");const L=document.createElement("div");L.dataset.dropdown="",L.classList.add("edit-codatentainer"),f.appendChild(L);const y=m("more_vert");y.dataset.dropdownButton="",L.appendChild(y)}let r=localStorage.getItem("myProjectList");function a(){localStorage.setItem("myProjectList",JSON.stringify(r)),localStorage.setItem("currentId",s.toString())}function u(e,t){const n=document.querySelector(".project"),c=document.querySelector("#project-form"),o=document.createElement("div");o.setAttribute("data-project",`${e}`),o.classList.add("tile","data-tile"),n.insertBefore(o,c);const d=m("menu");d.setAttribute("data-drag",""),o.appendChild(d);const s=document.createElement("div");s.classList.add("project-info"),o.appendChild(s);const l=document.createElement("div");l.classList.add("project-name"),l.textContent=t,s.appendChild(l);const i=document.createElement("div");i.classList.add("edit-container"),i.setAttribute("data-dropdown",""),o.appendChild(i);const r=m("more_vert");r.setAttribute("data-dropdown-button",""),i.appendChild(r)}function m(e){const t=document.createElement("span");return t.classList.add("material-icons-round"),t.textContent=e,t}r=JSON.parse(r||JSON.stringify([]));const p=()=>document.querySelectorAll("[data-project]").length;const f=(e,t)=>{const n=[];return{dataProject:e,name:t,taskList:n,taskNum:n.length}};function h(){const e=document.querySelector("#project-form");document.querySelector("#project-input").value="",e.classList.add("hidden")}function g(e){document.querySelector(".selected").classList.remove("selected"),e.classList.add("selected")}document.querySelector(".project-cancel-btn").addEventListener("click",h),document.querySelector("#add-project").addEventListener("click",(function(){document.getElementById("project-form").classList.remove("hidden"),document.getElementById("project-input").focus()})),document.querySelector("#project-form").addEventListener("submit",(function(e){e.preventDefault();let t=document.querySelector("#project-input").value,n=p();const c=f(n,t);r.push(c),a(),u(n,t),h()})),document.querySelector(".left-panel").addEventListener("click",(function(e){let t=e.target.closest(".home .tile"),n=e.target.closest(".project .tile");if(null!=t){const e=t.querySelector("[data-name]");g(t),c(),l(e),document.querySelector("#add-list").classList.add("hidden")}else{if(null==n)return;{const e=n.querySelector(".project-name");let t=n.dataset.project;c(),function(e){document.querySelector("ul").textContent="",r[e].taskList.forEach((e=>{i(e.id,e.title,e.details,e.date,e.completed,e.important)}))}(t),g(n),l(e),document.getElementById("add-list").classList.remove("hidden")}}})),r.forEach((e=>{u(e.dataProject,e.name)})),document.querySelector("#add-list").addEventListener("click",(function(){document.querySelector("#list-form").classList.remove("hidden"),document.querySelector("#list-input").focus()})),document.querySelector(".list-cancel-btn").addEventListener("click",d),document.querySelector("#list-form").addEventListener("submit",(function(e){e.preventDefault();let t=document.querySelector("#list-input").value,n=document.querySelector("#list-input-detail").value,c=document.querySelector("#list-input-date").value,o=document.querySelector(".selected").dataset.project,l=function(e){let t;return t=e||"No due date",t}(c),u=s;const m=function(e,t,n,c,o,d,s){return{dataProject:e,id:t,title:n,details:c,completed:!1,important:!1,date:s}}(o,u,t,n,0,0,l);r[o].taskList.push(m),s++,a(),i(u,t,n,l),d()})),document.querySelector(".list-todo").addEventListener("click",(function(e){let t=e.target.matches(".star-outline"),n=e.target.matches(".unchecked");e.target.matches(".list-submit-btn"),e.target.matches(".list-cancel-btn"),e.target.matches("#list-delete"),e.target.matches("#list-edit")&&console.log("Yes that is true"),t?(function(e){e.target.classList.toggle("list-hidden"),e.target.nextElementSibling.classList.toggle("list-hidden")}(e),function(e){let t=o(e.target.closest("li").id);t.important=!t.important,a()}(e)):n&&(function(e){let t=e.target,n=e.target.closest("li").querySelector(".list-details");n.classList.toggle("line-through"),n.classList.toggle("fade"),t.classList.toggle("checked")}(e),function(e){let t=o(e.target.closest("li").id);t.completed=!t.completed,a()}(e))})),function(){document.addEventListener("click",e);const c=document.querySelector(".project .option");c.firstElementChild.addEventListener("click",t),c.lastElementChild.addEventListener("click",n)}(),document.querySelector(".hidden-menu").addEventListener("click",(()=>{document.querySelector(".left-panel").classList.toggle("hidden")}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cUcsaUJBQWlCLFFBQVM5RyxHQUVuQyxNQUFNc0ksRUFBUzdILFNBQVNDLGNBQWMsb0JBQ3RDNEgsRUFBT0Msa0JBQWtCekIsaUJBQWlCLFFBQVN4RixHQUNuRGdILEVBQU9FLGlCQUFpQjFCLGlCQUFpQixRQUFTckUsRUFDdEQsQ0lGQWdHLEdBRW1CaEksU0FBU0MsY0FBYyxnQkFDL0JvRyxpQkFBaUIsU0FBUyxLQUNmckcsU0FBU0MsY0FBYyxlQUMvQkMsVUFBVU8sT0FBTyxTQUFTLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90b2RvLWFwcC8uL3NyYy9lZGl0aW5nUHJvamVjdC5qcyIsIndlYnBhY2s6Ly90b2RvLWFwcC8uL3NyYy9lZGl0aW5nVGFzay5qcyIsIndlYnBhY2s6Ly90b2RvLWFwcC8uL3NyYy9jcmVhdGluZ1Rhc2suanMiLCJ3ZWJwYWNrOi8vdG9kby1hcHAvLi9zcmMvY3JlYXRpbmdQcm9qZWN0LmpzIiwid2VicGFjazovL3RvZG8tYXBwLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHByb2plY3RMaXN0LCBzYXZlVG9Mb2NhbFN0b3JhZ2UgfSBmcm9tIFwiLi9jcmVhdGluZ1Byb2plY3RcIlxuaW1wb3J0IHsgdXBkYXRlVGl0bGUgfSBmcm9tIFwiLi9jcmVhdGluZ1Rhc2tcIlxuXG5mdW5jdGlvbiBlZGl0Q29udGFpbmVyRXZlbnRMaXN0ZW5lcigpIHtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgc2hvd0Ryb3BEb3duKTtcblxuICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9qZWN0IC5vcHRpb24nKTtcbiAgICBvcHRpb24uZmlyc3RFbGVtZW50Q2hpbGQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzaG93UmVuYW1lRm9ybSk7XG4gICAgb3B0aW9uLmxhc3RFbGVtZW50Q2hpbGQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBkZWxldGVQcm9qZWN0KTtcbn1cblxuZnVuY3Rpb24gc2hvd0Ryb3BEb3duKGUpIHtcbiAgICBjb25zdCBpc0Ryb3BEb3duQnV0dG9uID0gZS50YXJnZXQubWF0Y2hlcygnW2RhdGEtZHJvcGRvd24tYnV0dG9uXScpO1xuICAgIGlmICghaXNEcm9wRG93bkJ1dHRvbiAmJiBlLnRhcmdldC5jbG9zZXN0KCdbZGF0YS1kcm9wZG93bl0nKSAhPSBudWxsKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgbGV0IGN1cnJlbnREcm9wRG93bjtcbiAgICBpZiAoaXNEcm9wRG93bkJ1dHRvbikge1xuICAgICAgICByZWxvY2F0ZU9wdGlvbihlKTtcbiAgICAgICAgY3VycmVudERyb3BEb3duID0gZS50YXJnZXQuY2xvc2VzdCgnW2RhdGEtZHJvcGRvd25dJyk7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjdXJyZW50RHJvcERvd24uY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJyk7XG4gICAgICAgIH0sIDApO1xuICAgIH1cblxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWRyb3Bkb3duXS5hY3RpdmUnKS5mb3JFYWNoKGRyb3Bkb3duID0+IHtcbiAgICAgICAgLy9pZiBjbGljayBhbnl3aGVyZSBlbHNlIGN1cnJlbnREcm9wRG93biA9IHVuZGVmaW5lZCBtZWFuaW5nIGFsbCBhY3RpdmUgb25lcyBhcmUgY2xvc2VkXG4gICAgICAgIGlmIChkcm9wZG93biA9PT0gY3VycmVudERyb3BEb3duKSB7IC8vaWYgaXRzIHRoZSBjdXJyZW50IGJ1dHRvbiB0aGVuIGRvIG50aFxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGRyb3Bkb3duLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIik7IC8vYmFzaWNhbGx5IGNsb3NlIGFsbCBkcm9wZG93biBvdGhlciBkcm9wIGRvd24gYmVmb3JlIG9wZW4gYW5vdGhlclxuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBzaG93UmVuYW1lRm9ybShlKSB7XG4gICAgbGV0IGVkaXRDb250YWluZXJOb2RlID0gZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlO1xuICAgIGxldCB0aWxlTm9kZSA9IGVkaXRDb250YWluZXJOb2RlLnBhcmVudE5vZGU7XG5cbiAgICBoaWRlRHJvcERvd24oZWRpdENvbnRhaW5lck5vZGUpO1xuICAgIGxldCBoYXZlRm9ybSA9IGNoZWNrRm9ybUV4aXN0KCk7XG4gICAgaWYgKGhhdmVGb3JtID09PSB0cnVlKSB7XG4gICAgICAgIHJldmVydFJlbmFtZUZvcm1Mb2NhdGlvbigpO1xuICAgICAgICBkaXNwbGF5UmVuYW1lZFByb2plY3QoKTtcbiAgICB9XG5cbiAgICByZWxvY2F0ZVJlbmFtZUZvcm0odGlsZU5vZGUpO1xuICAgIGFuaW1hdGVSZW5hbWVGb3JtKCk7XG5cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdC1yZW5hbWUtaW5wdXQnKS5mb2N1cygpO1xufVxuXG5mdW5jdGlvbiBoaWRlRHJvcERvd24oZWRpdENvbnRhaW5lck5vZGUpIHtcbiAgICBlZGl0Q29udGFpbmVyTm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbn1cblxuZnVuY3Rpb24gZGVsZXRlUHJvamVjdChlKSB7XG4gICAgbGV0IHRpbGUgPSBlLnRhcmdldC5jbG9zZXN0KCcudGlsZScpO1xuICAgIGxldCBpbmRleCA9IHRpbGUuZGF0YXNldC5wcm9qZWN0O1xuXG4gICAgaWYgKHRpbGUuY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpKSB7XG4gICAgICAgIGNvbnN0IHRvZGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN0b2RheVwiKTtcbiAgICAgICAgY29uc3QgbmFtZU5vZGUgPSB0b2RheS5xdWVyeVNlbGVjdG9yKFwiW2RhdGEtbmFtZV1cIik7XG5cbiAgICAgICAgdG9kYXkuY2xhc3NMaXN0LmFkZChcInNlbGVjdGVkXCIpO1xuICAgICAgICB1cGRhdGVUaXRsZShuYW1lTm9kZSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiByZXZlcnRPcHRpb25Mb2NhdGlvbigpIHtcbiAgICBjb25zdCBwcm9qZWN0T3B0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2plY3Qtb3B0aW9uJyk7XG4gICAgcHJvamVjdE9wdGlvbi5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xuICAgIGNvbnN0IHByb2plY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3RcIik7XG4gICAgcHJvamVjdC5hcHBlbmRDaGlsZChwcm9qZWN0T3B0aW9uKTtcbiAgICAvL3JldmVydCBvcHRpb24gRE9NIGluIHJpZ2h0IHBhbmVsXG4gICAgY29uc3QgbGlzdE9wdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbGlzdC1vcHRpb25cIik7XG4gICAgbGlzdE9wdGlvbi5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xuICAgIGNvbnN0IGxpc3RUb0RvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5saXN0LXRvZG9cIik7XG4gICAgbGlzdFRvRG8uYXBwZW5kQ2hpbGQobGlzdE9wdGlvbik7XG59XG5cbmZ1bmN0aW9uIHJlbG9jYXRlT3B0aW9uKGUpIHtcbiAgICBjb25zdCBlZGl0Q29udGFpbmVyID0gZS50YXJnZXQuY2xvc2VzdCgnLmVkaXQtY29udGFpbmVyJyk7XG5cbiAgICBpZiAoZS50YXJnZXQuY2xvc2VzdCgnLnRpbGUnKSAhPSBudWxsKSB7XG4gICAgICAgIGNvbnN0IHByb2plY3RPcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJvamVjdC1vcHRpb24nKTtcbiAgICAgICAgcHJvamVjdE9wdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICAgICAgZWRpdENvbnRhaW5lci5hcHBlbmRDaGlsZChwcm9qZWN0T3B0aW9uKTtcbiAgICB9IGVsc2UgaWYgKGUudGFyZ2V0LmNsb3Nlc3QoXCJsaVwiKSAhPSBudWxsKSB7IC8vcG9wIHVwIGluIGxpc3RcbiAgICAgICAgY29uc3QgbGlzdE9wdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibGlzdC1vcHRpb25cIik7XG4gICAgICAgIGxpc3RPcHRpb24uY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcbiAgICAgICAgZWRpdENvbnRhaW5lci5hcHBlbmRDaGlsZChsaXN0T3B0aW9uKTtcbiAgICB9XG5cbn1cblxuZnVuY3Rpb24gY2hlY2tGb3JtRXhpc3QoKSB7XG4gICAgY29uc3QgcmVuYW1lRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNyZW5hbWUtZm9ybScpO1xuXG4gICAgaWYgKHJlbmFtZUZvcm0uY2xhc3NMaXN0LmNvbnRhaW5zKCdoaWRkZW4nKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxufVxuXG4vL3JldmVydCBmb3JtIGJhY2sgdG8gaXRzIG9yaWdpbmFsIHBvc3RpbmcgdW5kZXIgLnByb2plY3RcbmZ1bmN0aW9uIHJldmVydFJlbmFtZUZvcm1Mb2NhdGlvbigpIHtcbiAgICBjb25zdCByZW5hbWVGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZW5hbWUtZm9ybVwiKTtcbiAgICBjb25zdCBwcm9qZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0XCIpO1xuXG4gICAgcmVuYW1lRm9ybS5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xuICAgIHByb2plY3QuYXBwZW5kQ2hpbGQocmVuYW1lRm9ybSk7XG59XG5cbmZ1bmN0aW9uIHJlbG9jYXRlUmVuYW1lRm9ybSh0aWxlTm9kZSkge1xuICAgIGNvbnN0IHByb2plY3ROb2RlID0gdGlsZU5vZGUucGFyZW50Tm9kZTtcbiAgICBjb25zdCByZW5hbWVGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlbmFtZS1mb3JtJyk7XG5cbiAgICBjb25zdCBuYW1lTm9kZSA9IHRpbGVOb2RlLnF1ZXJ5U2VsZWN0b3IoJy5wcm9qZWN0LW5hbWUnKTtcbiAgICBsZXQgbmFtZSA9IG5hbWVOb2RlLnRleHRDb250ZW50O1xuXG4gICAgY29uc3QgaW5wdXQgPSByZW5hbWVGb3JtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0Jyk7XG4gICAgaW5wdXQudmFsdWUgPSBuYW1lO1xuXG4gICAgcHJvamVjdE5vZGUuaW5zZXJ0QmVmb3JlKHJlbmFtZUZvcm0sIHRpbGVOb2RlKTtcbn1cblxuZnVuY3Rpb24gYW5pbWF0ZVJlbmFtZUZvcm0oKSB7XG4gICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNyZW5hbWUtZm9ybScpO1xuXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGZvcm0uY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG4gICAgfSwgMCk7XG59XG5cbmZ1bmN0aW9uIGRpc3BsYXlSZW5hbWVkUHJvamVjdCgpIHtcbiAgICBjb25zdCBoaWRkZW5UaWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZGl2LmhpZGRlbicpO1xuICAgIGhpZGRlblRpbGUuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG59XG5cbmZ1bmN0aW9uIHNvcnRBcnJheSgpIHtcblxufVxuXG5leHBvcnQgeyBlZGl0Q29udGFpbmVyRXZlbnRMaXN0ZW5lciwgc2hvd1JlbmFtZUZvcm0sIGhpZGVEcm9wRG93biwgZGVsZXRlUHJvamVjdCwgcmV2ZXJ0T3B0aW9uTG9jYXRpb24sIHNvcnRBcnJheSB9OyIsImltcG9ydCB7IHByb2plY3RMaXN0LCBzYXZlVG9Mb2NhbFN0b3JhZ2UgfSBmcm9tIFwiLi9jcmVhdGluZ1Byb2plY3RcIjtcbmltcG9ydCB7IGhpZGVEcm9wRG93biwgcmV2ZXJ0T3B0aW9uTG9jYXRpb24gfSBmcm9tIFwiLi9lZGl0aW5nUHJvamVjdFwiO1xuaW1wb3J0IHsgZGlzcGxheVRhc2ssIHByb2Nlc3NEYXRlRGF0YSB9IGZyb20gXCIuL2NyZWF0aW5nVGFza1wiO1xuaW1wb3J0IHsgY2hlY2tXaGljaEhvbWVUaWxlIH0gZnJvbSBcIi4vaG9tZVNlY3Rpb25cIjtcblxuZnVuY3Rpb24gc3R5bGVDb21wbGV0ZWRUYXNrKGUpIHtcbiAgICBsZXQgdW5jaGVja2VkTm9kZSA9IGUudGFyZ2V0O1xuICAgIGxldCB0YXNrVGlsZSA9IGUudGFyZ2V0LmNsb3Nlc3QoJ2xpJyk7XG4gICAgbGV0IGxpc3REZXRhaWxzID0gdGFza1RpbGUucXVlcnlTZWxlY3RvcignLmxpc3QtZGV0YWlscycpO1xuICAgIGxpc3REZXRhaWxzLmNsYXNzTGlzdC50b2dnbGUoJ2xpbmUtdGhyb3VnaCcpO1xuICAgIGxpc3REZXRhaWxzLmNsYXNzTGlzdC50b2dnbGUoJ2ZhZGUnKTtcbiAgICB1bmNoZWNrZWROb2RlLmNsYXNzTGlzdC50b2dnbGUoJ2NoZWNrZWQnKTtcblxufVxuXG5mdW5jdGlvbiB1cGRhdGVDb21wbGV0ZWRUYXNrKGUpIHtcbiAgICBsZXQgbGlzdElEID0gZS50YXJnZXQuY2xvc2VzdCgnbGknKS5pZDtcbiAgICBsZXQgc2VsZWN0ZWRUYXNrID0gZmluZFNlbGVjdGVkVGFzayhsaXN0SUQpO1xuICAgIHNlbGVjdGVkVGFzay5jb21wbGV0ZWQgPSAhc2VsZWN0ZWRUYXNrLmNvbXBsZXRlZDtcbiAgICBzYXZlVG9Mb2NhbFN0b3JhZ2UoKTtcbn1cblxuZnVuY3Rpb24gc3R5bGVJbXBvcnRhbnRUYXNrKGUpIHtcbiAgICBsZXQgc3Rhck91dGxpbmUgPSBlLnRhcmdldDtcbiAgICBzdGFyT3V0bGluZS5jbGFzc0xpc3QudG9nZ2xlKCdsaXN0LWhpZGRlbicpO1xuXG4gICAgbGV0IHN0YXJGaWxsZWQgPSBlLnRhcmdldC5uZXh0RWxlbWVudFNpYmxpbmc7XG4gICAgc3RhckZpbGxlZC5jbGFzc0xpc3QudG9nZ2xlKCdsaXN0LWhpZGRlbicpO1xuXG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUltcG9ydGFudFRhc2soZSkge1xuICAgIGxldCBsaXN0SWQgPSBlLnRhcmdldC5jbG9zZXN0KCdsaScpLmlkO1xuICAgIGxldCBzZWxlY3RlZFRhc2sgPSBmaW5kU2VsZWN0ZWRUYXNrKGxpc3RJZCk7XG4gICAgc2VsZWN0ZWRUYXNrLmltcG9ydGFudCA9ICFzZWxlY3RlZFRhc2suaW1wb3J0YW50O1xuICAgIHNhdmVUb0xvY2FsU3RvcmFnZSgpO1xufVxuXG5cblxuZnVuY3Rpb24gZGVsZXRlVGFzaygpIHtcblxufVxuXG5mdW5jdGlvbiBmaW5kU2VsZWN0ZWRUYXNrKGxpc3RJZCkge1xuICAgIGxldCBzZWxlY3RlZFRhc2sgPSBwcm9qZWN0TGlzdC5yZWR1Y2UoKGFjYywgcHJvamVjdCkgPT4ge1xuICAgICAgICBsZXQgY3VycmVudFRhc2sgPSBwcm9qZWN0LnRhc2tMaXN0LmZpbmQodGFzayA9PiB0YXNrLmlkID09IGxpc3RJZCk7XG4gICAgICAgIGlmIChjdXJyZW50VGFzayAhPSBudWxsKSB7XG4gICAgICAgICAgICBhY2MgPSBjdXJyZW50VGFzaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWNjO1xuICAgIH0sIHt9KTtcblxuICAgIHJldHVybiBzZWxlY3RlZFRhc2s7XG59XG5cbmZ1bmN0aW9uIHNob3dFZGl0Rm9ybSgpIHtcblxufVxuXG5mdW5jdGlvbiByZWxvY2F0ZUVkaXRMaXN0Rm9ybSgpIHtcblxufVxuXG5mdW5jdGlvbiByZXZlcnRFZGl0Rm9ybUxvY2F0aW9uKCkge1xuXG59XG5cbmZ1bmN0aW9uIHByb2Nlc3NFZGl0VGFzaygpIHtcblxufVxuXG5mdW5jdGlvbiBzaG93SGlkZGVuVGFzaygpIHtcblxufVxuXG5leHBvcnQge1xuICAgIHN0eWxlQ29tcGxldGVkVGFzayxcbiAgICBzdHlsZUltcG9ydGFudFRhc2ssXG4gICAgdXBkYXRlQ29tcGxldGVkVGFzayxcbiAgICB1cGRhdGVJbXBvcnRhbnRUYXNrLFxuICAgIGRlbGV0ZVRhc2ssXG4gICAgc2hvd0VkaXRGb3JtLFxuICAgIHJlbG9jYXRlRWRpdExpc3RGb3JtLFxuICAgIHJldmVydEVkaXRGb3JtTG9jYXRpb24sXG4gICAgcHJvY2Vzc0VkaXRUYXNrLFxuICAgIHNob3dIaWRkZW5UYXNrXG59IiwiaW1wb3J0IHsgcHJvamVjdExpc3QsIGNyZWF0ZVNwYW5JY29uLCBzYXZlVG9Mb2NhbFN0b3JhZ2UgfSBmcm9tIFwiLi9jcmVhdGluZ1Byb2plY3RcIlxuaW1wb3J0IHtcbiAgICBzdHlsZUNvbXBsZXRlZFRhc2ssXG4gICAgdXBkYXRlQ29tcGxldGVkVGFzayxcbiAgICBzdHlsZUltcG9ydGFudFRhc2ssXG4gICAgdXBkYXRlSW1wb3J0YW50VGFzayxcbiAgICBkZWxldGVUYXNrLFxuICAgIHNob3dFZGl0Rm9ybSxcbiAgICByZXZlcnRFZGl0Rm9ybUxvY2F0aW9uLFxuICAgIHByb2Nlc3NFZGl0VGFzayxcbiAgICBzaG93SGlkZGVuVGFza1xufSBmcm9tIFwiLi9lZGl0aW5nVGFza1wiXG5cbmZ1bmN0aW9uIGxpc3RFdmVudCgpIHtcbiAgICBjb25zdCBhZGRMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtbGlzdFwiKTtcbiAgICBhZGRMaXN0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBzaG93TGlzdEZvcm0pO1xuXG4gICAgY29uc3QgY2FuY2VsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxpc3QtY2FuY2VsLWJ0bicpO1xuICAgIGNhbmNlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGlkZUxpc3RGb3JtKTtcblxuICAgIGNvbnN0IGxpc3RTdWJtaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbGlzdC1mb3JtJyk7XG4gICAgbGlzdFN1Ym1pdC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBwcm9jZXNzTGlzdElucHV0KTtcblxuICAgIGNvbnN0IHRvZG9MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxpc3QtdG9kbycpO1xuICAgIHRvZG9MaXN0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjaGVja0xpc3RFdmVudCk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVRhc2soZGF0YVByb2plY3QsIGlkLCB0aXRsZSwgZGV0YWlscywgY29tcGxldGVkLCBpbXBvcnRhbnQsIGRhdGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBkYXRhUHJvamVjdCxcbiAgICAgICAgaWQsXG4gICAgICAgIHRpdGxlLFxuICAgICAgICBkZXRhaWxzLFxuICAgICAgICBjb21wbGV0ZWQ6IGNvbXBsZXRlZCxcbiAgICAgICAgaW1wb3J0YW50OiBpbXBvcnRhbnQsXG4gICAgICAgIGRhdGU6IGRhdGVcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGNoZWNrTGlzdEV2ZW50KGUpIHtcbiAgICBsZXQgaXNTdGFySWNvbiA9IGUudGFyZ2V0Lm1hdGNoZXMoJy5zdGFyLW91dGxpbmUnKTtcbiAgICBsZXQgaXNDaXJjbGVJY29uID0gZS50YXJnZXQubWF0Y2hlcygnLnVuY2hlY2tlZCcpO1xuXG4gICAgbGV0IGlzRWRpdFN1Ym1pdEJ0biA9IGUudGFyZ2V0Lm1hdGNoZXMoJy5saXN0LXN1Ym1pdC1idG4nKTtcbiAgICBsZXQgaXNFZGl0VGFza0NhbmNlbCA9IGUudGFyZ2V0Lm1hdGNoZXMoJy5saXN0LWNhbmNlbC1idG4nKTtcblxuICAgIGxldCBpc0RlbGV0ZUJ0biA9IGUudGFyZ2V0Lm1hdGNoZXMoJyNsaXN0LWRlbGV0ZScpO1xuICAgIGxldCBpc0VkaXRCdG4gPSBlLnRhcmdldC5tYXRjaGVzKCcjbGlzdC1lZGl0Jyk7XG5cbiAgICBpZiAoaXNFZGl0QnRuKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiWWVzIHRoYXQgaXMgdHJ1ZVwiKTtcbiAgICB9XG5cbiAgICBpZiAoaXNTdGFySWNvbikge1xuICAgICAgICBzdHlsZUltcG9ydGFudFRhc2soZSk7XG4gICAgICAgIHVwZGF0ZUltcG9ydGFudFRhc2soZSk7XG4gICAgfSBlbHNlIGlmIChpc0NpcmNsZUljb24pIHtcbiAgICAgICAgc3R5bGVDb21wbGV0ZWRUYXNrKGUpO1xuICAgICAgICB1cGRhdGVDb21wbGV0ZWRUYXNrKGUpO1xuICAgIH1cbn1cblxuXG5cbi8vcG9wIHVwIHRoZSBhZGQgbGlzdCBmb3JtXG5mdW5jdGlvbiBzaG93TGlzdEZvcm0oKSB7XG4gICAgY29uc3QgbGlzdEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbGlzdC1mb3JtJyk7XG4gICAgbGlzdEZvcm0uY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2xpc3QtaW5wdXQnKS5mb2N1cygpO1xufVxuXG4vL2hpZGUgdGhlIGFkZCBsaXN0IGZvcm1cbmZ1bmN0aW9uIGhpZGVMaXN0Rm9ybSgpIHtcbiAgICBjb25zdCBsaXN0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNsaXN0LWZvcm0nKTtcbiAgICBjb25zdCBsaXN0SW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbGlzdC1pbnB1dCcpO1xuICAgIGNvbnN0IGxpc3RJbnB1dERldGFpbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNsaXN0LWlucHV0LWRldGFpbCcpO1xuICAgIGNvbnN0IGxpc3RJbnB1dERhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbGlzdC1pbnB1dC1kYXRlJyk7XG5cbiAgICBsaXN0Rm9ybS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbiAgICBsaXN0SW5wdXQudmFsdWUgPSBcIlwiO1xuICAgIGxpc3RJbnB1dERldGFpbC52YWx1ZSA9IFwiXCI7XG4gICAgbGlzdElucHV0RGF0ZS52YWx1ZSA9IFwiXCI7XG59XG4vL2dldCBpZCBmcm9tIGxvY2FsIHN0b3JhZ2Ugb3IgZ2V0IGEgZGVmYXVsdCBvbmVcbmxldCBkZWZhdWx0SWQgPSAwO1xubGV0IGlkID0gTnVtYmVyKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiY3VycmVudElkXCIpKSB8fCBkZWZhdWx0SWQ7XG5cbmZ1bmN0aW9uIHByb2Nlc3NMaXN0SW5wdXQoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBsZXQgdGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbGlzdC1pbnB1dCcpLnZhbHVlO1xuICAgIGxldCBkZXRhaWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2xpc3QtaW5wdXQtZGV0YWlsJykudmFsdWU7XG4gICAgbGV0IGRhdGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNsaXN0LWlucHV0LWRhdGUnKS52YWx1ZTtcblxuICAgIGxldCBkYXRhUHJvamVjdCA9IGZpbmRDdXJyZW50RGF0YVByb2plY3QoKTtcbiAgICBsZXQgZGF0ZSA9IHByb2Nlc3NEYXRlRGF0YShkYXRlSW5wdXQpO1xuICAgIGxldCBsaXN0SUQgPSBpZDtcblxuICAgIGNvbnN0IG5ld1Rhc2sgPSBjcmVhdGVUYXNrKGRhdGFQcm9qZWN0LCBsaXN0SUQsIHRpdGxlLCBkZXRhaWxzLCBmYWxzZSwgZmFsc2UsIGRhdGUpO1xuICAgIHByb2plY3RMaXN0W2RhdGFQcm9qZWN0XS50YXNrTGlzdC5wdXNoKG5ld1Rhc2spO1xuICAgIGlkKys7XG4gICAgc2F2ZVRvTG9jYWxTdG9yYWdlKCk7XG5cbiAgICBhZGRUYXNrKGxpc3RJRCwgdGl0bGUsIGRldGFpbHMsIGRhdGUpO1xuICAgIGhpZGVMaXN0Rm9ybSgpO1xufVxuLy9kaXNwYXkgYWxsIHRoZSB0YXNrIGluIGEgcHJvamVjdFxuZnVuY3Rpb24gZGlzcGxheVRhc2soZGF0YVByb2plY3QpIHtcbiAgICBjb25zdCB1bCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJyk7XG4gICAgdWwudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIHByb2plY3RMaXN0W2RhdGFQcm9qZWN0XS50YXNrTGlzdC5mb3JFYWNoKHRhc2sgPT4ge1xuICAgICAgICBhZGRUYXNrKHRhc2suaWQsIHRhc2sudGl0bGUsIHRhc2suZGV0YWlscywgdGFzay5kYXRlLCB0YXNrLmNvbXBsZXRlZCwgdGFzay5pbXBvcnRhbnQpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVUaXRsZShuYW1lTm9kZSkge1xuICAgIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRpdGxlJyk7XG4gICAgdGl0bGUudGV4dENvbnRlbnQgPSBuYW1lTm9kZS50ZXh0Q29udGVudDtcbn1cblxuXG5cblxuXG5mdW5jdGlvbiBhZGRUYXNrKGxpc3RJZCwgdGl0bGUsIGRldGFpbHMsIGRhdGUsIGNvbXBsZXRlZCwgaW1wb3J0YW50KSB7XG4gICAgY29uc3QgdWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpO1xuICAgIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICBsaS5pZCA9IGxpc3RJZDtcbiAgICB1bC5hcHBlbmRDaGlsZChsaSk7XG5cbiAgICBjb25zdCB1bmNoZWNrZWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB1bmNoZWNrZWQuY2xhc3NMaXN0LmFkZCgndW5jaGVja2VkJyk7XG4gICAgbGkuYXBwZW5kQ2hpbGQodW5jaGVja2VkKTtcblxuICAgIGNvbnN0IGxpc3REZXRhaWxzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgbGlzdERldGFpbHMuY2xhc3NMaXN0LmFkZCgnbGlzdC1kZXRhaWxzJyk7XG4gICAgbGkuYXBwZW5kQ2hpbGQobGlzdERldGFpbHMpO1xuXG4gICAgaWYgKGNvbXBsZXRlZCkge1xuICAgICAgICB1bmNoZWNrZWQuY2xhc3NMaXN0LnRvZ2dsZSgnY2hlY2tlZCcpO1xuICAgICAgICBsaXN0RGV0YWlscy5jbGFzc0xpc3QudG9nZ2xlKCdsaW5lLXRocm91Z2gnKTtcbiAgICAgICAgbGlzdERldGFpbHMuY2xhc3NMaXN0LnRvZ2dsZSgnZmFkZScpO1xuICAgIH1cblxuICAgIGNvbnN0IHRhc2tUaXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRhc2tUaXRsZS5jbGFzc0xpc3QuYWRkKFwidGFzay10aXRsZVwiKTtcbiAgICB0YXNrVGl0bGUudGV4dENvbnRlbnQgPSB0aXRsZTtcbiAgICBsaXN0RGV0YWlscy5hcHBlbmRDaGlsZCh0YXNrVGl0bGUpO1xuXG4gICAgY29uc3QgdGFza0RldGFpbHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0YXNrRGV0YWlscy5jbGFzc0xpc3QuYWRkKFwidGFzay1kZXRhaWxzXCIpO1xuICAgIHRhc2tEZXRhaWxzLnRleHRDb250ZW50ID0gZGV0YWlscztcbiAgICBsaXN0RGV0YWlscy5hcHBlbmRDaGlsZCh0YXNrRGV0YWlscyk7XG5cbiAgICBjb25zdCBkYXRlRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgZGF0ZURpdi5jbGFzc0xpc3QuYWRkKFwiZGF0ZVwiKTtcbiAgICBkYXRlRGl2LnRleHRDb250ZW50ID0gZGF0ZTtcbiAgICBsaS5hcHBlbmRDaGlsZChkYXRlRGl2KTtcblxuICAgIGNvbnN0IGxpc3RSaWdodCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGxpc3RSaWdodC5jbGFzc0xpc3QuYWRkKCdsaXN0LXJpZ2h0Jyk7XG4gICAgbGkuYXBwZW5kQ2hpbGQobGlzdFJpZ2h0KTtcblxuICAgIGNvbnN0IHN0YXJPdXRsaW5lID0gY3JlYXRlU3Bhbkljb24oJ3N0YXJfb3V0bGluZScpO1xuICAgIHN0YXJPdXRsaW5lLmNsYXNzTGlzdC5hZGQoJ3N0YXItb3V0bGluZScpO1xuICAgIGxpc3RSaWdodC5hcHBlbmRDaGlsZChzdGFyT3V0bGluZSk7XG5cbiAgICBjb25zdCBzdGFyID0gY3JlYXRlU3Bhbkljb24oJ3N0YXInKTtcbiAgICBzdGFyLmNsYXNzTGlzdC5hZGQoJ2ltcG9ydGFudCcpO1xuICAgIGxpc3RSaWdodC5hcHBlbmRDaGlsZChzdGFyKTtcblxuICAgIGlmIChpbXBvcnRhbnQpIHtcbiAgICAgICAgc3Rhck91dGxpbmUuY2xhc3NMaXN0LmFkZCgnbGlzdC1oaWRkZW4nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBzdGFyLmNsYXNzTGlzdC5hZGQoJ2xpc3QtaGlkZGVuJyk7XG4gICAgfVxuXG4gICAgY29uc3QgZWRpdENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGVkaXRDb250YWluZXIuZGF0YXNldC5kcm9wZG93biA9IFwiXCI7XG4gICAgZWRpdENvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdlZGl0LWNvZGF0ZW50YWluZXInKTtcbiAgICBsaXN0UmlnaHQuYXBwZW5kQ2hpbGQoZWRpdENvbnRhaW5lcik7XG5cbiAgICBjb25zdCB0aHJlZURvdHMgPSBjcmVhdGVTcGFuSWNvbignbW9yZV92ZXJ0Jyk7XG4gICAgdGhyZWVEb3RzLmRhdGFzZXQuZHJvcGRvd25CdXR0b24gPSBcIlwiO1xuICAgIGVkaXRDb250YWluZXIuYXBwZW5kQ2hpbGQodGhyZWVEb3RzKTtcblxufVxuXG5mdW5jdGlvbiBwcm9jZXNzRGF0ZURhdGEoZGF0ZSkge1xuICAgIGxldCBmb3JtYXR0ZWREYXRlO1xuICAgIGlmICghZGF0ZSkge1xuICAgICAgICBmb3JtYXR0ZWREYXRlID0gXCJObyBkdWUgZGF0ZVwiO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGZvcm1hdHRlZERhdGUgPSBkYXRlO1xuICAgIH1cblxuICAgIHJldHVybiBmb3JtYXR0ZWREYXRlO1xufVxuLy9mdW5jdGlvbiB0byBmaW5kIHRoZSBkYXRhLXByb2plY3QgaW5kZXggd2hlbiBhZGRpbmcgbmV3IHRhc2tzXG5mdW5jdGlvbiBmaW5kQ3VycmVudERhdGFQcm9qZWN0KCkge1xuICAgIGNvbnN0IHNlbGVjdGVkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlbGVjdGVkJyk7XG4gICAgcmV0dXJuIHNlbGVjdGVkLmRhdGFzZXQucHJvamVjdDtcbn1cblxuZXhwb3J0IHsgdXBkYXRlVGl0bGUsIGxpc3RFdmVudCwgZGlzcGxheVRhc2ssIGlkLCBhZGRUYXNrLCBwcm9jZXNzRGF0ZURhdGEgfTsiLCJpbXBvcnQgeyBkaXNwbGF5VGFzaywgdXBkYXRlVGl0bGUsIGlkIH0gZnJvbSBcIi4vY3JlYXRpbmdUYXNrXCI7XG5pbXBvcnQgeyByZXZlcnRFZGl0Rm9ybUxvY2F0aW9uIH0gZnJvbSBcIi4vZWRpdGluZ1Rhc2tcIjtcbmltcG9ydCB7IHJldmVydE9wdGlvbkxvY2F0aW9uIH0gZnJvbSBcIi4vZWRpdGluZ1Byb2plY3RcIjtcbmltcG9ydCB7IGNoZWNrV2hpY2hIb21lVGlsZSB9IGZyb20gXCIuL2hvbWVTZWN0aW9uXCI7XG5cblxuZnVuY3Rpb24gY3JlYXRlRXZlbnRMaXN0ZW5lcigpIHtcbiAgICAvL2V2ZW50IGxpc3Rlcm5lciBmb3IgY3JlYXRpbmcgYSBmb3JtIGZvciBhZGRpbmcgcHJvamVjdHNcbiAgICBjb25zdCBjYW5jZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdC1jYW5jZWwtYnRuJyk7XG4gICAgY2FuY2VsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoaWRlUHJvamVjdEZvcm0pO1xuXG4gICAgY29uc3QgYWRkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2FkZC1wcm9qZWN0Jyk7XG4gICAgYWRkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBzaG93UHJvamVjdEZvcm0pO1xuXG4gICAgY29uc3Qgc3VibWl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Byb2plY3QtZm9ybScpO1xuICAgIHN1Ym1pdC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBwcm9jZXNzUHJvamVjdElucHV0KTtcblxuICAgIGNvbnN0IGxlZnRQYW5lbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5sZWZ0LXBhbmVsJyk7XG4gICAgbGVmdFBhbmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2hlY2tUaWxlKTtcblxuXG4gICAgZGlzcGxheVByb2plY3QocHJvamVjdExpc3QpO1xuXG59XG5cblxuLy9nZXQgcHJvamVjdCBsaXN0IG9mIG9iamVjdHMgZnJvbSBsb2NhayBzdG9yYWdlIG9yIHN0YXJ0IHdpdGggZW1wdHlcbmxldCBkZWZhdWx0UHJvamVjdExpc3QgPSBbXTtcbmxldCBwcm9qZWN0TGlzdCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwibXlQcm9qZWN0TGlzdFwiKTtcblxucHJvamVjdExpc3QgPSBKU09OLnBhcnNlKHByb2plY3RMaXN0IHx8IEpTT04uc3RyaW5naWZ5KGRlZmF1bHRQcm9qZWN0TGlzdCkpO1xuXG4vL3Byb2Nlc3MgdGhlIGlucHV0IGFuZCBwcmVwYXJlIHRvIGNyZWF0ZSBwcm9qZWN0IGVsZW1lbnRcbmZ1bmN0aW9uIHByb2Nlc3NQcm9qZWN0SW5wdXQoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBsZXQgcHJvamVjdE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJvamVjdC1pbnB1dCcpLnZhbHVlO1xuICAgIGxldCBkYXRhUHJvamVjdCA9IGZpbmROZXh0RGF0YXNldCgpO1xuICAgIGNvbnN0IG5ld1Byb2plY3QgPSBjcmVhdGVQcm9qZWN0KGRhdGFQcm9qZWN0LCBwcm9qZWN0TmFtZSk7XG5cbiAgICBwcm9qZWN0TGlzdC5wdXNoKG5ld1Byb2plY3QpO1xuICAgIHNhdmVUb0xvY2FsU3RvcmFnZSgpO1xuXG4gICAgYWRkUHJvamVjdChkYXRhUHJvamVjdCwgcHJvamVjdE5hbWUpO1xuICAgIGhpZGVQcm9qZWN0Rm9ybSgpO1xuXG59XG5cbi8vc2F2ZSBwcm9qZWN0TGlzdCBhbmQgbGFzdCBpZCBkYXRhIG9uIGxvY2FsIHN0b3JhZ2VcbmZ1bmN0aW9uIHNhdmVUb0xvY2FsU3RvcmFnZSgpIHtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcIm15UHJvamVjdExpc3RcIiwgSlNPTi5zdHJpbmdpZnkocHJvamVjdExpc3QpKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImN1cnJlbnRJZFwiLCAoaWQpLnRvU3RyaW5nKCkpO1xuXG5cbn1cblxuLy9kaXNwbGF5IHRoZSBsaXN0IG9mIGFsbCBwcm9qZWN0cyBpbiB0aGUgbGVmdCBwYW5lbFxuZnVuY3Rpb24gZGlzcGxheVByb2plY3QoYXJyYXkpIHtcbiAgICBhcnJheS5mb3JFYWNoKHByb2plY3QgPT4ge1xuICAgICAgICBhZGRQcm9qZWN0KHByb2plY3QuZGF0YVByb2plY3QsIHByb2plY3QubmFtZSk7XG4gICAgfSlcbn1cbi8vY3JlYXRlIGEgcHJvamVjdCBhbmQgYWRkIGl0IHRvIHRoZSBsaXN0IG9mIHByb2plY3RzIGluIEhUTTtcbmZ1bmN0aW9uIGFkZFByb2plY3QoZGF0YVByb2plY3QsIHRleHRJbnB1dCkge1xuICAgIGNvbnN0IHByb2plY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdCcpO1xuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJvamVjdC1mb3JtJyk7XG5cbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKCdkYXRhLXByb2plY3QnLCBgJHtkYXRhUHJvamVjdH1gKTtcbiAgICBjb250YWluZXIuY2xhc3NMaXN0LmFkZCgndGlsZScsICdkYXRhLXRpbGUnKTtcbiAgICBwcm9qZWN0Lmluc2VydEJlZm9yZShjb250YWluZXIsIGZvcm0pO1xuXG4gICAgLy9tZW51IHRocmVlIGxpbmVzIGljb25cbiAgICBjb25zdCBtZW51SWNvbiA9IGNyZWF0ZVNwYW5JY29uKCdtZW51Jyk7XG4gICAgbWVudUljb24uc2V0QXR0cmlidXRlKCdkYXRhLWRyYWcnLCAnJyk7XG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKG1lbnVJY29uKTtcbiAgICAvL25hbWUgYW5kIG51bWJlciBzdGF0dXNcbiAgICBjb25zdCBwcm9qZWN0SW5mbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHByb2plY3RJbmZvLmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QtaW5mbycpO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChwcm9qZWN0SW5mbyk7XG5cbiAgICBjb25zdCBwcm9qZWN0TmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHByb2plY3ROYW1lLmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QtbmFtZScpO1xuICAgIHByb2plY3ROYW1lLnRleHRDb250ZW50ID0gdGV4dElucHV0O1xuXG4gICAgcHJvamVjdEluZm8uYXBwZW5kQ2hpbGQocHJvamVjdE5hbWUpO1xuICAgIC8vdGhyZWUgZG90cyBvbiB0aGUgcmlnaHQgc2VjdGlvblxuICAgIGNvbnN0IGVkaXREaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBlZGl0RGl2LmNsYXNzTGlzdC5hZGQoJ2VkaXQtY29udGFpbmVyJyk7XG4gICAgZWRpdERpdi5zZXRBdHRyaWJ1dGUoJ2RhdGEtZHJvcGRvd24nLCAnJyk7XG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGVkaXREaXYpO1xuXG4gICAgY29uc3QgZWRpdEljb24gPSBjcmVhdGVTcGFuSWNvbignbW9yZV92ZXJ0Jyk7XG4gICAgZWRpdEljb24uc2V0QXR0cmlidXRlKFwiZGF0YS1kcm9wZG93bi1idXR0b25cIiwgXCJcIik7XG4gICAgZWRpdERpdi5hcHBlbmRDaGlsZChlZGl0SWNvbik7XG5cbn1cbi8vY3JlYXRlIHNwYW4gaWNvbiBvZiBnb29nbGUgbWF0ZXJpYWxzXG5mdW5jdGlvbiBjcmVhdGVTcGFuSWNvbihuYW1lKSB7XG4gICAgY29uc3QgaWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICBpY29uLmNsYXNzTGlzdC5hZGQoJ21hdGVyaWFsLWljb25zLXJvdW5kJyk7XG4gICAgaWNvbi50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgcmV0dXJuIGljb247XG59XG5cbi8vZmluZCBuZXh0IGRhdGEtc2V0XG5jb25zdCBmaW5kTmV4dERhdGFzZXQgPSAoKSA9PiB7XG4gICAgY29uc3QgYWxscHJvamVjdHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiW2RhdGEtcHJvamVjdF1cIik7XG4gICAgcmV0dXJuIGFsbHByb2plY3RzLmxlbmd0aDtcbn1cblxuLy8gcmVtb3ZlIGFkZCB0YXNrIEJ0biB3aGVuIGhvbWVUaWxlcyBpcyBzZWxlY3RlZFxuZnVuY3Rpb24gaGlkZUFkZFRhc2tCdG4oKSB7XG4gICAgY29uc3QgYWRkVGFza0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhZGQtbGlzdCcpO1xuICAgIGFkZFRhc2tCdG4uY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG59XG5cbi8vY2hlY2sgdG8gc2VlIHdoYXQgdGlsZSBpcyBzZWxlY3RlZFxuZnVuY3Rpb24gY2hlY2tUaWxlKGUpIHtcbiAgICBsZXQgaG9tZVRpbGUgPSBlLnRhcmdldC5jbG9zZXN0KCcuaG9tZSAudGlsZScpO1xuICAgIGxldCBwcm9qZWN0VGlsZSA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5wcm9qZWN0IC50aWxlJyk7XG5cblxuICAgIGlmIChob21lVGlsZSAhPSBudWxsKSB7XG4gICAgICAgIGNvbnN0IHRpdGxlID0gaG9tZVRpbGUucXVlcnlTZWxlY3RvcignW2RhdGEtbmFtZV0nKTtcbiAgICAgICAgc2VsZWN0VGlsZShob21lVGlsZSk7XG4gICAgICAgIHJldmVydE9wdGlvbkxvY2F0aW9uKCk7XG4gICAgICAgIC8vIGNoZWNrV2hpY2hIb21lVGlsZShob21lVGlsZSk7XG4gICAgICAgIHVwZGF0ZVRpdGxlKHRpdGxlKTtcbiAgICAgICAgaGlkZUFkZFRhc2tCdG4oKTtcbiAgICB9IGVsc2UgaWYgKHByb2plY3RUaWxlICE9IG51bGwpIHtcbiAgICAgICAgY29uc3QgdGl0bGUgPSBwcm9qZWN0VGlsZS5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtbmFtZVwiKTtcbiAgICAgICAgbGV0IGRhdGFQcm9qZWN0ID0gcHJvamVjdFRpbGUuZGF0YXNldC5wcm9qZWN0O1xuXG4gICAgICAgIHJldmVydE9wdGlvbkxvY2F0aW9uKCk7XG5cbiAgICAgICAgZGlzcGxheVRhc2soZGF0YVByb2plY3QpO1xuICAgICAgICBzZWxlY3RUaWxlKHByb2plY3RUaWxlKTtcbiAgICAgICAgdXBkYXRlVGl0bGUodGl0bGUpO1xuICAgICAgICBzaG93QWRkVGFza0J0bigpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbn1cbi8vY3JlYXRlIHByb2plY3QgZmFjdG9yeSBmdW5jdGlvblxuY29uc3QgY3JlYXRlUHJvamVjdCA9IChkYXRhUHJvamVjdCwgbmFtZSkgPT4ge1xuICAgIGNvbnN0IHRhc2tMaXN0ID0gW107XG4gICAgY29uc3QgdGFza051bSA9IHRhc2tMaXN0Lmxlbmd0aDtcbiAgICByZXR1cm4ge1xuICAgICAgICBkYXRhUHJvamVjdCxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgdGFza0xpc3QsXG4gICAgICAgIHRhc2tOdW1cbiAgICB9XG59XG5cblxuLy9wb3AgdXAgdGhlIHByb2plY3QgZm9ybVxuZnVuY3Rpb24gc2hvd1Byb2plY3RGb3JtKCkge1xuICAgIGNvbnN0IHByb2plY3RGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2plY3QtZm9ybScpO1xuICAgIHByb2plY3RGb3JtLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgIC8vZm9jdXMgb24gaW5wdXQgZmllbGRcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvamVjdC1pbnB1dCcpLmZvY3VzKCk7XG59XG4vL2hpZGUgdGhlIHByb2plY3QgZm9ybVxuZnVuY3Rpb24gaGlkZVByb2plY3RGb3JtKCkge1xuICAgIGNvbnN0IHByb2plY3RGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Byb2plY3QtZm9ybScpO1xuICAgIGNvbnN0IHByb2plY3RJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcm9qZWN0LWlucHV0Jyk7XG5cbiAgICBwcm9qZWN0SW5wdXQudmFsdWUgPSBcIlwiO1xuICAgIHByb2plY3RGb3JtLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xufVxuXG5mdW5jdGlvbiBzZWxlY3RUaWxlKG5vZGUpIHtcbiAgICBjb25zdCBzZWxlY3RlZFRpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VsZWN0ZWQnKTtcblxuICAgIHNlbGVjdGVkVGlsZS5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpO1xuICAgIG5vZGUuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTtcblxufVxuXG4vL3Nob3cgYWRkVGFza0J0biB3aGVuIHByamVjdCB0aWxlXG5mdW5jdGlvbiBzaG93QWRkVGFza0J0bigpIHtcbiAgICBjb25zdCBhZGRUYXNrQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhZGQtbGlzdFwiKTtcbiAgICBhZGRUYXNrQnRuLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRkZW5cIik7XG5cbn1cblxuZXhwb3J0IHsgY3JlYXRlRXZlbnRMaXN0ZW5lciwgY3JlYXRlU3Bhbkljb24sIHByb2plY3RMaXN0LCBzYXZlVG9Mb2NhbFN0b3JhZ2UsIGhpZGVBZGRUYXNrQnRuLCBjcmVhdGVQcm9qZWN0IH07IiwiaW1wb3J0IHsgY3JlYXRlRXZlbnRMaXN0ZW5lciB9IGZyb20gXCIuL2NyZWF0aW5nUHJvamVjdFwiO1xuaW1wb3J0IHsgbGlzdEV2ZW50IH0gZnJvbSBcIi4vY3JlYXRpbmdUYXNrXCI7XG5pbXBvcnQgeyBlZGl0Q29udGFpbmVyRXZlbnRMaXN0ZW5lciB9IGZyb20gXCIuL2VkaXRpbmdQcm9qZWN0XCI7XG5cblxuY3JlYXRlRXZlbnRMaXN0ZW5lcigpO1xubGlzdEV2ZW50KCk7XG5lZGl0Q29udGFpbmVyRXZlbnRMaXN0ZW5lcigpO1xuLy9oaWRlIHNpZGUgbWVudSBldmVudCBsaXN0ZW5lclxuY29uc3QgaGlkZGVuTWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oaWRkZW4tbWVudScpO1xuaGlkZGVuTWVudS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBjb25zdCBsZWZ0UGFuZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubGVmdC1wYW5lbCcpO1xuICAgIGxlZnRQYW5lbC5jbGFzc0xpc3QudG9nZ2xlKCdoaWRkZW4nKTtcbn0pOyJdLCJuYW1lcyI6WyJzaG93RHJvcERvd24iLCJlIiwiaXNEcm9wRG93bkJ1dHRvbiIsInRhcmdldCIsIm1hdGNoZXMiLCJjbG9zZXN0IiwiY3VycmVudERyb3BEb3duIiwiZWRpdENvbnRhaW5lciIsInByb2plY3RPcHRpb24iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJhcHBlbmRDaGlsZCIsImxpc3RPcHRpb24iLCJnZXRFbGVtZW50QnlJZCIsInJlbG9jYXRlT3B0aW9uIiwic2V0VGltZW91dCIsInRvZ2dsZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZHJvcGRvd24iLCJzaG93UmVuYW1lRm9ybSIsImVkaXRDb250YWluZXJOb2RlIiwicGFyZW50Tm9kZSIsInRpbGVOb2RlIiwiaGlkZURyb3BEb3duIiwiY29udGFpbnMiLCJyZW5hbWVGb3JtIiwicHJvamVjdCIsImFkZCIsInJldmVydFJlbmFtZUZvcm1Mb2NhdGlvbiIsInByb2plY3ROb2RlIiwibmFtZSIsInRleHRDb250ZW50IiwidmFsdWUiLCJpbnNlcnRCZWZvcmUiLCJyZWxvY2F0ZVJlbmFtZUZvcm0iLCJmb3JtIiwiYW5pbWF0ZVJlbmFtZUZvcm0iLCJmb2N1cyIsImRlbGV0ZVByb2plY3QiLCJ0aWxlIiwiZGF0YXNldCIsInRvZGF5IiwibmFtZU5vZGUiLCJ1cGRhdGVUaXRsZSIsInJldmVydE9wdGlvbkxvY2F0aW9uIiwiZmluZFNlbGVjdGVkVGFzayIsImxpc3RJZCIsInByb2plY3RMaXN0IiwicmVkdWNlIiwiYWNjIiwiY3VycmVudFRhc2siLCJ0YXNrTGlzdCIsImZpbmQiLCJ0YXNrIiwiaWQiLCJoaWRlTGlzdEZvcm0iLCJsaXN0Rm9ybSIsImxpc3RJbnB1dCIsImxpc3RJbnB1dERldGFpbCIsImxpc3RJbnB1dERhdGUiLCJOdW1iZXIiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiYWRkVGFzayIsInRpdGxlIiwiZGV0YWlscyIsImRhdGUiLCJjb21wbGV0ZWQiLCJpbXBvcnRhbnQiLCJ1bCIsImxpIiwiY3JlYXRlRWxlbWVudCIsInVuY2hlY2tlZCIsImxpc3REZXRhaWxzIiwidGFza1RpdGxlIiwidGFza0RldGFpbHMiLCJkYXRlRGl2IiwibGlzdFJpZ2h0Iiwic3Rhck91dGxpbmUiLCJjcmVhdGVTcGFuSWNvbiIsInN0YXIiLCJ0aHJlZURvdHMiLCJkcm9wZG93bkJ1dHRvbiIsInNhdmVUb0xvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJKU09OIiwic3RyaW5naWZ5IiwiYWRkUHJvamVjdCIsImRhdGFQcm9qZWN0IiwidGV4dElucHV0IiwiY29udGFpbmVyIiwic2V0QXR0cmlidXRlIiwibWVudUljb24iLCJwcm9qZWN0SW5mbyIsInByb2plY3ROYW1lIiwiZWRpdERpdiIsImVkaXRJY29uIiwiaWNvbiIsInBhcnNlIiwiZmluZE5leHREYXRhc2V0IiwibGVuZ3RoIiwiY3JlYXRlUHJvamVjdCIsInRhc2tOdW0iLCJoaWRlUHJvamVjdEZvcm0iLCJwcm9qZWN0Rm9ybSIsInNlbGVjdFRpbGUiLCJub2RlIiwiYWRkRXZlbnRMaXN0ZW5lciIsInByZXZlbnREZWZhdWx0IiwibmV3UHJvamVjdCIsInB1c2giLCJob21lVGlsZSIsInByb2plY3RUaWxlIiwiZGlzcGxheVRhc2siLCJkYXRlSW5wdXQiLCJmb3JtYXR0ZWREYXRlIiwicHJvY2Vzc0RhdGVEYXRhIiwibGlzdElEIiwibmV3VGFzayIsImNyZWF0ZVRhc2siLCJpc1N0YXJJY29uIiwiaXNDaXJjbGVJY29uIiwiY29uc29sZSIsImxvZyIsIm5leHRFbGVtZW50U2libGluZyIsInN0eWxlSW1wb3J0YW50VGFzayIsInNlbGVjdGVkVGFzayIsInVwZGF0ZUltcG9ydGFudFRhc2siLCJ1bmNoZWNrZWROb2RlIiwic3R5bGVDb21wbGV0ZWRUYXNrIiwidXBkYXRlQ29tcGxldGVkVGFzayIsIm9wdGlvbiIsImZpcnN0RWxlbWVudENoaWxkIiwibGFzdEVsZW1lbnRDaGlsZCIsImVkaXRDb250YWluZXJFdmVudExpc3RlbmVyIl0sInNvdXJjZVJvb3QiOiIifQ==