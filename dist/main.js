(()=>{"use strict";var e={};function t(e){const t=e.target.matches("[data-dropdown-button]");if(!t&&null!=e.target.closest("[data-dropdown]"))return;let n;t&&(function(e){const t=e.target.closest(".edit-container");if(null!=e.target.closest(".tile")){const e=document.querySelector("#project-option");e.classList.remove("hidden"),t.appendChild(e)}else if(null!=e.target.closest("li")){const e=document.getElementById("list-option");e.classList.remove("hidden"),t.appendChild(e)}}(e),n=e.target.closest("[data-dropdown]"),setTimeout((function(){n.classList.toggle("active")}),0)),document.querySelectorAll("[data-dropdown].active").forEach((e=>{e!==n&&e.classList.remove("active")}))}function n(e){let t=e.target.parentNode.parentNode,n=t.parentNode;c(t),!0==!document.querySelector("#rename-form").classList.contains("hidden")&&(l(),r()),function(e){const t=e.parentNode,n=document.getElementById("rename-form");let c=e.querySelector(".project-name").textContent;n.querySelector("input").value=c,t.insertBefore(n,e)}(n),function(){const e=document.querySelector("#rename-form");setTimeout((()=>{e.classList.remove("hidden")}),0)}(),document.querySelector(".project-rename-input").focus(),n.classList.add("hidden")}function c(e){e.classList.remove("active")}function o(e){let t=e.target.closest(".tile"),n=t.dataset.project;if(t.classList.contains("selected")){const e=document.querySelector("#today"),t=e.querySelector("[data-name]");e.classList.add("selected"),m(t)}d(),t.remove(),function(){let e=0;document.querySelectorAll(".project .tile").forEach((t=>{let n=t.dataset.project;t.dataset.project=e,y[n].dataProject=e,e++})),y.sort(((e,t)=>e.dataProject-t.dataProject)),S()}(),y.splice(n,1),S()}function d(){const e=document.getElementById("project-option");e.classList.add("hidden"),document.querySelector(".project").appendChild(e);const t=document.querySelector("#list-option");t.classList.add("hidden"),document.querySelector(".list-todo").appendChild(t)}function l(){const e=document.getElementById("rename-form"),t=document.querySelector(".project");e.classList.add("hidden"),t.appendChild(e)}function r(){document.querySelector("div.hidden").classList.remove("hidden")}function s(e){return y.reduce(((t,n)=>{let c=n.taskList.find((t=>t.id==e));return null!=c&&(t=c),t}),{})}function i(){const e=document.querySelector("#list-form"),t=document.querySelector("#list-input"),n=document.querySelector("#list-input-detail"),c=document.querySelector("#list-input-date");e.classList.add("hidden"),t.value="",n.value="",c.value=""}(e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})})(e);let a=Number(localStorage.getItem("currentId"))||0;function u(e){document.querySelector("ul").textContent="",y[e].taskList.forEach((e=>{p(e.id,e.title,e.details,e.date,e.completed,e.important)}))}function m(e){document.querySelector(".title").textContent=e.textContent}function p(e,t,n,c,o,d){const l=document.querySelector("ul"),r=document.createElement("li");r.id=e,l.appendChild(r);const s=document.createElement("div");s.classList.add("unchecked"),r.appendChild(s);const i=document.createElement("div");i.classList.add("list-details"),r.appendChild(i),o&&(s.classList.toggle("checked"),i.classList.toggle("line-through"),i.classList.toggle("fade"));const a=document.createElement("div");a.classList.add("task-title"),a.textContent=t,i.appendChild(a);const u=document.createElement("div");u.classList.add("task-details"),u.textContent=n,i.appendChild(u);const m=document.createElement("div");m.classList.add("date"),m.textContent=c,r.appendChild(m);const p=document.createElement("div");p.classList.add("list-right"),r.appendChild(p);const f=g("star_outline");f.classList.add("star-outline"),p.appendChild(f);const y=g("star");y.classList.add("important"),p.appendChild(y),d?f.classList.add("list-hidden"):y.classList.add("list-hidden");const S=document.createElement("div");S.dataset.dropdown="",S.classList.add("edit-container"),p.appendChild(S);const h=g("more_vert");h.dataset.dropdownButton="",S.appendChild(h)}function f(e){let t;return t=e||"No due date",t}let y=localStorage.getItem("myProjectList");function S(){localStorage.setItem("myProjectList",JSON.stringify(y)),localStorage.setItem("currentId",a.toString())}function h(e,t){const n=document.querySelector(".project"),c=document.querySelector("#project-form"),o=document.createElement("div");o.setAttribute("data-project",`${e}`),o.classList.add("tile","data-tile"),n.insertBefore(o,c);const d=g("menu");d.setAttribute("data-drag",""),o.appendChild(d);const l=document.createElement("div");l.classList.add("project-info"),o.appendChild(l);const r=document.createElement("div");r.classList.add("project-name"),r.textContent=t,l.appendChild(r);const s=document.createElement("div");s.classList.add("edit-container"),s.setAttribute("data-dropdown",""),o.appendChild(s);const i=g("more_vert");i.setAttribute("data-dropdown-button",""),s.appendChild(i)}function g(e){const t=document.createElement("span");return t.classList.add("material-icons-round"),t.textContent=e,t}y=JSON.parse(y||JSON.stringify([]));const L=()=>document.querySelectorAll("[data-project]").length;const v=(e,t)=>{const n=[];return{dataProject:e,name:t,taskList:n,taskNum:n.length}};function q(){const e=document.querySelector("#project-form");document.querySelector("#project-input").value="",e.classList.add("hidden")}function j(e){document.querySelector(".selected").classList.remove("selected"),e.classList.add("selected")}document.querySelector(".project-cancel-btn").addEventListener("click",q),document.querySelector("#add-project").addEventListener("click",(function(){document.getElementById("project-form").classList.remove("hidden"),document.getElementById("project-input").focus()})),document.querySelector("#project-form").addEventListener("submit",(function(e){e.preventDefault();let t=document.querySelector("#project-input").value,n=L();const c=v(n,t);y.push(c),S(),h(n,t),q()})),document.querySelector(".left-panel").addEventListener("click",(function(e){let t=e.target.closest(".home .tile"),n=e.target.closest(".project .tile");if(null!=t){const e=t.querySelector("[data-name]");j(t),d(),m(e),document.querySelector("#add-list").classList.add("hidden")}else{if(null==n)return;{const e=n.querySelector(".project-name");let t=n.dataset.project;d(),u(t),j(n),m(e),document.getElementById("add-list").classList.remove("hidden")}}})),y.forEach((e=>{h(e.dataProject,e.name)})),document.querySelector("#add-list").addEventListener("click",(function(){document.querySelector("#list-form").classList.remove("hidden"),document.querySelector("#list-input").focus()})),document.querySelector(".list-cancel-btn").addEventListener("click",i),document.querySelector("#list-form").addEventListener("submit",(function(e){e.preventDefault();let t=document.querySelector("#list-input").value,n=document.querySelector("#list-input-detail").value,c=document.querySelector("#list-input-date").value,o=document.querySelector(".selected").dataset.project,d=f(c),l=a;const r=function(e,t,n,c,o,d,l){return{dataProject:e,id:t,title:n,details:c,completed:!1,important:!1,date:l}}(o,l,t,n,0,0,d);y[o].taskList.push(r),a++,S(),p(l,t,n,d),i()})),document.querySelector(".list-todo").addEventListener("click",(function(t){let n=t.target.matches(".star-outline"),o=t.target.matches(".unchecked"),l=t.target.matches(".edit-list-submit-btn"),r=(t.target.matches(".edit-list-cancel-btn"),t.target.matches("#list-delete")),i=t.target.matches("#list-edit");n?(function(e){e.target.classList.toggle("list-hidden"),e.target.nextElementSibling.classList.toggle("list-hidden")}(t),function(e){let t=s(e.target.closest("li").id);t.important=!t.important,S()}(t)):o?(function(e){let t=e.target,n=e.target.closest("li").querySelector(".list-details");n.classList.toggle("line-through"),n.classList.toggle("fade"),t.classList.toggle("checked")}(t),function(e){let t=s(e.target.closest("li").id);t.completed=!t.completed,S()}(t)):r?function(e){let t=e.target.closest("li"),n=s(t.id),c=n.dataProject;y[c].taskList=y[c].taskList.filter((e=>e!=n)),S(),d(),t.remove()}(t):i?function(e){c(e.target.parentNode.parentNode),function(e){const t=e.target.closest("li");let n=t.parentNode;const c=document.getElementById("edit-list-form"),o=t.querySelector(".task-title").textContent,d=t.querySelector(".task-details").textContent,l=t.querySelector(".date").textContent,r=c.querySelector("#edit-list-title"),s=c.querySelector("#edit-list-details"),i=c.querySelector("#edit-list-date");r.value=o,s.value=d,i.value=l,t.classList.add("hidden"),c.classList.remove("hidden"),n.insertBefore(c,t)}(e)}(t):l&&function(t){let n=document.querySelector("#edit-list-title").value,c=document.querySelector("#edit-list-details").value,o=document.querySelector("#edit-list-date").value,l=s(document.querySelector("li.hidden").id);l.title=n,l.details=c,l.date=f(o),S(),d(),document.querySelector("li.hidden").classList.remove("hidden"),function(t){const n=document.querySelector(".selected");if(null!=n.closest(".project"))u(t);else{if(null==n.closest(".home"))return;(0,e.checkWhichHomeTile)(n)}}(l.dataProject),t.preventDefault()}(t)})),function(){document.addEventListener("click",t);const e=document.querySelector(".project .option");e.firstElementChild.addEventListener("click",n),e.lastElementChild.addEventListener("click",o),document.querySelector(".rename-rename-btn").addEventListener("click",(e=>{!function(e){e.preventDefault();const t=document.querySelector(".project .tile.hidden");let n=document.querySelector(".project-rename-input").value;const c=t.querySelector(".project-name");c.textContent=n;let o=t.dataset.project;y[o].name=n,S(),r(),m(c),l()}(e),e.preventDefault()})),document.querySelector(".rename-cancel-btn").addEventListener("click",(()=>{l(),r()}))}(),document.querySelector(".hidden-menu").addEventListener("click",(()=>{document.querySelector(".left-panel").classList.toggle("hidden")}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixRQUFTL0gsR0FFbkMsTUFBTWtLLEVBQVN6SixTQUFTQyxjQUFjLG9CQUN0Q3dKLEVBQU9DLGtCQUFrQnBDLGlCQUFpQixRQUFTekcsR0FDbkQ0SSxFQUFPRSxpQkFBaUJyQyxpQkFBaUIsUUFBU3RGLEdBRTVCaEMsU0FBU0MsY0FBYyxzQkFDL0JxSCxpQkFBaUIsU0FBVTlILEtBK0k3QyxTQUE0QkEsR0FDeEJBLEVBQUUrSCxpQkFDRixNQUFNdkcsRUFBV2hCLFNBQVNDLGNBQWMseUJBQ3hDLElBQUkySixFQUFjNUosU0FBU0MsY0FBYyx5QkFBeUJ3QixNQUNsRSxNQUFNZ0YsRUFBY3pGLEVBQVNmLGNBQWMsaUJBQzNDd0csRUFBWWpGLFlBQWNvSSxFQUUxQixJQUFJbEgsRUFBVTFCLEVBQVNtQixRQUFRQyxRQUUvQk8sRUFBWUQsR0FBU25CLEtBQU9xSSxFQUM1QjVHLElBRUE1QixJQUNBbUIsRUFBWWtFLEdBQ1p0RixHQUNKLENBN0pRMEksQ0FBbUJySyxHQUNuQkEsRUFBRStILGdCQUFnQixJQUdBdkgsU0FBU0MsY0FBYyxzQkFDL0JxSCxpQkFBaUIsU0FBUyxLQUNwQ25HLElBQ0FDLEdBQXVCLEdBRS9CLENLZEEwSSxHQUVtQjlKLFNBQVNDLGNBQWMsZ0JBQy9CcUgsaUJBQWlCLFNBQVMsS0FDZnRILFNBQVNDLGNBQWMsZUFDL0JDLFVBQVVPLE9BQU8sU0FBUyxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG9kby1hcHAvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vdG9kby1hcHAvLi9zcmMvZWRpdGluZ1Byb2plY3QuanMiLCJ3ZWJwYWNrOi8vdG9kby1hcHAvLi9zcmMvZWRpdGluZ1Rhc2suanMiLCJ3ZWJwYWNrOi8vdG9kby1hcHAvLi9zcmMvY3JlYXRpbmdUYXNrLmpzIiwid2VicGFjazovL3RvZG8tYXBwL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vdG9kby1hcHAvLi9zcmMvY3JlYXRpbmdQcm9qZWN0LmpzIiwid2VicGFjazovL3RvZG8tYXBwLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCJpbXBvcnQgeyBwcm9qZWN0TGlzdCwgc2F2ZVRvTG9jYWxTdG9yYWdlIH0gZnJvbSBcIi4vY3JlYXRpbmdQcm9qZWN0XCJcbmltcG9ydCB7IHVwZGF0ZVRpdGxlIH0gZnJvbSBcIi4vY3JlYXRpbmdUYXNrXCJcblxuZnVuY3Rpb24gZWRpdENvbnRhaW5lckV2ZW50TGlzdGVuZXIoKSB7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHNob3dEcm9wRG93bik7XG5cbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdCAub3B0aW9uJyk7XG4gICAgb3B0aW9uLmZpcnN0RWxlbWVudENoaWxkLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2hvd1JlbmFtZUZvcm0pO1xuICAgIG9wdGlvbi5sYXN0RWxlbWVudENoaWxkLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZGVsZXRlUHJvamVjdCk7XG4gICAgLy9ldmVudCBsaXN0ZW5lciBvZiByZW5hbWVGb3JtJ3MgcmVuYW1lIGFuZCBjYW5jZWwgYnV0dG9uc1xuICAgIGNvbnN0IGZvcm1SZW5hbWVCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucmVuYW1lLXJlbmFtZS1idG4nKTtcbiAgICBmb3JtUmVuYW1lQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgcHJvY2Vzc1JlbmFtZUlucHV0KGUpO1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG5cbiAgICBjb25zdCBmb3JtQ2FuY2VsQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnJlbmFtZS1jYW5jZWwtYnRuJyk7XG4gICAgZm9ybUNhbmNlbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgcmV2ZXJ0UmVuYW1lRm9ybUxvY2F0aW9uKCk7XG4gICAgICAgIGRpc3BsYXlSZW5hbWVkUHJvamVjdCgpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBzaG93RHJvcERvd24oZSkge1xuICAgIGNvbnN0IGlzRHJvcERvd25CdXR0b24gPSBlLnRhcmdldC5tYXRjaGVzKCdbZGF0YS1kcm9wZG93bi1idXR0b25dJyk7XG4gICAgaWYgKCFpc0Ryb3BEb3duQnV0dG9uICYmIGUudGFyZ2V0LmNsb3Nlc3QoJ1tkYXRhLWRyb3Bkb3duXScpICE9IG51bGwpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBsZXQgY3VycmVudERyb3BEb3duO1xuICAgIGlmIChpc0Ryb3BEb3duQnV0dG9uKSB7XG4gICAgICAgIHJlbG9jYXRlT3B0aW9uKGUpO1xuICAgICAgICBjdXJyZW50RHJvcERvd24gPSBlLnRhcmdldC5jbG9zZXN0KCdbZGF0YS1kcm9wZG93bl0nKTtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGN1cnJlbnREcm9wRG93bi5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnKTtcbiAgICAgICAgfSwgMCk7XG4gICAgfVxuXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtZHJvcGRvd25dLmFjdGl2ZScpLmZvckVhY2goZHJvcGRvd24gPT4ge1xuICAgICAgICAvL2lmIGNsaWNrIGFueXdoZXJlIGVsc2UgY3VycmVudERyb3BEb3duID0gdW5kZWZpbmVkIG1lYW5pbmcgYWxsIGFjdGl2ZSBvbmVzIGFyZSBjbG9zZWRcbiAgICAgICAgaWYgKGRyb3Bkb3duID09PSBjdXJyZW50RHJvcERvd24pIHsgLy9pZiBpdHMgdGhlIGN1cnJlbnQgYnV0dG9uIHRoZW4gZG8gbnRoXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZHJvcGRvd24uY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZVwiKTsgLy9iYXNpY2FsbHkgY2xvc2UgYWxsIGRyb3Bkb3duIG90aGVyIGRyb3AgZG93biBiZWZvcmUgb3BlbiBhbm90aGVyXG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIHNob3dSZW5hbWVGb3JtKGUpIHtcbiAgICBsZXQgZWRpdENvbnRhaW5lck5vZGUgPSBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGU7XG4gICAgbGV0IHRpbGVOb2RlID0gZWRpdENvbnRhaW5lck5vZGUucGFyZW50Tm9kZTtcblxuICAgIGhpZGVEcm9wRG93bihlZGl0Q29udGFpbmVyTm9kZSk7XG4gICAgbGV0IGhhdmVGb3JtID0gY2hlY2tGb3JtRXhpc3QoKTtcbiAgICBpZiAoaGF2ZUZvcm0gPT09IHRydWUpIHtcbiAgICAgICAgcmV2ZXJ0UmVuYW1lRm9ybUxvY2F0aW9uKCk7XG4gICAgICAgIGRpc3BsYXlSZW5hbWVkUHJvamVjdCgpO1xuICAgIH1cblxuICAgIHJlbG9jYXRlUmVuYW1lRm9ybSh0aWxlTm9kZSk7XG4gICAgYW5pbWF0ZVJlbmFtZUZvcm0oKTtcblxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9qZWN0LXJlbmFtZS1pbnB1dCcpLmZvY3VzKCk7XG4gICAgdGlsZU5vZGUuY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKTtcbn1cblxuZnVuY3Rpb24gaGlkZURyb3BEb3duKGVkaXRDb250YWluZXJOb2RlKSB7XG4gICAgZWRpdENvbnRhaW5lck5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG59XG5cbmZ1bmN0aW9uIGRlbGV0ZVByb2plY3QoZSkge1xuICAgIGxldCB0aWxlID0gZS50YXJnZXQuY2xvc2VzdCgnLnRpbGUnKTtcbiAgICBsZXQgaW5kZXggPSB0aWxlLmRhdGFzZXQucHJvamVjdDtcblxuICAgIGlmICh0aWxlLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSkge1xuICAgICAgICBjb25zdCB0b2RheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdG9kYXlcIik7XG4gICAgICAgIGNvbnN0IG5hbWVOb2RlID0gdG9kYXkucXVlcnlTZWxlY3RvcihcIltkYXRhLW5hbWVdXCIpO1xuXG4gICAgICAgIHRvZGF5LmNsYXNzTGlzdC5hZGQoXCJzZWxlY3RlZFwiKTtcbiAgICAgICAgdXBkYXRlVGl0bGUobmFtZU5vZGUpO1xuICAgIH1cblxuICAgIHJldmVydE9wdGlvbkxvY2F0aW9uKGUpO1xuICAgIHRpbGUucmVtb3ZlKCk7XG4gICAgc29ydEFycmF5KCk7XG4gICAgcHJvamVjdExpc3Quc3BsaWNlKGluZGV4LCAxKTtcbiAgICBzYXZlVG9Mb2NhbFN0b3JhZ2UoKTtcbn1cblxuZnVuY3Rpb24gcmV2ZXJ0T3B0aW9uTG9jYXRpb24oKSB7XG4gICAgY29uc3QgcHJvamVjdE9wdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9qZWN0LW9wdGlvbicpO1xuICAgIHByb2plY3RPcHRpb24uY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKTtcbiAgICBjb25zdCBwcm9qZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0XCIpO1xuICAgIHByb2plY3QuYXBwZW5kQ2hpbGQocHJvamVjdE9wdGlvbik7XG4gICAgLy9yZXZlcnQgb3B0aW9uIERPTSBpbiByaWdodCBwYW5lbFxuICAgIGNvbnN0IGxpc3RPcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2xpc3Qtb3B0aW9uXCIpO1xuICAgIGxpc3RPcHRpb24uY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKTtcbiAgICBjb25zdCBsaXN0VG9EbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubGlzdC10b2RvXCIpO1xuICAgIGxpc3RUb0RvLmFwcGVuZENoaWxkKGxpc3RPcHRpb24pO1xufVxuXG5mdW5jdGlvbiByZWxvY2F0ZU9wdGlvbihlKSB7XG4gICAgY29uc3QgZWRpdENvbnRhaW5lciA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5lZGl0LWNvbnRhaW5lcicpO1xuXG4gICAgaWYgKGUudGFyZ2V0LmNsb3Nlc3QoJy50aWxlJykgIT0gbnVsbCkge1xuICAgICAgICBjb25zdCBwcm9qZWN0T3B0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Byb2plY3Qtb3B0aW9uJyk7XG4gICAgICAgIHByb2plY3RPcHRpb24uY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG4gICAgICAgIGVkaXRDb250YWluZXIuYXBwZW5kQ2hpbGQocHJvamVjdE9wdGlvbik7XG4gICAgfSBlbHNlIGlmIChlLnRhcmdldC5jbG9zZXN0KFwibGlcIikgIT0gbnVsbCkgeyAvL3BvcCB1cCBpbiBsaXN0XG4gICAgICAgIGNvbnN0IGxpc3RPcHRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxpc3Qtb3B0aW9uXCIpO1xuICAgICAgICBsaXN0T3B0aW9uLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRkZW5cIik7XG4gICAgICAgIGVkaXRDb250YWluZXIuYXBwZW5kQ2hpbGQobGlzdE9wdGlvbik7XG4gICAgfVxuXG59XG5cbmZ1bmN0aW9uIGNoZWNrRm9ybUV4aXN0KCkge1xuICAgIGNvbnN0IHJlbmFtZUZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcmVuYW1lLWZvcm0nKTtcblxuICAgIGlmIChyZW5hbWVGb3JtLmNsYXNzTGlzdC5jb250YWlucygnaGlkZGVuJykpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbn1cblxuLy9yZXZlcnQgZm9ybSBiYWNrIHRvIGl0cyBvcmlnaW5hbCBwb3N0aW5nIHVuZGVyIC5wcm9qZWN0XG5mdW5jdGlvbiByZXZlcnRSZW5hbWVGb3JtTG9jYXRpb24oKSB7XG4gICAgY29uc3QgcmVuYW1lRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVuYW1lLWZvcm1cIik7XG4gICAgY29uc3QgcHJvamVjdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdFwiKTtcblxuICAgIHJlbmFtZUZvcm0uY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKTtcbiAgICBwcm9qZWN0LmFwcGVuZENoaWxkKHJlbmFtZUZvcm0pO1xufVxuXG5mdW5jdGlvbiByZWxvY2F0ZVJlbmFtZUZvcm0odGlsZU5vZGUpIHtcbiAgICBjb25zdCBwcm9qZWN0Tm9kZSA9IHRpbGVOb2RlLnBhcmVudE5vZGU7XG4gICAgY29uc3QgcmVuYW1lRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZW5hbWUtZm9ybScpO1xuXG4gICAgY29uc3QgbmFtZU5vZGUgPSB0aWxlTm9kZS5xdWVyeVNlbGVjdG9yKCcucHJvamVjdC1uYW1lJyk7XG4gICAgbGV0IG5hbWUgPSBuYW1lTm9kZS50ZXh0Q29udGVudDtcblxuICAgIGNvbnN0IGlucHV0ID0gcmVuYW1lRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpO1xuICAgIGlucHV0LnZhbHVlID0gbmFtZTtcblxuICAgIHByb2plY3ROb2RlLmluc2VydEJlZm9yZShyZW5hbWVGb3JtLCB0aWxlTm9kZSk7XG59XG5cbmZ1bmN0aW9uIGFuaW1hdGVSZW5hbWVGb3JtKCkge1xuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcmVuYW1lLWZvcm0nKTtcblxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBmb3JtLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgIH0sIDApO1xufVxuXG5mdW5jdGlvbiBwcm9jZXNzUmVuYW1lSW5wdXQoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCB0aWxlTm9kZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9qZWN0IC50aWxlLmhpZGRlbicpO1xuICAgIGxldCByZW5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9qZWN0LXJlbmFtZS1pbnB1dCcpLnZhbHVlO1xuICAgIGNvbnN0IHByb2plY3ROYW1lID0gdGlsZU5vZGUucXVlcnlTZWxlY3RvcignLnByb2plY3QtbmFtZScpO1xuICAgIHByb2plY3ROYW1lLnRleHRDb250ZW50ID0gcmVuYW1lSW5wdXQ7XG5cbiAgICBsZXQgZGF0YU51bSA9IHRpbGVOb2RlLmRhdGFzZXQucHJvamVjdDtcblxuICAgIHByb2plY3RMaXN0W2RhdGFOdW1dLm5hbWUgPSByZW5hbWVJbnB1dDtcbiAgICBzYXZlVG9Mb2NhbFN0b3JhZ2UoKTtcblxuICAgIGRpc3BsYXlSZW5hbWVkUHJvamVjdCgpO1xuICAgIHVwZGF0ZVRpdGxlKHByb2plY3ROYW1lKTtcbiAgICByZXZlcnRSZW5hbWVGb3JtTG9jYXRpb24oKTtcbn1cblxuZnVuY3Rpb24gZGlzcGxheVJlbmFtZWRQcm9qZWN0KCkge1xuICAgIGNvbnN0IGhpZGRlblRpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdkaXYuaGlkZGVuJyk7XG4gICAgaGlkZGVuVGlsZS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbn1cblxuZnVuY3Rpb24gc29ydEFycmF5KCkge1xuICAgIGxldCBpID0gMDtcbiAgICBjb25zdCB0aWxlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wcm9qZWN0IC50aWxlJyk7XG4gICAgdGlsZXMuZm9yRWFjaCgodGlsZSkgPT4ge1xuICAgICAgICBsZXQgZGF0YU51bSA9IHRpbGUuZGF0YXNldC5wcm9qZWN0O1xuICAgICAgICB0aWxlLmRhdGFzZXQucHJvamVjdCA9IGk7XG4gICAgICAgIHByb2plY3RMaXN0W2RhdGFOdW1dLmRhdGFQcm9qZWN0ID0gaTtcbiAgICAgICAgaSsrO1xuICAgIH0pO1xuXG4gICAgcHJvamVjdExpc3Quc29ydCgoYSwgYikgPT4gYS5kYXRhUHJvamVjdCAtIGIuZGF0YVByb2plY3QpO1xuICAgIHNhdmVUb0xvY2FsU3RvcmFnZSgpO1xuXG59XG5cbmV4cG9ydCB7IGVkaXRDb250YWluZXJFdmVudExpc3RlbmVyLCBzaG93UmVuYW1lRm9ybSwgaGlkZURyb3BEb3duLCBkZWxldGVQcm9qZWN0LCByZXZlcnRPcHRpb25Mb2NhdGlvbiwgc29ydEFycmF5IH07IiwiaW1wb3J0IHsgcHJvamVjdExpc3QsIHNhdmVUb0xvY2FsU3RvcmFnZSB9IGZyb20gXCIuL2NyZWF0aW5nUHJvamVjdFwiO1xuaW1wb3J0IHsgaGlkZURyb3BEb3duLCByZXZlcnRPcHRpb25Mb2NhdGlvbiB9IGZyb20gXCIuL2VkaXRpbmdQcm9qZWN0XCI7XG5pbXBvcnQgeyBkaXNwbGF5VGFzaywgcHJvY2Vzc0RhdGVEYXRhIH0gZnJvbSBcIi4vY3JlYXRpbmdUYXNrXCI7XG5pbXBvcnQgeyBjaGVja1doaWNoSG9tZVRpbGUgfSBmcm9tIFwiLi9ob21lU2VjdGlvblwiO1xuXG5mdW5jdGlvbiBzdHlsZUNvbXBsZXRlZFRhc2soZSkge1xuICAgIGxldCB1bmNoZWNrZWROb2RlID0gZS50YXJnZXQ7XG4gICAgbGV0IHRhc2tUaWxlID0gZS50YXJnZXQuY2xvc2VzdCgnbGknKTtcbiAgICBsZXQgbGlzdERldGFpbHMgPSB0YXNrVGlsZS5xdWVyeVNlbGVjdG9yKCcubGlzdC1kZXRhaWxzJyk7XG4gICAgbGlzdERldGFpbHMuY2xhc3NMaXN0LnRvZ2dsZSgnbGluZS10aHJvdWdoJyk7XG4gICAgbGlzdERldGFpbHMuY2xhc3NMaXN0LnRvZ2dsZSgnZmFkZScpO1xuICAgIHVuY2hlY2tlZE5vZGUuY2xhc3NMaXN0LnRvZ2dsZSgnY2hlY2tlZCcpO1xuXG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUNvbXBsZXRlZFRhc2soZSkge1xuICAgIGxldCBsaXN0SUQgPSBlLnRhcmdldC5jbG9zZXN0KCdsaScpLmlkO1xuICAgIGxldCBzZWxlY3RlZFRhc2sgPSBmaW5kU2VsZWN0ZWRUYXNrKGxpc3RJRCk7XG4gICAgc2VsZWN0ZWRUYXNrLmNvbXBsZXRlZCA9ICFzZWxlY3RlZFRhc2suY29tcGxldGVkO1xuICAgIHNhdmVUb0xvY2FsU3RvcmFnZSgpO1xufVxuXG5mdW5jdGlvbiBzdHlsZUltcG9ydGFudFRhc2soZSkge1xuICAgIGxldCBzdGFyT3V0bGluZSA9IGUudGFyZ2V0O1xuICAgIHN0YXJPdXRsaW5lLmNsYXNzTGlzdC50b2dnbGUoJ2xpc3QtaGlkZGVuJyk7XG5cbiAgICBsZXQgc3RhckZpbGxlZCA9IGUudGFyZ2V0Lm5leHRFbGVtZW50U2libGluZztcbiAgICBzdGFyRmlsbGVkLmNsYXNzTGlzdC50b2dnbGUoJ2xpc3QtaGlkZGVuJyk7XG5cbn1cblxuZnVuY3Rpb24gdXBkYXRlSW1wb3J0YW50VGFzayhlKSB7XG4gICAgbGV0IGxpc3RJZCA9IGUudGFyZ2V0LmNsb3Nlc3QoJ2xpJykuaWQ7XG4gICAgbGV0IHNlbGVjdGVkVGFzayA9IGZpbmRTZWxlY3RlZFRhc2sobGlzdElkKTtcbiAgICBzZWxlY3RlZFRhc2suaW1wb3J0YW50ID0gIXNlbGVjdGVkVGFzay5pbXBvcnRhbnQ7XG4gICAgc2F2ZVRvTG9jYWxTdG9yYWdlKCk7XG59XG5cblxuXG5mdW5jdGlvbiBkZWxldGVUYXNrKGUpIHtcbiAgICBsZXQgbGlzdE5vZGUgPSBlLnRhcmdldC5jbG9zZXN0KCdsaScpO1xuICAgIGxldCBpZCA9IGxpc3ROb2RlLmlkO1xuICAgIGxldCBzZWxlY3RlZFRhc2sgPSBmaW5kU2VsZWN0ZWRUYXNrKGlkKTtcbiAgICBsZXQgZGF0YVByb2plY3QgPSBzZWxlY3RlZFRhc2suZGF0YVByb2plY3Q7XG4gICAgcHJvamVjdExpc3RbZGF0YVByb2plY3RdLnRhc2tMaXN0ID0gcHJvamVjdExpc3RbZGF0YVByb2plY3RdLnRhc2tMaXN0LmZpbHRlcih0YXNrID0+IHRhc2sgIT0gc2VsZWN0ZWRUYXNrKTtcbiAgICBzYXZlVG9Mb2NhbFN0b3JhZ2UoKTtcbiAgICByZXZlcnRPcHRpb25Mb2NhdGlvbigpO1xuICAgIGxpc3ROb2RlLnJlbW92ZSgpO1xuXG59XG5cbmZ1bmN0aW9uIGZpbmRTZWxlY3RlZFRhc2sobGlzdElkKSB7XG4gICAgbGV0IHNlbGVjdGVkVGFzayA9IHByb2plY3RMaXN0LnJlZHVjZSgoYWNjLCBwcm9qZWN0KSA9PiB7XG4gICAgICAgIGxldCBjdXJyZW50VGFzayA9IHByb2plY3QudGFza0xpc3QuZmluZCh0YXNrID0+IHRhc2suaWQgPT0gbGlzdElkKTtcbiAgICAgICAgaWYgKGN1cnJlbnRUYXNrICE9IG51bGwpIHtcbiAgICAgICAgICAgIGFjYyA9IGN1cnJlbnRUYXNrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhY2M7XG4gICAgfSwge30pO1xuXG4gICAgcmV0dXJuIHNlbGVjdGVkVGFzaztcbn1cblxuZnVuY3Rpb24gc2hvd0VkaXRGb3JtKGUpIHtcbiAgICBsZXQgZWRpdENvbnRhaW5lck5vZGUgPSBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGU7XG4gICAgaGlkZURyb3BEb3duKGVkaXRDb250YWluZXJOb2RlKTtcbiAgICByZWxvY2F0ZUVkaXRMaXN0Rm9ybShlKTtcblxuXG59XG5cbmZ1bmN0aW9uIHJlbG9jYXRlRWRpdExpc3RGb3JtKGUpIHtcbiAgICBjb25zdCBsaXN0Tm9kZSA9IGUudGFyZ2V0LmNsb3Nlc3QoJ2xpJyk7XG4gICAgbGV0IHVsID0gbGlzdE5vZGUucGFyZW50Tm9kZTtcblxuICAgIGNvbnN0IGVkaXRMaXN0Rm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0LWxpc3QtZm9ybScpO1xuICAgIGNvbnN0IHRhc2tUaXRsZSA9IGxpc3ROb2RlLnF1ZXJ5U2VsZWN0b3IoJy50YXNrLXRpdGxlJykudGV4dENvbnRlbnQ7XG4gICAgY29uc3QgdGFza0RldGFpbHMgPSBsaXN0Tm9kZS5xdWVyeVNlbGVjdG9yKCcudGFzay1kZXRhaWxzJykudGV4dENvbnRlbnQ7XG4gICAgY29uc3QgdGFza0RhdGUgPSBsaXN0Tm9kZS5xdWVyeVNlbGVjdG9yKCcuZGF0ZScpLnRleHRDb250ZW50O1xuXG4gICAgY29uc3QgdGl0bGVJbnB1dCA9IGVkaXRMaXN0Rm9ybS5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtbGlzdC10aXRsZVwiKTtcbiAgICBjb25zdCBkZXRhaWxJbnB1dCA9IGVkaXRMaXN0Rm9ybS5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtbGlzdC1kZXRhaWxzXCIpO1xuICAgIGNvbnN0IGRhdGVJbnB1dCA9IGVkaXRMaXN0Rm9ybS5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtbGlzdC1kYXRlXCIpO1xuXG4gICAgdGl0bGVJbnB1dC52YWx1ZSA9IHRhc2tUaXRsZTtcbiAgICBkZXRhaWxJbnB1dC52YWx1ZSA9IHRhc2tEZXRhaWxzO1xuICAgIGRhdGVJbnB1dC52YWx1ZSA9IHRhc2tEYXRlO1xuXG4gICAgbGlzdE5vZGUuY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKTtcbiAgICBlZGl0TGlzdEZvcm0uY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcbiAgICB1bC5pbnNlcnRCZWZvcmUoZWRpdExpc3RGb3JtLCBsaXN0Tm9kZSk7XG59XG5cbmZ1bmN0aW9uIHJldmVydEVkaXRGb3JtTG9jYXRpb24oKSB7XG5cbn1cblxuZnVuY3Rpb24gcHJvY2Vzc0VkaXRUYXNrKGUpIHtcbiAgICBsZXQgdGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZWRpdC1saXN0LXRpdGxlJykudmFsdWU7XG4gICAgbGV0IGRldGFpbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZWRpdC1saXN0LWRldGFpbHMnKS52YWx1ZTtcbiAgICBsZXQgZGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNlZGl0LWxpc3QtZGF0ZScpLnZhbHVlO1xuICAgIGxldCB0YXNrSWQgPSBmaW5kSGlkZGVuVGFzaygpLmlkO1xuICAgIGxldCBzZWxlY3RlZFRhc2sgPSBmaW5kU2VsZWN0ZWRUYXNrKHRhc2tJZCk7XG5cbiAgICBzZWxlY3RlZFRhc2sudGl0bGUgPSB0aXRsZTtcbiAgICBzZWxlY3RlZFRhc2suZGV0YWlscyA9IGRldGFpbHM7XG4gICAgc2VsZWN0ZWRUYXNrLmRhdGUgPSBwcm9jZXNzRGF0ZURhdGEoZGF0ZSk7XG4gICAgc2F2ZVRvTG9jYWxTdG9yYWdlKCk7XG5cbiAgICByZXZlcnRFZGl0Rm9ybUxvY2F0aW9uKCk7XG4gICAgcmV2ZXJ0T3B0aW9uTG9jYXRpb24oKTtcbiAgICBzaG93SGlkZGVuVGFzaygpO1xuXG4gICAgbGV0IGRhdGFQcm9qZWN0ID0gc2VsZWN0ZWRUYXNrLmRhdGFQcm9qZWN0O1xuICAgIHJlZnJlc2hEaXNwbGF5KGRhdGFQcm9qZWN0KTtcblxuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxufVxuLy9yZWZyZXNoIHRoZSBjb250ZW50IGRpc3BsYXkgYWZ0ZXIgaXRzIGJlZW4gZWRpdGVkL2NoYW5nZWQgaW4gc29tZSB3YXlcbmZ1bmN0aW9uIHJlZnJlc2hEaXNwbGF5KGRhdGFQcm9qZWN0KSB7XG4gICAgY29uc3Qgc2VsZWN0ZWRUaWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlbGVjdGVkJyk7XG4gICAgaWYgKHNlbGVjdGVkVGlsZS5jbG9zZXN0KCcucHJvamVjdCcpICE9IG51bGwpIHtcbiAgICAgICAgZGlzcGxheVRhc2soZGF0YVByb2plY3QpO1xuICAgIH0gZWxzZSBpZiAoc2VsZWN0ZWRUaWxlLmNsb3Nlc3QoJy5ob21lJykgIT0gbnVsbCkge1xuICAgICAgICBjaGVja1doaWNoSG9tZVRpbGUoc2VsZWN0ZWRUaWxlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm47XG4gICAgfVxufVxuXG5mdW5jdGlvbiBmaW5kSGlkZGVuVGFzaygpIHtcbiAgICBjb25zdCBoaWRkZW5UYXNrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbGkuaGlkZGVuJyk7XG4gICAgcmV0dXJuIGhpZGRlblRhc2s7XG59XG5cbmZ1bmN0aW9uIHNob3dIaWRkZW5UYXNrKCkge1xuICAgIGNvbnN0IGhpZGRlblRhc2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdsaS5oaWRkZW4nKTtcbiAgICBoaWRkZW5UYXNrLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xufVxuXG5leHBvcnQge1xuICAgIHN0eWxlQ29tcGxldGVkVGFzayxcbiAgICBzdHlsZUltcG9ydGFudFRhc2ssXG4gICAgdXBkYXRlQ29tcGxldGVkVGFzayxcbiAgICB1cGRhdGVJbXBvcnRhbnRUYXNrLFxuICAgIGRlbGV0ZVRhc2ssXG4gICAgc2hvd0VkaXRGb3JtLFxuICAgIHJlbG9jYXRlRWRpdExpc3RGb3JtLFxuICAgIHJldmVydEVkaXRGb3JtTG9jYXRpb24sXG4gICAgcHJvY2Vzc0VkaXRUYXNrLFxuICAgIHNob3dIaWRkZW5UYXNrXG59IiwiaW1wb3J0IHsgcHJvamVjdExpc3QsIGNyZWF0ZVNwYW5JY29uLCBzYXZlVG9Mb2NhbFN0b3JhZ2UgfSBmcm9tIFwiLi9jcmVhdGluZ1Byb2plY3RcIlxuaW1wb3J0IHtcbiAgICBzdHlsZUNvbXBsZXRlZFRhc2ssXG4gICAgdXBkYXRlQ29tcGxldGVkVGFzayxcbiAgICBzdHlsZUltcG9ydGFudFRhc2ssXG4gICAgdXBkYXRlSW1wb3J0YW50VGFzayxcbiAgICBkZWxldGVUYXNrLFxuICAgIHNob3dFZGl0Rm9ybSxcbiAgICByZXZlcnRFZGl0Rm9ybUxvY2F0aW9uLFxuICAgIHByb2Nlc3NFZGl0VGFzayxcbiAgICBzaG93SGlkZGVuVGFza1xufSBmcm9tIFwiLi9lZGl0aW5nVGFza1wiXG5cbmZ1bmN0aW9uIGxpc3RFdmVudCgpIHtcbiAgICBjb25zdCBhZGRMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtbGlzdFwiKTtcbiAgICBhZGRMaXN0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBzaG93TGlzdEZvcm0pO1xuXG4gICAgY29uc3QgY2FuY2VsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxpc3QtY2FuY2VsLWJ0bicpO1xuICAgIGNhbmNlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGlkZUxpc3RGb3JtKTtcblxuICAgIGNvbnN0IGxpc3RTdWJtaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbGlzdC1mb3JtJyk7XG4gICAgbGlzdFN1Ym1pdC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBwcm9jZXNzTGlzdElucHV0KTtcblxuICAgIGNvbnN0IHRvZG9MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxpc3QtdG9kbycpO1xuICAgIHRvZG9MaXN0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjaGVja0xpc3RFdmVudCk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVRhc2soZGF0YVByb2plY3QsIGlkLCB0aXRsZSwgZGV0YWlscywgY29tcGxldGVkLCBpbXBvcnRhbnQsIGRhdGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBkYXRhUHJvamVjdCxcbiAgICAgICAgaWQsXG4gICAgICAgIHRpdGxlLFxuICAgICAgICBkZXRhaWxzLFxuICAgICAgICBjb21wbGV0ZWQ6IGNvbXBsZXRlZCxcbiAgICAgICAgaW1wb3J0YW50OiBpbXBvcnRhbnQsXG4gICAgICAgIGRhdGU6IGRhdGVcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGNoZWNrTGlzdEV2ZW50KGUpIHtcbiAgICBsZXQgaXNTdGFySWNvbiA9IGUudGFyZ2V0Lm1hdGNoZXMoJy5zdGFyLW91dGxpbmUnKTtcbiAgICBsZXQgaXNDaXJjbGVJY29uID0gZS50YXJnZXQubWF0Y2hlcygnLnVuY2hlY2tlZCcpO1xuXG4gICAgbGV0IGlzRWRpdFN1Ym1pdEJ0biA9IGUudGFyZ2V0Lm1hdGNoZXMoJy5lZGl0LWxpc3Qtc3VibWl0LWJ0bicpO1xuICAgIGxldCBpc0VkaXRUYXNrQ2FuY2VsID0gZS50YXJnZXQubWF0Y2hlcygnLmVkaXQtbGlzdC1jYW5jZWwtYnRuJyk7XG5cbiAgICBsZXQgaXNEZWxldGVCdG4gPSBlLnRhcmdldC5tYXRjaGVzKCcjbGlzdC1kZWxldGUnKTtcbiAgICBsZXQgaXNFZGl0QnRuID0gZS50YXJnZXQubWF0Y2hlcygnI2xpc3QtZWRpdCcpO1xuXG5cblxuXG5cbiAgICBpZiAoaXNTdGFySWNvbikge1xuICAgICAgICBzdHlsZUltcG9ydGFudFRhc2soZSk7XG4gICAgICAgIHVwZGF0ZUltcG9ydGFudFRhc2soZSk7XG4gICAgfSBlbHNlIGlmIChpc0NpcmNsZUljb24pIHtcbiAgICAgICAgc3R5bGVDb21wbGV0ZWRUYXNrKGUpO1xuICAgICAgICB1cGRhdGVDb21wbGV0ZWRUYXNrKGUpO1xuICAgIH0gZWxzZSBpZiAoaXNEZWxldGVCdG4pIHtcbiAgICAgICAgZGVsZXRlVGFzayhlKTtcbiAgICB9IGVsc2UgaWYgKGlzRWRpdEJ0bikge1xuICAgICAgICBzaG93RWRpdEZvcm0oZSk7XG4gICAgfSBlbHNlIGlmIChpc0VkaXRTdWJtaXRCdG4pIHtcbiAgICAgICAgcHJvY2Vzc0VkaXRUYXNrKGUpO1xuICAgIH1cbn1cblxuXG5cbi8vcG9wIHVwIHRoZSBhZGQgbGlzdCBmb3JtXG5mdW5jdGlvbiBzaG93TGlzdEZvcm0oKSB7XG4gICAgY29uc3QgbGlzdEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbGlzdC1mb3JtJyk7XG4gICAgbGlzdEZvcm0uY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2xpc3QtaW5wdXQnKS5mb2N1cygpO1xufVxuXG4vL2hpZGUgdGhlIGFkZCBsaXN0IGZvcm1cbmZ1bmN0aW9uIGhpZGVMaXN0Rm9ybSgpIHtcbiAgICBjb25zdCBsaXN0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNsaXN0LWZvcm0nKTtcbiAgICBjb25zdCBsaXN0SW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbGlzdC1pbnB1dCcpO1xuICAgIGNvbnN0IGxpc3RJbnB1dERldGFpbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNsaXN0LWlucHV0LWRldGFpbCcpO1xuICAgIGNvbnN0IGxpc3RJbnB1dERhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbGlzdC1pbnB1dC1kYXRlJyk7XG5cbiAgICBsaXN0Rm9ybS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbiAgICBsaXN0SW5wdXQudmFsdWUgPSBcIlwiO1xuICAgIGxpc3RJbnB1dERldGFpbC52YWx1ZSA9IFwiXCI7XG4gICAgbGlzdElucHV0RGF0ZS52YWx1ZSA9IFwiXCI7XG59XG4vL2dldCBpZCBmcm9tIGxvY2FsIHN0b3JhZ2Ugb3IgZ2V0IGEgZGVmYXVsdCBvbmVcbmxldCBkZWZhdWx0SWQgPSAwO1xubGV0IGlkID0gTnVtYmVyKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiY3VycmVudElkXCIpKSB8fCBkZWZhdWx0SWQ7XG5cbmZ1bmN0aW9uIHByb2Nlc3NMaXN0SW5wdXQoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBsZXQgdGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbGlzdC1pbnB1dCcpLnZhbHVlO1xuICAgIGxldCBkZXRhaWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2xpc3QtaW5wdXQtZGV0YWlsJykudmFsdWU7XG4gICAgbGV0IGRhdGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNsaXN0LWlucHV0LWRhdGUnKS52YWx1ZTtcblxuICAgIGxldCBkYXRhUHJvamVjdCA9IGZpbmRDdXJyZW50RGF0YVByb2plY3QoKTtcbiAgICBsZXQgZGF0ZSA9IHByb2Nlc3NEYXRlRGF0YShkYXRlSW5wdXQpO1xuICAgIGxldCBsaXN0SUQgPSBpZDtcblxuICAgIGNvbnN0IG5ld1Rhc2sgPSBjcmVhdGVUYXNrKGRhdGFQcm9qZWN0LCBsaXN0SUQsIHRpdGxlLCBkZXRhaWxzLCBmYWxzZSwgZmFsc2UsIGRhdGUpO1xuICAgIHByb2plY3RMaXN0W2RhdGFQcm9qZWN0XS50YXNrTGlzdC5wdXNoKG5ld1Rhc2spO1xuICAgIGlkKys7XG4gICAgc2F2ZVRvTG9jYWxTdG9yYWdlKCk7XG5cbiAgICBhZGRUYXNrKGxpc3RJRCwgdGl0bGUsIGRldGFpbHMsIGRhdGUpO1xuICAgIGhpZGVMaXN0Rm9ybSgpO1xufVxuLy9kaXNwYXkgYWxsIHRoZSB0YXNrIGluIGEgcHJvamVjdFxuZnVuY3Rpb24gZGlzcGxheVRhc2soZGF0YVByb2plY3QpIHtcbiAgICBjb25zdCB1bCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJyk7XG4gICAgdWwudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIHByb2plY3RMaXN0W2RhdGFQcm9qZWN0XS50YXNrTGlzdC5mb3JFYWNoKHRhc2sgPT4ge1xuICAgICAgICBhZGRUYXNrKHRhc2suaWQsIHRhc2sudGl0bGUsIHRhc2suZGV0YWlscywgdGFzay5kYXRlLCB0YXNrLmNvbXBsZXRlZCwgdGFzay5pbXBvcnRhbnQpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVUaXRsZShuYW1lTm9kZSkge1xuICAgIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRpdGxlJyk7XG4gICAgdGl0bGUudGV4dENvbnRlbnQgPSBuYW1lTm9kZS50ZXh0Q29udGVudDtcbn1cblxuXG5cblxuXG5mdW5jdGlvbiBhZGRUYXNrKGxpc3RJZCwgdGl0bGUsIGRldGFpbHMsIGRhdGUsIGNvbXBsZXRlZCwgaW1wb3J0YW50KSB7XG4gICAgY29uc3QgdWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpO1xuICAgIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICBsaS5pZCA9IGxpc3RJZDtcbiAgICB1bC5hcHBlbmRDaGlsZChsaSk7XG5cbiAgICBjb25zdCB1bmNoZWNrZWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB1bmNoZWNrZWQuY2xhc3NMaXN0LmFkZCgndW5jaGVja2VkJyk7XG4gICAgbGkuYXBwZW5kQ2hpbGQodW5jaGVja2VkKTtcblxuICAgIGNvbnN0IGxpc3REZXRhaWxzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgbGlzdERldGFpbHMuY2xhc3NMaXN0LmFkZCgnbGlzdC1kZXRhaWxzJyk7XG4gICAgbGkuYXBwZW5kQ2hpbGQobGlzdERldGFpbHMpO1xuXG4gICAgaWYgKGNvbXBsZXRlZCkge1xuICAgICAgICB1bmNoZWNrZWQuY2xhc3NMaXN0LnRvZ2dsZSgnY2hlY2tlZCcpO1xuICAgICAgICBsaXN0RGV0YWlscy5jbGFzc0xpc3QudG9nZ2xlKCdsaW5lLXRocm91Z2gnKTtcbiAgICAgICAgbGlzdERldGFpbHMuY2xhc3NMaXN0LnRvZ2dsZSgnZmFkZScpO1xuICAgIH1cblxuICAgIGNvbnN0IHRhc2tUaXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRhc2tUaXRsZS5jbGFzc0xpc3QuYWRkKFwidGFzay10aXRsZVwiKTtcbiAgICB0YXNrVGl0bGUudGV4dENvbnRlbnQgPSB0aXRsZTtcbiAgICBsaXN0RGV0YWlscy5hcHBlbmRDaGlsZCh0YXNrVGl0bGUpO1xuXG4gICAgY29uc3QgdGFza0RldGFpbHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0YXNrRGV0YWlscy5jbGFzc0xpc3QuYWRkKFwidGFzay1kZXRhaWxzXCIpO1xuICAgIHRhc2tEZXRhaWxzLnRleHRDb250ZW50ID0gZGV0YWlscztcbiAgICBsaXN0RGV0YWlscy5hcHBlbmRDaGlsZCh0YXNrRGV0YWlscyk7XG5cbiAgICBjb25zdCBkYXRlRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgZGF0ZURpdi5jbGFzc0xpc3QuYWRkKFwiZGF0ZVwiKTtcbiAgICBkYXRlRGl2LnRleHRDb250ZW50ID0gZGF0ZTtcbiAgICBsaS5hcHBlbmRDaGlsZChkYXRlRGl2KTtcblxuICAgIGNvbnN0IGxpc3RSaWdodCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGxpc3RSaWdodC5jbGFzc0xpc3QuYWRkKCdsaXN0LXJpZ2h0Jyk7XG4gICAgbGkuYXBwZW5kQ2hpbGQobGlzdFJpZ2h0KTtcblxuICAgIGNvbnN0IHN0YXJPdXRsaW5lID0gY3JlYXRlU3Bhbkljb24oJ3N0YXJfb3V0bGluZScpO1xuICAgIHN0YXJPdXRsaW5lLmNsYXNzTGlzdC5hZGQoJ3N0YXItb3V0bGluZScpO1xuICAgIGxpc3RSaWdodC5hcHBlbmRDaGlsZChzdGFyT3V0bGluZSk7XG5cbiAgICBjb25zdCBzdGFyID0gY3JlYXRlU3Bhbkljb24oJ3N0YXInKTtcbiAgICBzdGFyLmNsYXNzTGlzdC5hZGQoJ2ltcG9ydGFudCcpO1xuICAgIGxpc3RSaWdodC5hcHBlbmRDaGlsZChzdGFyKTtcblxuICAgIGlmIChpbXBvcnRhbnQpIHtcbiAgICAgICAgc3Rhck91dGxpbmUuY2xhc3NMaXN0LmFkZCgnbGlzdC1oaWRkZW4nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBzdGFyLmNsYXNzTGlzdC5hZGQoJ2xpc3QtaGlkZGVuJyk7XG4gICAgfVxuXG4gICAgY29uc3QgZWRpdENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGVkaXRDb250YWluZXIuZGF0YXNldC5kcm9wZG93biA9IFwiXCI7XG4gICAgZWRpdENvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdlZGl0LWNvbnRhaW5lcicpO1xuICAgIGxpc3RSaWdodC5hcHBlbmRDaGlsZChlZGl0Q29udGFpbmVyKTtcblxuICAgIGNvbnN0IHRocmVlRG90cyA9IGNyZWF0ZVNwYW5JY29uKCdtb3JlX3ZlcnQnKTtcbiAgICB0aHJlZURvdHMuZGF0YXNldC5kcm9wZG93bkJ1dHRvbiA9IFwiXCI7XG4gICAgZWRpdENvbnRhaW5lci5hcHBlbmRDaGlsZCh0aHJlZURvdHMpO1xuXG59XG5cbmZ1bmN0aW9uIHByb2Nlc3NEYXRlRGF0YShkYXRlKSB7XG4gICAgbGV0IGZvcm1hdHRlZERhdGU7XG4gICAgaWYgKCFkYXRlKSB7XG4gICAgICAgIGZvcm1hdHRlZERhdGUgPSBcIk5vIGR1ZSBkYXRlXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZm9ybWF0dGVkRGF0ZSA9IGRhdGU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZvcm1hdHRlZERhdGU7XG59XG4vL2Z1bmN0aW9uIHRvIGZpbmQgdGhlIGRhdGEtcHJvamVjdCBpbmRleCB3aGVuIGFkZGluZyBuZXcgdGFza3NcbmZ1bmN0aW9uIGZpbmRDdXJyZW50RGF0YVByb2plY3QoKSB7XG4gICAgY29uc3Qgc2VsZWN0ZWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VsZWN0ZWQnKTtcbiAgICByZXR1cm4gc2VsZWN0ZWQuZGF0YXNldC5wcm9qZWN0O1xufVxuXG5leHBvcnQgeyB1cGRhdGVUaXRsZSwgbGlzdEV2ZW50LCBkaXNwbGF5VGFzaywgaWQsIGFkZFRhc2ssIHByb2Nlc3NEYXRlRGF0YSB9OyIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsImltcG9ydCB7IGRpc3BsYXlUYXNrLCB1cGRhdGVUaXRsZSwgaWQgfSBmcm9tIFwiLi9jcmVhdGluZ1Rhc2tcIjtcbmltcG9ydCB7IHJldmVydEVkaXRGb3JtTG9jYXRpb24gfSBmcm9tIFwiLi9lZGl0aW5nVGFza1wiO1xuaW1wb3J0IHsgcmV2ZXJ0T3B0aW9uTG9jYXRpb24gfSBmcm9tIFwiLi9lZGl0aW5nUHJvamVjdFwiO1xuaW1wb3J0IHsgY2hlY2tXaGljaEhvbWVUaWxlIH0gZnJvbSBcIi4vaG9tZVNlY3Rpb25cIjtcblxuXG5cbmZ1bmN0aW9uIGNyZWF0ZUV2ZW50TGlzdGVuZXIoKSB7XG4gICAgLy9ldmVudCBsaXN0ZXJuZXIgZm9yIGNyZWF0aW5nIGEgZm9ybSBmb3IgYWRkaW5nIHByb2plY3RzXG4gICAgY29uc3QgY2FuY2VsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3QtY2FuY2VsLWJ0bicpO1xuICAgIGNhbmNlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGlkZVByb2plY3RGb3JtKTtcblxuICAgIGNvbnN0IGFkZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhZGQtcHJvamVjdCcpO1xuICAgIGFkZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgc2hvd1Byb2plY3RGb3JtKTtcblxuICAgIGNvbnN0IHN1Ym1pdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcm9qZWN0LWZvcm0nKTtcbiAgICBzdWJtaXQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgcHJvY2Vzc1Byb2plY3RJbnB1dCk7XG5cbiAgICBjb25zdCBsZWZ0UGFuZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubGVmdC1wYW5lbCcpO1xuICAgIGxlZnRQYW5lbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNoZWNrVGlsZSk7XG5cblxuXG4gICAgZGlzcGxheVByb2plY3QocHJvamVjdExpc3QpO1xuXG59XG5cblxuLy9nZXQgcHJvamVjdCBsaXN0IG9mIG9iamVjdHMgZnJvbSBsb2NhayBzdG9yYWdlIG9yIHN0YXJ0IHdpdGggZW1wdHlcbmxldCBkZWZhdWx0UHJvamVjdExpc3QgPSBbXTtcbmxldCBwcm9qZWN0TGlzdCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwibXlQcm9qZWN0TGlzdFwiKTtcblxucHJvamVjdExpc3QgPSBKU09OLnBhcnNlKHByb2plY3RMaXN0IHx8IEpTT04uc3RyaW5naWZ5KGRlZmF1bHRQcm9qZWN0TGlzdCkpO1xuXG4vL3Byb2Nlc3MgdGhlIGlucHV0IGFuZCBwcmVwYXJlIHRvIGNyZWF0ZSBwcm9qZWN0IGVsZW1lbnRcbmZ1bmN0aW9uIHByb2Nlc3NQcm9qZWN0SW5wdXQoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBsZXQgcHJvamVjdE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJvamVjdC1pbnB1dCcpLnZhbHVlO1xuICAgIGxldCBkYXRhUHJvamVjdCA9IGZpbmROZXh0RGF0YXNldCgpO1xuICAgIGNvbnN0IG5ld1Byb2plY3QgPSBjcmVhdGVQcm9qZWN0KGRhdGFQcm9qZWN0LCBwcm9qZWN0TmFtZSk7XG5cbiAgICBwcm9qZWN0TGlzdC5wdXNoKG5ld1Byb2plY3QpO1xuICAgIHNhdmVUb0xvY2FsU3RvcmFnZSgpO1xuXG4gICAgYWRkUHJvamVjdChkYXRhUHJvamVjdCwgcHJvamVjdE5hbWUpO1xuICAgIGhpZGVQcm9qZWN0Rm9ybSgpO1xuXG59XG5cbi8vc2F2ZSBwcm9qZWN0TGlzdCBhbmQgbGFzdCBpZCBkYXRhIG9uIGxvY2FsIHN0b3JhZ2VcbmZ1bmN0aW9uIHNhdmVUb0xvY2FsU3RvcmFnZSgpIHtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcIm15UHJvamVjdExpc3RcIiwgSlNPTi5zdHJpbmdpZnkocHJvamVjdExpc3QpKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImN1cnJlbnRJZFwiLCAoaWQpLnRvU3RyaW5nKCkpO1xuXG5cbn1cblxuLy9kaXNwbGF5IHRoZSBsaXN0IG9mIGFsbCBwcm9qZWN0cyBpbiB0aGUgbGVmdCBwYW5lbFxuZnVuY3Rpb24gZGlzcGxheVByb2plY3QoYXJyYXkpIHtcbiAgICBhcnJheS5mb3JFYWNoKHByb2plY3QgPT4ge1xuICAgICAgICBhZGRQcm9qZWN0KHByb2plY3QuZGF0YVByb2plY3QsIHByb2plY3QubmFtZSk7XG4gICAgfSlcbn1cbi8vY3JlYXRlIGEgcHJvamVjdCBhbmQgYWRkIGl0IHRvIHRoZSBsaXN0IG9mIHByb2plY3RzIGluIEhUTTtcbmZ1bmN0aW9uIGFkZFByb2plY3QoZGF0YVByb2plY3QsIHRleHRJbnB1dCkge1xuICAgIGNvbnN0IHByb2plY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdCcpO1xuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJvamVjdC1mb3JtJyk7XG5cbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKCdkYXRhLXByb2plY3QnLCBgJHtkYXRhUHJvamVjdH1gKTtcbiAgICBjb250YWluZXIuY2xhc3NMaXN0LmFkZCgndGlsZScsICdkYXRhLXRpbGUnKTtcbiAgICBwcm9qZWN0Lmluc2VydEJlZm9yZShjb250YWluZXIsIGZvcm0pO1xuXG4gICAgLy9tZW51IHRocmVlIGxpbmVzIGljb25cbiAgICBjb25zdCBtZW51SWNvbiA9IGNyZWF0ZVNwYW5JY29uKCdtZW51Jyk7XG4gICAgbWVudUljb24uc2V0QXR0cmlidXRlKCdkYXRhLWRyYWcnLCAnJyk7XG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKG1lbnVJY29uKTtcbiAgICAvL25hbWUgYW5kIG51bWJlciBzdGF0dXNcbiAgICBjb25zdCBwcm9qZWN0SW5mbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHByb2plY3RJbmZvLmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QtaW5mbycpO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChwcm9qZWN0SW5mbyk7XG5cbiAgICBjb25zdCBwcm9qZWN0TmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHByb2plY3ROYW1lLmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QtbmFtZScpO1xuICAgIHByb2plY3ROYW1lLnRleHRDb250ZW50ID0gdGV4dElucHV0O1xuXG4gICAgcHJvamVjdEluZm8uYXBwZW5kQ2hpbGQocHJvamVjdE5hbWUpO1xuICAgIC8vdGhyZWUgZG90cyBvbiB0aGUgcmlnaHQgc2VjdGlvblxuICAgIGNvbnN0IGVkaXREaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBlZGl0RGl2LmNsYXNzTGlzdC5hZGQoJ2VkaXQtY29udGFpbmVyJyk7XG4gICAgZWRpdERpdi5zZXRBdHRyaWJ1dGUoJ2RhdGEtZHJvcGRvd24nLCAnJyk7XG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGVkaXREaXYpO1xuXG4gICAgY29uc3QgZWRpdEljb24gPSBjcmVhdGVTcGFuSWNvbignbW9yZV92ZXJ0Jyk7XG4gICAgZWRpdEljb24uc2V0QXR0cmlidXRlKFwiZGF0YS1kcm9wZG93bi1idXR0b25cIiwgXCJcIik7XG4gICAgZWRpdERpdi5hcHBlbmRDaGlsZChlZGl0SWNvbik7XG5cbn1cbi8vY3JlYXRlIHNwYW4gaWNvbiBvZiBnb29nbGUgbWF0ZXJpYWxzXG5mdW5jdGlvbiBjcmVhdGVTcGFuSWNvbihuYW1lKSB7XG4gICAgY29uc3QgaWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICBpY29uLmNsYXNzTGlzdC5hZGQoJ21hdGVyaWFsLWljb25zLXJvdW5kJyk7XG4gICAgaWNvbi50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgcmV0dXJuIGljb247XG59XG5cbi8vZmluZCBuZXh0IGRhdGEtc2V0XG5jb25zdCBmaW5kTmV4dERhdGFzZXQgPSAoKSA9PiB7XG4gICAgY29uc3QgYWxscHJvamVjdHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiW2RhdGEtcHJvamVjdF1cIik7XG4gICAgcmV0dXJuIGFsbHByb2plY3RzLmxlbmd0aDtcbn1cblxuLy8gcmVtb3ZlIGFkZCB0YXNrIEJ0biB3aGVuIGhvbWVUaWxlcyBpcyBzZWxlY3RlZFxuZnVuY3Rpb24gaGlkZUFkZFRhc2tCdG4oKSB7XG4gICAgY29uc3QgYWRkVGFza0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhZGQtbGlzdCcpO1xuICAgIGFkZFRhc2tCdG4uY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG59XG5cbi8vY2hlY2sgdG8gc2VlIHdoYXQgdGlsZSBpcyBzZWxlY3RlZFxuZnVuY3Rpb24gY2hlY2tUaWxlKGUpIHtcbiAgICBsZXQgaG9tZVRpbGUgPSBlLnRhcmdldC5jbG9zZXN0KCcuaG9tZSAudGlsZScpO1xuICAgIGxldCBwcm9qZWN0VGlsZSA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5wcm9qZWN0IC50aWxlJyk7XG5cblxuICAgIGlmIChob21lVGlsZSAhPSBudWxsKSB7XG4gICAgICAgIGNvbnN0IHRpdGxlID0gaG9tZVRpbGUucXVlcnlTZWxlY3RvcignW2RhdGEtbmFtZV0nKTtcbiAgICAgICAgc2VsZWN0VGlsZShob21lVGlsZSk7XG4gICAgICAgIHJldmVydE9wdGlvbkxvY2F0aW9uKCk7XG4gICAgICAgIC8vIGNoZWNrV2hpY2hIb21lVGlsZShob21lVGlsZSk7XG4gICAgICAgIHVwZGF0ZVRpdGxlKHRpdGxlKTtcbiAgICAgICAgaGlkZUFkZFRhc2tCdG4oKTtcbiAgICB9IGVsc2UgaWYgKHByb2plY3RUaWxlICE9IG51bGwpIHtcbiAgICAgICAgY29uc3QgdGl0bGUgPSBwcm9qZWN0VGlsZS5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtbmFtZVwiKTtcbiAgICAgICAgbGV0IGRhdGFQcm9qZWN0ID0gcHJvamVjdFRpbGUuZGF0YXNldC5wcm9qZWN0O1xuXG4gICAgICAgIHJldmVydE9wdGlvbkxvY2F0aW9uKCk7XG5cbiAgICAgICAgZGlzcGxheVRhc2soZGF0YVByb2plY3QpO1xuICAgICAgICBzZWxlY3RUaWxlKHByb2plY3RUaWxlKTtcbiAgICAgICAgdXBkYXRlVGl0bGUodGl0bGUpO1xuICAgICAgICBzaG93QWRkVGFza0J0bigpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbn1cbi8vY3JlYXRlIHByb2plY3QgZmFjdG9yeSBmdW5jdGlvblxuY29uc3QgY3JlYXRlUHJvamVjdCA9IChkYXRhUHJvamVjdCwgbmFtZSkgPT4ge1xuICAgIGNvbnN0IHRhc2tMaXN0ID0gW107XG4gICAgY29uc3QgdGFza051bSA9IHRhc2tMaXN0Lmxlbmd0aDtcbiAgICByZXR1cm4ge1xuICAgICAgICBkYXRhUHJvamVjdCxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgdGFza0xpc3QsXG4gICAgICAgIHRhc2tOdW1cbiAgICB9XG59XG5cblxuLy9wb3AgdXAgdGhlIHByb2plY3QgZm9ybVxuZnVuY3Rpb24gc2hvd1Byb2plY3RGb3JtKCkge1xuICAgIGNvbnN0IHByb2plY3RGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2plY3QtZm9ybScpO1xuICAgIHByb2plY3RGb3JtLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgIC8vZm9jdXMgb24gaW5wdXQgZmllbGRcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvamVjdC1pbnB1dCcpLmZvY3VzKCk7XG59XG4vL2hpZGUgdGhlIHByb2plY3QgZm9ybVxuZnVuY3Rpb24gaGlkZVByb2plY3RGb3JtKCkge1xuICAgIGNvbnN0IHByb2plY3RGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Byb2plY3QtZm9ybScpO1xuICAgIGNvbnN0IHByb2plY3RJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcm9qZWN0LWlucHV0Jyk7XG5cbiAgICBwcm9qZWN0SW5wdXQudmFsdWUgPSBcIlwiO1xuICAgIHByb2plY3RGb3JtLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xufVxuXG5mdW5jdGlvbiBzZWxlY3RUaWxlKG5vZGUpIHtcbiAgICBjb25zdCBzZWxlY3RlZFRpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VsZWN0ZWQnKTtcblxuICAgIHNlbGVjdGVkVGlsZS5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpO1xuICAgIG5vZGUuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTtcblxufVxuXG4vL3Nob3cgYWRkVGFza0J0biB3aGVuIHByamVjdCB0aWxlXG5mdW5jdGlvbiBzaG93QWRkVGFza0J0bigpIHtcbiAgICBjb25zdCBhZGRUYXNrQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhZGQtbGlzdFwiKTtcbiAgICBhZGRUYXNrQnRuLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRkZW5cIik7XG5cbn1cblxuZXhwb3J0IHsgY3JlYXRlRXZlbnRMaXN0ZW5lciwgY3JlYXRlU3Bhbkljb24sIHByb2plY3RMaXN0LCBzYXZlVG9Mb2NhbFN0b3JhZ2UsIGhpZGVBZGRUYXNrQnRuLCBjcmVhdGVQcm9qZWN0IH07IiwiaW1wb3J0IHsgY3JlYXRlRXZlbnRMaXN0ZW5lciB9IGZyb20gXCIuL2NyZWF0aW5nUHJvamVjdFwiO1xuaW1wb3J0IHsgbGlzdEV2ZW50IH0gZnJvbSBcIi4vY3JlYXRpbmdUYXNrXCI7XG5pbXBvcnQgeyBlZGl0Q29udGFpbmVyRXZlbnRMaXN0ZW5lciB9IGZyb20gXCIuL2VkaXRpbmdQcm9qZWN0XCI7XG5cblxuY3JlYXRlRXZlbnRMaXN0ZW5lcigpO1xubGlzdEV2ZW50KCk7XG5lZGl0Q29udGFpbmVyRXZlbnRMaXN0ZW5lcigpO1xuLy9oaWRlIHNpZGUgbWVudSBldmVudCBsaXN0ZW5lclxuY29uc3QgaGlkZGVuTWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oaWRkZW4tbWVudScpO1xuaGlkZGVuTWVudS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBjb25zdCBsZWZ0UGFuZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubGVmdC1wYW5lbCcpO1xuICAgIGxlZnRQYW5lbC5jbGFzc0xpc3QudG9nZ2xlKCdoaWRkZW4nKTtcbn0pOyJdLCJuYW1lcyI6WyJzaG93RHJvcERvd24iLCJlIiwiaXNEcm9wRG93bkJ1dHRvbiIsInRhcmdldCIsIm1hdGNoZXMiLCJjbG9zZXN0IiwiY3VycmVudERyb3BEb3duIiwiZWRpdENvbnRhaW5lciIsInByb2plY3RPcHRpb24iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJhcHBlbmRDaGlsZCIsImxpc3RPcHRpb24iLCJnZXRFbGVtZW50QnlJZCIsInJlbG9jYXRlT3B0aW9uIiwic2V0VGltZW91dCIsInRvZ2dsZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZHJvcGRvd24iLCJzaG93UmVuYW1lRm9ybSIsImVkaXRDb250YWluZXJOb2RlIiwicGFyZW50Tm9kZSIsInRpbGVOb2RlIiwiaGlkZURyb3BEb3duIiwiY29udGFpbnMiLCJyZXZlcnRSZW5hbWVGb3JtTG9jYXRpb24iLCJkaXNwbGF5UmVuYW1lZFByb2plY3QiLCJwcm9qZWN0Tm9kZSIsInJlbmFtZUZvcm0iLCJuYW1lIiwidGV4dENvbnRlbnQiLCJ2YWx1ZSIsImluc2VydEJlZm9yZSIsInJlbG9jYXRlUmVuYW1lRm9ybSIsImZvcm0iLCJhbmltYXRlUmVuYW1lRm9ybSIsImZvY3VzIiwiYWRkIiwiZGVsZXRlUHJvamVjdCIsInRpbGUiLCJpbmRleCIsImRhdGFzZXQiLCJwcm9qZWN0IiwidG9kYXkiLCJuYW1lTm9kZSIsInVwZGF0ZVRpdGxlIiwicmV2ZXJ0T3B0aW9uTG9jYXRpb24iLCJpIiwiZGF0YU51bSIsInByb2plY3RMaXN0IiwiZGF0YVByb2plY3QiLCJzb3J0IiwiYSIsImIiLCJzYXZlVG9Mb2NhbFN0b3JhZ2UiLCJzb3J0QXJyYXkiLCJzcGxpY2UiLCJmaW5kU2VsZWN0ZWRUYXNrIiwibGlzdElkIiwicmVkdWNlIiwiYWNjIiwiY3VycmVudFRhc2siLCJ0YXNrTGlzdCIsImZpbmQiLCJ0YXNrIiwiaWQiLCJoaWRlTGlzdEZvcm0iLCJsaXN0Rm9ybSIsImxpc3RJbnB1dCIsImxpc3RJbnB1dERldGFpbCIsImxpc3RJbnB1dERhdGUiLCJleHBvcnRzIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsIk51bWJlciIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJkaXNwbGF5VGFzayIsImFkZFRhc2siLCJ0aXRsZSIsImRldGFpbHMiLCJkYXRlIiwiY29tcGxldGVkIiwiaW1wb3J0YW50IiwidWwiLCJsaSIsImNyZWF0ZUVsZW1lbnQiLCJ1bmNoZWNrZWQiLCJsaXN0RGV0YWlscyIsInRhc2tUaXRsZSIsInRhc2tEZXRhaWxzIiwiZGF0ZURpdiIsImxpc3RSaWdodCIsInN0YXJPdXRsaW5lIiwiY3JlYXRlU3Bhbkljb24iLCJzdGFyIiwidGhyZWVEb3RzIiwiZHJvcGRvd25CdXR0b24iLCJwcm9jZXNzRGF0ZURhdGEiLCJmb3JtYXR0ZWREYXRlIiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhZGRQcm9qZWN0IiwidGV4dElucHV0IiwiY29udGFpbmVyIiwic2V0QXR0cmlidXRlIiwibWVudUljb24iLCJwcm9qZWN0SW5mbyIsInByb2plY3ROYW1lIiwiZWRpdERpdiIsImVkaXRJY29uIiwiaWNvbiIsInBhcnNlIiwiZmluZE5leHREYXRhc2V0IiwibGVuZ3RoIiwiY3JlYXRlUHJvamVjdCIsInRhc2tOdW0iLCJoaWRlUHJvamVjdEZvcm0iLCJwcm9qZWN0Rm9ybSIsInNlbGVjdFRpbGUiLCJub2RlIiwiYWRkRXZlbnRMaXN0ZW5lciIsInByZXZlbnREZWZhdWx0IiwibmV3UHJvamVjdCIsInB1c2giLCJob21lVGlsZSIsInByb2plY3RUaWxlIiwiZGF0ZUlucHV0IiwibGlzdElEIiwibmV3VGFzayIsImNyZWF0ZVRhc2siLCJpc1N0YXJJY29uIiwiaXNDaXJjbGVJY29uIiwiaXNFZGl0U3VibWl0QnRuIiwiaXNEZWxldGVCdG4iLCJpc0VkaXRCdG4iLCJuZXh0RWxlbWVudFNpYmxpbmciLCJzdHlsZUltcG9ydGFudFRhc2siLCJzZWxlY3RlZFRhc2siLCJ1cGRhdGVJbXBvcnRhbnRUYXNrIiwidW5jaGVja2VkTm9kZSIsInN0eWxlQ29tcGxldGVkVGFzayIsInVwZGF0ZUNvbXBsZXRlZFRhc2siLCJsaXN0Tm9kZSIsImZpbHRlciIsImRlbGV0ZVRhc2siLCJlZGl0TGlzdEZvcm0iLCJ0YXNrRGF0ZSIsInRpdGxlSW5wdXQiLCJkZXRhaWxJbnB1dCIsInJlbG9jYXRlRWRpdExpc3RGb3JtIiwic2hvd0VkaXRGb3JtIiwic2VsZWN0ZWRUaWxlIiwiY2hlY2tXaGljaEhvbWVUaWxlIiwicmVmcmVzaERpc3BsYXkiLCJwcm9jZXNzRWRpdFRhc2siLCJvcHRpb24iLCJmaXJzdEVsZW1lbnRDaGlsZCIsImxhc3RFbGVtZW50Q2hpbGQiLCJyZW5hbWVJbnB1dCIsInByb2Nlc3NSZW5hbWVJbnB1dCIsImVkaXRDb250YWluZXJFdmVudExpc3RlbmVyIl0sInNvdXJjZVJvb3QiOiIifQ==