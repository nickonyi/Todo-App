(()=>{"use strict";function e(e){const t=e.target.matches("[data-dropdown-button]");if(!t&&null!=e.target.closest("[data-dropdown]"))return;let n;t&&(function(e){const t=e.target.closest(".edit-container");if(null!=e.target.closest(".tile")){const e=document.querySelector("#project-option");e.classList.remove("hidden"),t.appendChild(e)}else if(null!=e.target.closest("li")){const e=document.getElementById("list-option");e.classList.remove("hidden"),t.appendChild(e)}}(e),n=e.target.closest("[data-dropdown]"),setTimeout((function(){n.classList.toggle("active")}),0)),document.querySelectorAll("[data-dropdown].active").forEach((e=>{e!==n&&e.classList.remove("active")}))}function t(e){let t=e.target.parentNode.parentNode,c=t.parentNode;n(t),!0==!document.querySelector("#rename-form").classList.contains("hidden")&&(d(),l()),function(e){const t=e.parentNode,n=document.getElementById("rename-form");let c=e.querySelector(".project-name").textContent;n.querySelector("input").value=c,t.insertBefore(n,e)}(c),function(){const e=document.querySelector("#rename-form");setTimeout((()=>{e.classList.remove("hidden")}),0)}(),document.querySelector(".project-rename-input").focus(),c.classList.add("hidden")}function n(e){e.classList.remove("active")}function c(e){let t=e.target.closest(".tile"),n=t.dataset.project;if(t.classList.contains("selected")){const e=document.querySelector("#today"),t=e.querySelector("[data-name]");e.classList.add("selected"),a(t)}o(),t.remove(),function(){let e=0;document.querySelectorAll(".project .tile").forEach((t=>{let n=t.dataset.project;t.dataset.project=e,m[n].dataProject=e,e++})),m.sort(((e,t)=>e.dataProject-t.dataProject)),p()}(),m.splice(n,1),p()}function o(){const e=document.getElementById("project-option");e.classList.add("hidden"),document.querySelector(".project").appendChild(e);const t=document.querySelector("#list-option");t.classList.add("hidden"),document.querySelector(".list-todo").appendChild(t)}function d(){const e=document.getElementById("rename-form"),t=document.querySelector(".project");e.classList.add("hidden"),t.appendChild(e)}function l(){document.querySelector("div.hidden").classList.remove("hidden")}function s(e){return m.reduce(((t,n)=>{let c=n.taskList.find((t=>t.id==e));return null!=c&&(t=c),t}),{})}function r(){const e=document.querySelector("#list-form"),t=document.querySelector("#list-input"),n=document.querySelector("#list-input-detail"),c=document.querySelector("#list-input-date");e.classList.add("hidden"),t.value="",n.value="",c.value=""}let i=Number(localStorage.getItem("currentId"))||0;function a(e){document.querySelector(".title").textContent=e.textContent}function u(e,t,n,c,o,d){const l=document.querySelector("ul"),s=document.createElement("li");s.id=e,l.appendChild(s);const r=document.createElement("div");r.classList.add("unchecked"),s.appendChild(r);const i=document.createElement("div");i.classList.add("list-details"),s.appendChild(i),o&&(r.classList.toggle("checked"),i.classList.toggle("line-through"),i.classList.toggle("fade"));const a=document.createElement("div");a.classList.add("task-title"),a.textContent=t,i.appendChild(a);const u=document.createElement("div");u.classList.add("task-details"),u.textContent=n,i.appendChild(u);const m=document.createElement("div");m.classList.add("date"),m.textContent=c,s.appendChild(m);const p=document.createElement("div");p.classList.add("list-right"),s.appendChild(p);const f=y("star_outline");f.classList.add("star-outline"),p.appendChild(f);const h=y("star");h.classList.add("important"),p.appendChild(h),d?f.classList.add("list-hidden"):h.classList.add("list-hidden");const L=document.createElement("div");L.dataset.dropdown="",L.classList.add("edit-container"),p.appendChild(L);const S=y("more_vert");S.dataset.dropdownButton="",L.appendChild(S)}let m=localStorage.getItem("myProjectList");function p(){localStorage.setItem("myProjectList",JSON.stringify(m)),localStorage.setItem("currentId",i.toString())}function f(e,t){const n=document.querySelector(".project"),c=document.querySelector("#project-form"),o=document.createElement("div");o.setAttribute("data-project",`${e}`),o.classList.add("tile","data-tile"),n.insertBefore(o,c);const d=y("menu");d.setAttribute("data-drag",""),o.appendChild(d);const l=document.createElement("div");l.classList.add("project-info"),o.appendChild(l);const s=document.createElement("div");s.classList.add("project-name"),s.textContent=t,l.appendChild(s);const r=document.createElement("div");r.classList.add("edit-container"),r.setAttribute("data-dropdown",""),o.appendChild(r);const i=y("more_vert");i.setAttribute("data-dropdown-button",""),r.appendChild(i)}function y(e){const t=document.createElement("span");return t.classList.add("material-icons-round"),t.textContent=e,t}m=JSON.parse(m||JSON.stringify([]));const h=()=>document.querySelectorAll("[data-project]").length;const L=(e,t)=>{const n=[];return{dataProject:e,name:t,taskList:n,taskNum:n.length}};function S(){const e=document.querySelector("#project-form");document.querySelector("#project-input").value="",e.classList.add("hidden")}function g(e){document.querySelector(".selected").classList.remove("selected"),e.classList.add("selected")}document.querySelector(".project-cancel-btn").addEventListener("click",S),document.querySelector("#add-project").addEventListener("click",(function(){document.getElementById("project-form").classList.remove("hidden"),document.getElementById("project-input").focus()})),document.querySelector("#project-form").addEventListener("submit",(function(e){e.preventDefault();let t=document.querySelector("#project-input").value,n=h();const c=L(n,t);m.push(c),p(),f(n,t),S()})),document.querySelector(".left-panel").addEventListener("click",(function(e){let t=e.target.closest(".home .tile"),n=e.target.closest(".project .tile");if(null!=t){const e=t.querySelector("[data-name]");g(t),o(),a(e),document.querySelector("#add-list").classList.add("hidden")}else{if(null==n)return;{const e=n.querySelector(".project-name");let t=n.dataset.project;o(),function(e){document.querySelector("ul").textContent="",m[e].taskList.forEach((e=>{u(e.id,e.title,e.details,e.date,e.completed,e.important)}))}(t),g(n),a(e),document.getElementById("add-list").classList.remove("hidden")}}})),m.forEach((e=>{f(e.dataProject,e.name)})),document.querySelector("#add-list").addEventListener("click",(function(){document.querySelector("#list-form").classList.remove("hidden"),document.querySelector("#list-input").focus()})),document.querySelector(".list-cancel-btn").addEventListener("click",r),document.querySelector("#list-form").addEventListener("submit",(function(e){e.preventDefault();let t=document.querySelector("#list-input").value,n=document.querySelector("#list-input-detail").value,c=document.querySelector("#list-input-date").value,o=document.querySelector(".selected").dataset.project,d=function(e){let t;return t=e||"No due date",t}(c),l=i;const s=function(e,t,n,c,o,d,l){return{dataProject:e,id:t,title:n,details:c,completed:!1,important:!1,date:l}}(o,l,t,n,0,0,d);m[o].taskList.push(s),i++,p(),u(l,t,n,d),r()})),document.querySelector(".list-todo").addEventListener("click",(function(e){let t=e.target.matches(".star-outline"),c=e.target.matches(".unchecked"),d=(e.target.matches(".edit-list-submit-btn"),e.target.matches(".edit-list-cancel-btn"),e.target.matches("#list-delete")),l=e.target.matches("#list-edit");t?(function(e){e.target.classList.toggle("list-hidden"),e.target.nextElementSibling.classList.toggle("list-hidden")}(e),function(e){let t=s(e.target.closest("li").id);t.important=!t.important,p()}(e)):c?(function(e){let t=e.target,n=e.target.closest("li").querySelector(".list-details");n.classList.toggle("line-through"),n.classList.toggle("fade"),t.classList.toggle("checked")}(e),function(e){let t=s(e.target.closest("li").id);t.completed=!t.completed,p()}(e)):d?function(e){let t=e.target.closest("li"),n=s(t.id),c=n.dataProject;m[c].taskList=m[c].taskList.filter((e=>e!=n)),p(),o(),t.remove()}(e):l&&function(e){n(e.target.parentNode.parentNode),function(e){const t=e.target.closest("li");let n=t.parentNode;const c=document.getElementById("edit-list-form"),o=t.querySelector(".task-title").textContent,d=t.querySelector(".task-details").textContent,l=t.querySelector(".date").textContent,s=c.querySelector("#edit-list-title"),r=c.querySelector("#edit-list-details"),i=c.querySelector("#edit-list-date");s.value=o,r.value=d,i.value=l,t.classList.add("hidden"),c.classList.remove("hidden"),n.insertBefore(c,t)}(e)}(e)})),function(){document.addEventListener("click",e);const n=document.querySelector(".project .option");n.firstElementChild.addEventListener("click",t),n.lastElementChild.addEventListener("click",c),document.querySelector(".rename-rename-btn").addEventListener("click",(e=>{!function(e){e.preventDefault();const t=document.querySelector(".project .tile.hidden");let n=document.querySelector(".project-rename-input").value;const c=t.querySelector(".project-name");c.textContent=n;let o=t.dataset.project;m[o].name=n,p(),l(),a(c),d()}(e),e.preventDefault()})),document.querySelector(".rename-cancel-btn").addEventListener("click",(()=>{d(),l()}))}(),document.querySelector(".hidden-menu").addEventListener("click",(()=>{document.querySelector(".left-panel").classList.toggle("hidden")}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TUFBUXNELEVBQ25CNkQsRUFBWW5ILE1BQVF1RCxFQUNwQnFDLEVBQVU1RixNQUFRaUgsRUFFbEJKLEVBQVNwSSxVQUFVNkIsSUFBSSxVQUN2QjBHLEVBQWF2SSxVQUFVQyxPQUFPLFVBQzlCdUUsRUFBR2hELGFBQWErRyxFQUFjSCxFQUNsQyxDQXpCSU8sQ0FBcUJySixFQUd6QixDQ1JRc0osQ0FBYXRKLEVBSXJCLElGL0RBLFdBQ0lRLFNBQVM4RyxpQkFBaUIsUUFBU3ZILEdBRW5DLE1BQU13SixFQUFTL0ksU0FBU0MsY0FBYyxvQkFDdEM4SSxFQUFPQyxrQkFBa0JsQyxpQkFBaUIsUUFBU2pHLEdBQ25Ea0ksRUFBT0UsaUJBQWlCbkMsaUJBQWlCLFFBQVM5RSxHQUU1QmhDLFNBQVNDLGNBQWMsc0JBQy9CNkcsaUJBQWlCLFNBQVV0SCxLQStJN0MsU0FBNEJBLEdBQ3hCQSxFQUFFdUgsaUJBQ0YsTUFBTS9GLEVBQVdoQixTQUFTQyxjQUFjLHlCQUN4QyxJQUFJaUosRUFBY2xKLFNBQVNDLGNBQWMseUJBQXlCd0IsTUFDbEUsTUFBTXdFLEVBQWNqRixFQUFTZixjQUFjLGlCQUMzQ2dHLEVBQVl6RSxZQUFjMEgsRUFFMUIsSUFBSXhHLEVBQVUxQixFQUFTbUIsUUFBUUMsUUFFL0JPLEVBQVlELEdBQVNuQixLQUFPMkgsRUFDNUJsRyxJQUVBNUIsSUFDQW1CLEVBQVkwRCxHQUNaOUUsR0FDSixDQTdKUWdJLENBQW1CM0osR0FDbkJBLEVBQUV1SCxnQkFBZ0IsSUFHQS9HLFNBQVNDLGNBQWMsc0JBQy9CNkcsaUJBQWlCLFNBQVMsS0FDcEMzRixJQUNBQyxHQUF1QixHQUUvQixDSWRBZ0ksR0FFbUJwSixTQUFTQyxjQUFjLGdCQUMvQjZHLGlCQUFpQixTQUFTLEtBQ2Y5RyxTQUFTQyxjQUFjLGVBQy9CQyxVQUFVTyxPQUFPLFNBQVMsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3RvZG8tYXBwLy4vc3JjL2VkaXRpbmdQcm9qZWN0LmpzIiwid2VicGFjazovL3RvZG8tYXBwLy4vc3JjL2VkaXRpbmdUYXNrLmpzIiwid2VicGFjazovL3RvZG8tYXBwLy4vc3JjL2NyZWF0aW5nVGFzay5qcyIsIndlYnBhY2s6Ly90b2RvLWFwcC8uL3NyYy9jcmVhdGluZ1Byb2plY3QuanMiLCJ3ZWJwYWNrOi8vdG9kby1hcHAvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcHJvamVjdExpc3QsIHNhdmVUb0xvY2FsU3RvcmFnZSB9IGZyb20gXCIuL2NyZWF0aW5nUHJvamVjdFwiXG5pbXBvcnQgeyB1cGRhdGVUaXRsZSB9IGZyb20gXCIuL2NyZWF0aW5nVGFza1wiXG5cbmZ1bmN0aW9uIGVkaXRDb250YWluZXJFdmVudExpc3RlbmVyKCkge1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBzaG93RHJvcERvd24pO1xuXG4gICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3QgLm9wdGlvbicpO1xuICAgIG9wdGlvbi5maXJzdEVsZW1lbnRDaGlsZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNob3dSZW5hbWVGb3JtKTtcbiAgICBvcHRpb24ubGFzdEVsZW1lbnRDaGlsZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGRlbGV0ZVByb2plY3QpO1xuICAgIC8vZXZlbnQgbGlzdGVuZXIgb2YgcmVuYW1lRm9ybSdzIHJlbmFtZSBhbmQgY2FuY2VsIGJ1dHRvbnNcbiAgICBjb25zdCBmb3JtUmVuYW1lQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnJlbmFtZS1yZW5hbWUtYnRuJyk7XG4gICAgZm9ybVJlbmFtZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgIHByb2Nlc3NSZW5hbWVJbnB1dChlKTtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuXG4gICAgY29uc3QgZm9ybUNhbmNlbEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yZW5hbWUtY2FuY2VsLWJ0bicpO1xuICAgIGZvcm1DYW5jZWxCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIHJldmVydFJlbmFtZUZvcm1Mb2NhdGlvbigpO1xuICAgICAgICBkaXNwbGF5UmVuYW1lZFByb2plY3QoKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gc2hvd0Ryb3BEb3duKGUpIHtcbiAgICBjb25zdCBpc0Ryb3BEb3duQnV0dG9uID0gZS50YXJnZXQubWF0Y2hlcygnW2RhdGEtZHJvcGRvd24tYnV0dG9uXScpO1xuICAgIGlmICghaXNEcm9wRG93bkJ1dHRvbiAmJiBlLnRhcmdldC5jbG9zZXN0KCdbZGF0YS1kcm9wZG93bl0nKSAhPSBudWxsKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgbGV0IGN1cnJlbnREcm9wRG93bjtcbiAgICBpZiAoaXNEcm9wRG93bkJ1dHRvbikge1xuICAgICAgICByZWxvY2F0ZU9wdGlvbihlKTtcbiAgICAgICAgY3VycmVudERyb3BEb3duID0gZS50YXJnZXQuY2xvc2VzdCgnW2RhdGEtZHJvcGRvd25dJyk7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjdXJyZW50RHJvcERvd24uY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJyk7XG4gICAgICAgIH0sIDApO1xuICAgIH1cblxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWRyb3Bkb3duXS5hY3RpdmUnKS5mb3JFYWNoKGRyb3Bkb3duID0+IHtcbiAgICAgICAgLy9pZiBjbGljayBhbnl3aGVyZSBlbHNlIGN1cnJlbnREcm9wRG93biA9IHVuZGVmaW5lZCBtZWFuaW5nIGFsbCBhY3RpdmUgb25lcyBhcmUgY2xvc2VkXG4gICAgICAgIGlmIChkcm9wZG93biA9PT0gY3VycmVudERyb3BEb3duKSB7IC8vaWYgaXRzIHRoZSBjdXJyZW50IGJ1dHRvbiB0aGVuIGRvIG50aFxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGRyb3Bkb3duLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIik7IC8vYmFzaWNhbGx5IGNsb3NlIGFsbCBkcm9wZG93biBvdGhlciBkcm9wIGRvd24gYmVmb3JlIG9wZW4gYW5vdGhlclxuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBzaG93UmVuYW1lRm9ybShlKSB7XG4gICAgbGV0IGVkaXRDb250YWluZXJOb2RlID0gZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlO1xuICAgIGxldCB0aWxlTm9kZSA9IGVkaXRDb250YWluZXJOb2RlLnBhcmVudE5vZGU7XG5cbiAgICBoaWRlRHJvcERvd24oZWRpdENvbnRhaW5lck5vZGUpO1xuICAgIGxldCBoYXZlRm9ybSA9IGNoZWNrRm9ybUV4aXN0KCk7XG4gICAgaWYgKGhhdmVGb3JtID09PSB0cnVlKSB7XG4gICAgICAgIHJldmVydFJlbmFtZUZvcm1Mb2NhdGlvbigpO1xuICAgICAgICBkaXNwbGF5UmVuYW1lZFByb2plY3QoKTtcbiAgICB9XG5cbiAgICByZWxvY2F0ZVJlbmFtZUZvcm0odGlsZU5vZGUpO1xuICAgIGFuaW1hdGVSZW5hbWVGb3JtKCk7XG5cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdC1yZW5hbWUtaW5wdXQnKS5mb2N1cygpO1xuICAgIHRpbGVOb2RlLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XG59XG5cbmZ1bmN0aW9uIGhpZGVEcm9wRG93bihlZGl0Q29udGFpbmVyTm9kZSkge1xuICAgIGVkaXRDb250YWluZXJOb2RlLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xufVxuXG5mdW5jdGlvbiBkZWxldGVQcm9qZWN0KGUpIHtcbiAgICBsZXQgdGlsZSA9IGUudGFyZ2V0LmNsb3Nlc3QoJy50aWxlJyk7XG4gICAgbGV0IGluZGV4ID0gdGlsZS5kYXRhc2V0LnByb2plY3Q7XG5cbiAgICBpZiAodGlsZS5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpIHtcbiAgICAgICAgY29uc3QgdG9kYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3RvZGF5XCIpO1xuICAgICAgICBjb25zdCBuYW1lTm9kZSA9IHRvZGF5LnF1ZXJ5U2VsZWN0b3IoXCJbZGF0YS1uYW1lXVwiKTtcblxuICAgICAgICB0b2RheS5jbGFzc0xpc3QuYWRkKFwic2VsZWN0ZWRcIik7XG4gICAgICAgIHVwZGF0ZVRpdGxlKG5hbWVOb2RlKTtcbiAgICB9XG5cbiAgICByZXZlcnRPcHRpb25Mb2NhdGlvbihlKTtcbiAgICB0aWxlLnJlbW92ZSgpO1xuICAgIHNvcnRBcnJheSgpO1xuICAgIHByb2plY3RMaXN0LnNwbGljZShpbmRleCwgMSk7XG4gICAgc2F2ZVRvTG9jYWxTdG9yYWdlKCk7XG59XG5cbmZ1bmN0aW9uIHJldmVydE9wdGlvbkxvY2F0aW9uKCkge1xuICAgIGNvbnN0IHByb2plY3RPcHRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvamVjdC1vcHRpb24nKTtcbiAgICBwcm9qZWN0T3B0aW9uLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XG4gICAgY29uc3QgcHJvamVjdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdFwiKTtcbiAgICBwcm9qZWN0LmFwcGVuZENoaWxkKHByb2plY3RPcHRpb24pO1xuICAgIC8vcmV2ZXJ0IG9wdGlvbiBET00gaW4gcmlnaHQgcGFuZWxcbiAgICBjb25zdCBsaXN0T3B0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNsaXN0LW9wdGlvblwiKTtcbiAgICBsaXN0T3B0aW9uLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XG4gICAgY29uc3QgbGlzdFRvRG8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmxpc3QtdG9kb1wiKTtcbiAgICBsaXN0VG9Eby5hcHBlbmRDaGlsZChsaXN0T3B0aW9uKTtcbn1cblxuZnVuY3Rpb24gcmVsb2NhdGVPcHRpb24oZSkge1xuICAgIGNvbnN0IGVkaXRDb250YWluZXIgPSBlLnRhcmdldC5jbG9zZXN0KCcuZWRpdC1jb250YWluZXInKTtcblxuICAgIGlmIChlLnRhcmdldC5jbG9zZXN0KCcudGlsZScpICE9IG51bGwpIHtcbiAgICAgICAgY29uc3QgcHJvamVjdE9wdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcm9qZWN0LW9wdGlvbicpO1xuICAgICAgICBwcm9qZWN0T3B0aW9uLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgICAgICBlZGl0Q29udGFpbmVyLmFwcGVuZENoaWxkKHByb2plY3RPcHRpb24pO1xuICAgIH0gZWxzZSBpZiAoZS50YXJnZXQuY2xvc2VzdChcImxpXCIpICE9IG51bGwpIHsgLy9wb3AgdXAgaW4gbGlzdFxuICAgICAgICBjb25zdCBsaXN0T3B0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsaXN0LW9wdGlvblwiKTtcbiAgICAgICAgbGlzdE9wdGlvbi5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZGVuXCIpO1xuICAgICAgICBlZGl0Q29udGFpbmVyLmFwcGVuZENoaWxkKGxpc3RPcHRpb24pO1xuICAgIH1cblxufVxuXG5mdW5jdGlvbiBjaGVja0Zvcm1FeGlzdCgpIHtcbiAgICBjb25zdCByZW5hbWVGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3JlbmFtZS1mb3JtJyk7XG5cbiAgICBpZiAocmVuYW1lRm9ybS5jbGFzc0xpc3QuY29udGFpbnMoJ2hpZGRlbicpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG59XG5cbi8vcmV2ZXJ0IGZvcm0gYmFjayB0byBpdHMgb3JpZ2luYWwgcG9zdGluZyB1bmRlciAucHJvamVjdFxuZnVuY3Rpb24gcmV2ZXJ0UmVuYW1lRm9ybUxvY2F0aW9uKCkge1xuICAgIGNvbnN0IHJlbmFtZUZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlbmFtZS1mb3JtXCIpO1xuICAgIGNvbnN0IHByb2plY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3RcIik7XG5cbiAgICByZW5hbWVGb3JtLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XG4gICAgcHJvamVjdC5hcHBlbmRDaGlsZChyZW5hbWVGb3JtKTtcbn1cblxuZnVuY3Rpb24gcmVsb2NhdGVSZW5hbWVGb3JtKHRpbGVOb2RlKSB7XG4gICAgY29uc3QgcHJvamVjdE5vZGUgPSB0aWxlTm9kZS5wYXJlbnROb2RlO1xuICAgIGNvbnN0IHJlbmFtZUZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVuYW1lLWZvcm0nKTtcblxuICAgIGNvbnN0IG5hbWVOb2RlID0gdGlsZU5vZGUucXVlcnlTZWxlY3RvcignLnByb2plY3QtbmFtZScpO1xuICAgIGxldCBuYW1lID0gbmFtZU5vZGUudGV4dENvbnRlbnQ7XG5cbiAgICBjb25zdCBpbnB1dCA9IHJlbmFtZUZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXQnKTtcbiAgICBpbnB1dC52YWx1ZSA9IG5hbWU7XG5cbiAgICBwcm9qZWN0Tm9kZS5pbnNlcnRCZWZvcmUocmVuYW1lRm9ybSwgdGlsZU5vZGUpO1xufVxuXG5mdW5jdGlvbiBhbmltYXRlUmVuYW1lRm9ybSgpIHtcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3JlbmFtZS1mb3JtJyk7XG5cbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgZm9ybS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICB9LCAwKTtcbn1cblxuZnVuY3Rpb24gcHJvY2Vzc1JlbmFtZUlucHV0KGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgdGlsZU5vZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdCAudGlsZS5oaWRkZW4nKTtcbiAgICBsZXQgcmVuYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdC1yZW5hbWUtaW5wdXQnKS52YWx1ZTtcbiAgICBjb25zdCBwcm9qZWN0TmFtZSA9IHRpbGVOb2RlLnF1ZXJ5U2VsZWN0b3IoJy5wcm9qZWN0LW5hbWUnKTtcbiAgICBwcm9qZWN0TmFtZS50ZXh0Q29udGVudCA9IHJlbmFtZUlucHV0O1xuXG4gICAgbGV0IGRhdGFOdW0gPSB0aWxlTm9kZS5kYXRhc2V0LnByb2plY3Q7XG5cbiAgICBwcm9qZWN0TGlzdFtkYXRhTnVtXS5uYW1lID0gcmVuYW1lSW5wdXQ7XG4gICAgc2F2ZVRvTG9jYWxTdG9yYWdlKCk7XG5cbiAgICBkaXNwbGF5UmVuYW1lZFByb2plY3QoKTtcbiAgICB1cGRhdGVUaXRsZShwcm9qZWN0TmFtZSk7XG4gICAgcmV2ZXJ0UmVuYW1lRm9ybUxvY2F0aW9uKCk7XG59XG5cbmZ1bmN0aW9uIGRpc3BsYXlSZW5hbWVkUHJvamVjdCgpIHtcbiAgICBjb25zdCBoaWRkZW5UaWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZGl2LmhpZGRlbicpO1xuICAgIGhpZGRlblRpbGUuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG59XG5cbmZ1bmN0aW9uIHNvcnRBcnJheSgpIHtcbiAgICBsZXQgaSA9IDA7XG4gICAgY29uc3QgdGlsZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucHJvamVjdCAudGlsZScpO1xuICAgIHRpbGVzLmZvckVhY2goKHRpbGUpID0+IHtcbiAgICAgICAgbGV0IGRhdGFOdW0gPSB0aWxlLmRhdGFzZXQucHJvamVjdDtcbiAgICAgICAgdGlsZS5kYXRhc2V0LnByb2plY3QgPSBpO1xuICAgICAgICBwcm9qZWN0TGlzdFtkYXRhTnVtXS5kYXRhUHJvamVjdCA9IGk7XG4gICAgICAgIGkrKztcbiAgICB9KTtcblxuICAgIHByb2plY3RMaXN0LnNvcnQoKGEsIGIpID0+IGEuZGF0YVByb2plY3QgLSBiLmRhdGFQcm9qZWN0KTtcbiAgICBzYXZlVG9Mb2NhbFN0b3JhZ2UoKTtcblxufVxuXG5leHBvcnQgeyBlZGl0Q29udGFpbmVyRXZlbnRMaXN0ZW5lciwgc2hvd1JlbmFtZUZvcm0sIGhpZGVEcm9wRG93biwgZGVsZXRlUHJvamVjdCwgcmV2ZXJ0T3B0aW9uTG9jYXRpb24sIHNvcnRBcnJheSB9OyIsImltcG9ydCB7IHByb2plY3RMaXN0LCBzYXZlVG9Mb2NhbFN0b3JhZ2UgfSBmcm9tIFwiLi9jcmVhdGluZ1Byb2plY3RcIjtcbmltcG9ydCB7IGhpZGVEcm9wRG93biwgcmV2ZXJ0T3B0aW9uTG9jYXRpb24gfSBmcm9tIFwiLi9lZGl0aW5nUHJvamVjdFwiO1xuaW1wb3J0IHsgZGlzcGxheVRhc2ssIHByb2Nlc3NEYXRlRGF0YSB9IGZyb20gXCIuL2NyZWF0aW5nVGFza1wiO1xuaW1wb3J0IHsgY2hlY2tXaGljaEhvbWVUaWxlIH0gZnJvbSBcIi4vaG9tZVNlY3Rpb25cIjtcblxuZnVuY3Rpb24gc3R5bGVDb21wbGV0ZWRUYXNrKGUpIHtcbiAgICBsZXQgdW5jaGVja2VkTm9kZSA9IGUudGFyZ2V0O1xuICAgIGxldCB0YXNrVGlsZSA9IGUudGFyZ2V0LmNsb3Nlc3QoJ2xpJyk7XG4gICAgbGV0IGxpc3REZXRhaWxzID0gdGFza1RpbGUucXVlcnlTZWxlY3RvcignLmxpc3QtZGV0YWlscycpO1xuICAgIGxpc3REZXRhaWxzLmNsYXNzTGlzdC50b2dnbGUoJ2xpbmUtdGhyb3VnaCcpO1xuICAgIGxpc3REZXRhaWxzLmNsYXNzTGlzdC50b2dnbGUoJ2ZhZGUnKTtcbiAgICB1bmNoZWNrZWROb2RlLmNsYXNzTGlzdC50b2dnbGUoJ2NoZWNrZWQnKTtcblxufVxuXG5mdW5jdGlvbiB1cGRhdGVDb21wbGV0ZWRUYXNrKGUpIHtcbiAgICBsZXQgbGlzdElEID0gZS50YXJnZXQuY2xvc2VzdCgnbGknKS5pZDtcbiAgICBsZXQgc2VsZWN0ZWRUYXNrID0gZmluZFNlbGVjdGVkVGFzayhsaXN0SUQpO1xuICAgIHNlbGVjdGVkVGFzay5jb21wbGV0ZWQgPSAhc2VsZWN0ZWRUYXNrLmNvbXBsZXRlZDtcbiAgICBzYXZlVG9Mb2NhbFN0b3JhZ2UoKTtcbn1cblxuZnVuY3Rpb24gc3R5bGVJbXBvcnRhbnRUYXNrKGUpIHtcbiAgICBsZXQgc3Rhck91dGxpbmUgPSBlLnRhcmdldDtcbiAgICBzdGFyT3V0bGluZS5jbGFzc0xpc3QudG9nZ2xlKCdsaXN0LWhpZGRlbicpO1xuXG4gICAgbGV0IHN0YXJGaWxsZWQgPSBlLnRhcmdldC5uZXh0RWxlbWVudFNpYmxpbmc7XG4gICAgc3RhckZpbGxlZC5jbGFzc0xpc3QudG9nZ2xlKCdsaXN0LWhpZGRlbicpO1xuXG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUltcG9ydGFudFRhc2soZSkge1xuICAgIGxldCBsaXN0SWQgPSBlLnRhcmdldC5jbG9zZXN0KCdsaScpLmlkO1xuICAgIGxldCBzZWxlY3RlZFRhc2sgPSBmaW5kU2VsZWN0ZWRUYXNrKGxpc3RJZCk7XG4gICAgc2VsZWN0ZWRUYXNrLmltcG9ydGFudCA9ICFzZWxlY3RlZFRhc2suaW1wb3J0YW50O1xuICAgIHNhdmVUb0xvY2FsU3RvcmFnZSgpO1xufVxuXG5cblxuZnVuY3Rpb24gZGVsZXRlVGFzayhlKSB7XG4gICAgbGV0IGxpc3ROb2RlID0gZS50YXJnZXQuY2xvc2VzdCgnbGknKTtcbiAgICBsZXQgaWQgPSBsaXN0Tm9kZS5pZDtcbiAgICBsZXQgc2VsZWN0ZWRUYXNrID0gZmluZFNlbGVjdGVkVGFzayhpZCk7XG4gICAgbGV0IGRhdGFQcm9qZWN0ID0gc2VsZWN0ZWRUYXNrLmRhdGFQcm9qZWN0O1xuICAgIHByb2plY3RMaXN0W2RhdGFQcm9qZWN0XS50YXNrTGlzdCA9IHByb2plY3RMaXN0W2RhdGFQcm9qZWN0XS50YXNrTGlzdC5maWx0ZXIodGFzayA9PiB0YXNrICE9IHNlbGVjdGVkVGFzayk7XG4gICAgc2F2ZVRvTG9jYWxTdG9yYWdlKCk7XG4gICAgcmV2ZXJ0T3B0aW9uTG9jYXRpb24oKTtcbiAgICBsaXN0Tm9kZS5yZW1vdmUoKTtcblxufVxuXG5mdW5jdGlvbiBmaW5kU2VsZWN0ZWRUYXNrKGxpc3RJZCkge1xuICAgIGxldCBzZWxlY3RlZFRhc2sgPSBwcm9qZWN0TGlzdC5yZWR1Y2UoKGFjYywgcHJvamVjdCkgPT4ge1xuICAgICAgICBsZXQgY3VycmVudFRhc2sgPSBwcm9qZWN0LnRhc2tMaXN0LmZpbmQodGFzayA9PiB0YXNrLmlkID09IGxpc3RJZCk7XG4gICAgICAgIGlmIChjdXJyZW50VGFzayAhPSBudWxsKSB7XG4gICAgICAgICAgICBhY2MgPSBjdXJyZW50VGFzaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWNjO1xuICAgIH0sIHt9KTtcblxuICAgIHJldHVybiBzZWxlY3RlZFRhc2s7XG59XG5cbmZ1bmN0aW9uIHNob3dFZGl0Rm9ybShlKSB7XG4gICAgbGV0IGVkaXRDb250YWluZXJOb2RlID0gZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlO1xuICAgIGhpZGVEcm9wRG93bihlZGl0Q29udGFpbmVyTm9kZSk7XG4gICAgcmVsb2NhdGVFZGl0TGlzdEZvcm0oZSk7XG5cblxufVxuXG5mdW5jdGlvbiByZWxvY2F0ZUVkaXRMaXN0Rm9ybShlKSB7XG4gICAgY29uc3QgbGlzdE5vZGUgPSBlLnRhcmdldC5jbG9zZXN0KCdsaScpO1xuICAgIGxldCB1bCA9IGxpc3ROb2RlLnBhcmVudE5vZGU7XG5cbiAgICBjb25zdCBlZGl0TGlzdEZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZWRpdC1saXN0LWZvcm0nKTtcbiAgICBjb25zdCB0YXNrVGl0bGUgPSBsaXN0Tm9kZS5xdWVyeVNlbGVjdG9yKCcudGFzay10aXRsZScpLnRleHRDb250ZW50O1xuICAgIGNvbnN0IHRhc2tEZXRhaWxzID0gbGlzdE5vZGUucXVlcnlTZWxlY3RvcignLnRhc2stZGV0YWlscycpLnRleHRDb250ZW50O1xuICAgIGNvbnN0IHRhc2tEYXRlID0gbGlzdE5vZGUucXVlcnlTZWxlY3RvcignLmRhdGUnKS50ZXh0Q29udGVudDtcblxuICAgIGNvbnN0IHRpdGxlSW5wdXQgPSBlZGl0TGlzdEZvcm0ucXVlcnlTZWxlY3RvcihcIiNlZGl0LWxpc3QtdGl0bGVcIik7XG4gICAgY29uc3QgZGV0YWlsSW5wdXQgPSBlZGl0TGlzdEZvcm0ucXVlcnlTZWxlY3RvcihcIiNlZGl0LWxpc3QtZGV0YWlsc1wiKTtcbiAgICBjb25zdCBkYXRlSW5wdXQgPSBlZGl0TGlzdEZvcm0ucXVlcnlTZWxlY3RvcihcIiNlZGl0LWxpc3QtZGF0ZVwiKTtcblxuICAgIHRpdGxlSW5wdXQudmFsdWUgPSB0YXNrVGl0bGU7XG4gICAgZGV0YWlsSW5wdXQudmFsdWUgPSB0YXNrRGV0YWlscztcbiAgICBkYXRlSW5wdXQudmFsdWUgPSB0YXNrRGF0ZTtcblxuICAgIGxpc3ROb2RlLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XG4gICAgZWRpdExpc3RGb3JtLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRkZW5cIik7XG4gICAgdWwuaW5zZXJ0QmVmb3JlKGVkaXRMaXN0Rm9ybSwgbGlzdE5vZGUpO1xufVxuXG5mdW5jdGlvbiByZXZlcnRFZGl0Rm9ybUxvY2F0aW9uKCkge1xuXG59XG5cbmZ1bmN0aW9uIHByb2Nlc3NFZGl0VGFzayhlKSB7XG5cbn1cblxuZnVuY3Rpb24gc2hvd0hpZGRlblRhc2soKSB7XG5cbn1cblxuZXhwb3J0IHtcbiAgICBzdHlsZUNvbXBsZXRlZFRhc2ssXG4gICAgc3R5bGVJbXBvcnRhbnRUYXNrLFxuICAgIHVwZGF0ZUNvbXBsZXRlZFRhc2ssXG4gICAgdXBkYXRlSW1wb3J0YW50VGFzayxcbiAgICBkZWxldGVUYXNrLFxuICAgIHNob3dFZGl0Rm9ybSxcbiAgICByZWxvY2F0ZUVkaXRMaXN0Rm9ybSxcbiAgICByZXZlcnRFZGl0Rm9ybUxvY2F0aW9uLFxuICAgIHByb2Nlc3NFZGl0VGFzayxcbiAgICBzaG93SGlkZGVuVGFza1xufSIsImltcG9ydCB7IHByb2plY3RMaXN0LCBjcmVhdGVTcGFuSWNvbiwgc2F2ZVRvTG9jYWxTdG9yYWdlIH0gZnJvbSBcIi4vY3JlYXRpbmdQcm9qZWN0XCJcbmltcG9ydCB7XG4gICAgc3R5bGVDb21wbGV0ZWRUYXNrLFxuICAgIHVwZGF0ZUNvbXBsZXRlZFRhc2ssXG4gICAgc3R5bGVJbXBvcnRhbnRUYXNrLFxuICAgIHVwZGF0ZUltcG9ydGFudFRhc2ssXG4gICAgZGVsZXRlVGFzayxcbiAgICBzaG93RWRpdEZvcm0sXG4gICAgcmV2ZXJ0RWRpdEZvcm1Mb2NhdGlvbixcbiAgICBwcm9jZXNzRWRpdFRhc2ssXG4gICAgc2hvd0hpZGRlblRhc2tcbn0gZnJvbSBcIi4vZWRpdGluZ1Rhc2tcIlxuXG5mdW5jdGlvbiBsaXN0RXZlbnQoKSB7XG4gICAgY29uc3QgYWRkTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWxpc3RcIik7XG4gICAgYWRkTGlzdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgc2hvd0xpc3RGb3JtKTtcblxuICAgIGNvbnN0IGNhbmNlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5saXN0LWNhbmNlbC1idG4nKTtcbiAgICBjYW5jZWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhpZGVMaXN0Rm9ybSk7XG5cbiAgICBjb25zdCBsaXN0U3VibWl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2xpc3QtZm9ybScpO1xuICAgIGxpc3RTdWJtaXQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgcHJvY2Vzc0xpc3RJbnB1dCk7XG5cbiAgICBjb25zdCB0b2RvTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5saXN0LXRvZG8nKTtcbiAgICB0b2RvTGlzdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2hlY2tMaXN0RXZlbnQpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVUYXNrKGRhdGFQcm9qZWN0LCBpZCwgdGl0bGUsIGRldGFpbHMsIGNvbXBsZXRlZCwgaW1wb3J0YW50LCBkYXRlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZGF0YVByb2plY3QsXG4gICAgICAgIGlkLFxuICAgICAgICB0aXRsZSxcbiAgICAgICAgZGV0YWlscyxcbiAgICAgICAgY29tcGxldGVkOiBjb21wbGV0ZWQsXG4gICAgICAgIGltcG9ydGFudDogaW1wb3J0YW50LFxuICAgICAgICBkYXRlOiBkYXRlXG4gICAgfVxufVxuXG5mdW5jdGlvbiBjaGVja0xpc3RFdmVudChlKSB7XG4gICAgbGV0IGlzU3Rhckljb24gPSBlLnRhcmdldC5tYXRjaGVzKCcuc3Rhci1vdXRsaW5lJyk7XG4gICAgbGV0IGlzQ2lyY2xlSWNvbiA9IGUudGFyZ2V0Lm1hdGNoZXMoJy51bmNoZWNrZWQnKTtcblxuICAgIGxldCBpc0VkaXRTdWJtaXRCdG4gPSBlLnRhcmdldC5tYXRjaGVzKCcuZWRpdC1saXN0LXN1Ym1pdC1idG4nKTtcbiAgICBsZXQgaXNFZGl0VGFza0NhbmNlbCA9IGUudGFyZ2V0Lm1hdGNoZXMoJy5lZGl0LWxpc3QtY2FuY2VsLWJ0bicpO1xuXG4gICAgbGV0IGlzRGVsZXRlQnRuID0gZS50YXJnZXQubWF0Y2hlcygnI2xpc3QtZGVsZXRlJyk7XG4gICAgbGV0IGlzRWRpdEJ0biA9IGUudGFyZ2V0Lm1hdGNoZXMoJyNsaXN0LWVkaXQnKTtcblxuXG5cblxuXG4gICAgaWYgKGlzU3Rhckljb24pIHtcbiAgICAgICAgc3R5bGVJbXBvcnRhbnRUYXNrKGUpO1xuICAgICAgICB1cGRhdGVJbXBvcnRhbnRUYXNrKGUpO1xuICAgIH0gZWxzZSBpZiAoaXNDaXJjbGVJY29uKSB7XG4gICAgICAgIHN0eWxlQ29tcGxldGVkVGFzayhlKTtcbiAgICAgICAgdXBkYXRlQ29tcGxldGVkVGFzayhlKTtcbiAgICB9IGVsc2UgaWYgKGlzRGVsZXRlQnRuKSB7XG4gICAgICAgIGRlbGV0ZVRhc2soZSk7XG4gICAgfSBlbHNlIGlmIChpc0VkaXRCdG4pIHtcbiAgICAgICAgc2hvd0VkaXRGb3JtKGUpO1xuICAgIH0gZWxzZSBpZiAoaXNFZGl0U3VibWl0QnRuKSB7XG4gICAgICAgIHByb2Nlc3NFZGl0VGFzayhlKTtcbiAgICB9XG59XG5cblxuXG4vL3BvcCB1cCB0aGUgYWRkIGxpc3QgZm9ybVxuZnVuY3Rpb24gc2hvd0xpc3RGb3JtKCkge1xuICAgIGNvbnN0IGxpc3RGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2xpc3QtZm9ybScpO1xuICAgIGxpc3RGb3JtLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNsaXN0LWlucHV0JykuZm9jdXMoKTtcbn1cblxuLy9oaWRlIHRoZSBhZGQgbGlzdCBmb3JtXG5mdW5jdGlvbiBoaWRlTGlzdEZvcm0oKSB7XG4gICAgY29uc3QgbGlzdEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbGlzdC1mb3JtJyk7XG4gICAgY29uc3QgbGlzdElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2xpc3QtaW5wdXQnKTtcbiAgICBjb25zdCBsaXN0SW5wdXREZXRhaWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbGlzdC1pbnB1dC1kZXRhaWwnKTtcbiAgICBjb25zdCBsaXN0SW5wdXREYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2xpc3QtaW5wdXQtZGF0ZScpO1xuXG4gICAgbGlzdEZvcm0uY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgbGlzdElucHV0LnZhbHVlID0gXCJcIjtcbiAgICBsaXN0SW5wdXREZXRhaWwudmFsdWUgPSBcIlwiO1xuICAgIGxpc3RJbnB1dERhdGUudmFsdWUgPSBcIlwiO1xufVxuLy9nZXQgaWQgZnJvbSBsb2NhbCBzdG9yYWdlIG9yIGdldCBhIGRlZmF1bHQgb25lXG5sZXQgZGVmYXVsdElkID0gMDtcbmxldCBpZCA9IE51bWJlcihsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImN1cnJlbnRJZFwiKSkgfHwgZGVmYXVsdElkO1xuXG5mdW5jdGlvbiBwcm9jZXNzTGlzdElucHV0KGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgbGV0IHRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2xpc3QtaW5wdXQnKS52YWx1ZTtcbiAgICBsZXQgZGV0YWlscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNsaXN0LWlucHV0LWRldGFpbCcpLnZhbHVlO1xuICAgIGxldCBkYXRlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbGlzdC1pbnB1dC1kYXRlJykudmFsdWU7XG5cbiAgICBsZXQgZGF0YVByb2plY3QgPSBmaW5kQ3VycmVudERhdGFQcm9qZWN0KCk7XG4gICAgbGV0IGRhdGUgPSBwcm9jZXNzRGF0ZURhdGEoZGF0ZUlucHV0KTtcbiAgICBsZXQgbGlzdElEID0gaWQ7XG5cbiAgICBjb25zdCBuZXdUYXNrID0gY3JlYXRlVGFzayhkYXRhUHJvamVjdCwgbGlzdElELCB0aXRsZSwgZGV0YWlscywgZmFsc2UsIGZhbHNlLCBkYXRlKTtcbiAgICBwcm9qZWN0TGlzdFtkYXRhUHJvamVjdF0udGFza0xpc3QucHVzaChuZXdUYXNrKTtcbiAgICBpZCsrO1xuICAgIHNhdmVUb0xvY2FsU3RvcmFnZSgpO1xuXG4gICAgYWRkVGFzayhsaXN0SUQsIHRpdGxlLCBkZXRhaWxzLCBkYXRlKTtcbiAgICBoaWRlTGlzdEZvcm0oKTtcbn1cbi8vZGlzcGF5IGFsbCB0aGUgdGFzayBpbiBhIHByb2plY3RcbmZ1bmN0aW9uIGRpc3BsYXlUYXNrKGRhdGFQcm9qZWN0KSB7XG4gICAgY29uc3QgdWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpO1xuICAgIHVsLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBwcm9qZWN0TGlzdFtkYXRhUHJvamVjdF0udGFza0xpc3QuZm9yRWFjaCh0YXNrID0+IHtcbiAgICAgICAgYWRkVGFzayh0YXNrLmlkLCB0YXNrLnRpdGxlLCB0YXNrLmRldGFpbHMsIHRhc2suZGF0ZSwgdGFzay5jb21wbGV0ZWQsIHRhc2suaW1wb3J0YW50KTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gdXBkYXRlVGl0bGUobmFtZU5vZGUpIHtcbiAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50aXRsZScpO1xuICAgIHRpdGxlLnRleHRDb250ZW50ID0gbmFtZU5vZGUudGV4dENvbnRlbnQ7XG59XG5cblxuXG5cblxuZnVuY3Rpb24gYWRkVGFzayhsaXN0SWQsIHRpdGxlLCBkZXRhaWxzLCBkYXRlLCBjb21wbGV0ZWQsIGltcG9ydGFudCkge1xuICAgIGNvbnN0IHVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigndWwnKTtcbiAgICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgbGkuaWQgPSBsaXN0SWQ7XG4gICAgdWwuYXBwZW5kQ2hpbGQobGkpO1xuXG4gICAgY29uc3QgdW5jaGVja2VkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdW5jaGVja2VkLmNsYXNzTGlzdC5hZGQoJ3VuY2hlY2tlZCcpO1xuICAgIGxpLmFwcGVuZENoaWxkKHVuY2hlY2tlZCk7XG5cbiAgICBjb25zdCBsaXN0RGV0YWlscyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGxpc3REZXRhaWxzLmNsYXNzTGlzdC5hZGQoJ2xpc3QtZGV0YWlscycpO1xuICAgIGxpLmFwcGVuZENoaWxkKGxpc3REZXRhaWxzKTtcblxuICAgIGlmIChjb21wbGV0ZWQpIHtcbiAgICAgICAgdW5jaGVja2VkLmNsYXNzTGlzdC50b2dnbGUoJ2NoZWNrZWQnKTtcbiAgICAgICAgbGlzdERldGFpbHMuY2xhc3NMaXN0LnRvZ2dsZSgnbGluZS10aHJvdWdoJyk7XG4gICAgICAgIGxpc3REZXRhaWxzLmNsYXNzTGlzdC50b2dnbGUoJ2ZhZGUnKTtcbiAgICB9XG5cbiAgICBjb25zdCB0YXNrVGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0YXNrVGl0bGUuY2xhc3NMaXN0LmFkZChcInRhc2stdGl0bGVcIik7XG4gICAgdGFza1RpdGxlLnRleHRDb250ZW50ID0gdGl0bGU7XG4gICAgbGlzdERldGFpbHMuYXBwZW5kQ2hpbGQodGFza1RpdGxlKTtcblxuICAgIGNvbnN0IHRhc2tEZXRhaWxzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdGFza0RldGFpbHMuY2xhc3NMaXN0LmFkZChcInRhc2stZGV0YWlsc1wiKTtcbiAgICB0YXNrRGV0YWlscy50ZXh0Q29udGVudCA9IGRldGFpbHM7XG4gICAgbGlzdERldGFpbHMuYXBwZW5kQ2hpbGQodGFza0RldGFpbHMpO1xuXG4gICAgY29uc3QgZGF0ZURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGRhdGVEaXYuY2xhc3NMaXN0LmFkZChcImRhdGVcIik7XG4gICAgZGF0ZURpdi50ZXh0Q29udGVudCA9IGRhdGU7XG4gICAgbGkuYXBwZW5kQ2hpbGQoZGF0ZURpdik7XG5cbiAgICBjb25zdCBsaXN0UmlnaHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBsaXN0UmlnaHQuY2xhc3NMaXN0LmFkZCgnbGlzdC1yaWdodCcpO1xuICAgIGxpLmFwcGVuZENoaWxkKGxpc3RSaWdodCk7XG5cbiAgICBjb25zdCBzdGFyT3V0bGluZSA9IGNyZWF0ZVNwYW5JY29uKCdzdGFyX291dGxpbmUnKTtcbiAgICBzdGFyT3V0bGluZS5jbGFzc0xpc3QuYWRkKCdzdGFyLW91dGxpbmUnKTtcbiAgICBsaXN0UmlnaHQuYXBwZW5kQ2hpbGQoc3Rhck91dGxpbmUpO1xuXG4gICAgY29uc3Qgc3RhciA9IGNyZWF0ZVNwYW5JY29uKCdzdGFyJyk7XG4gICAgc3Rhci5jbGFzc0xpc3QuYWRkKCdpbXBvcnRhbnQnKTtcbiAgICBsaXN0UmlnaHQuYXBwZW5kQ2hpbGQoc3Rhcik7XG5cbiAgICBpZiAoaW1wb3J0YW50KSB7XG4gICAgICAgIHN0YXJPdXRsaW5lLmNsYXNzTGlzdC5hZGQoJ2xpc3QtaGlkZGVuJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgc3Rhci5jbGFzc0xpc3QuYWRkKCdsaXN0LWhpZGRlbicpO1xuICAgIH1cblxuICAgIGNvbnN0IGVkaXRDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBlZGl0Q29udGFpbmVyLmRhdGFzZXQuZHJvcGRvd24gPSBcIlwiO1xuICAgIGVkaXRDb250YWluZXIuY2xhc3NMaXN0LmFkZCgnZWRpdC1jb250YWluZXInKTtcbiAgICBsaXN0UmlnaHQuYXBwZW5kQ2hpbGQoZWRpdENvbnRhaW5lcik7XG5cbiAgICBjb25zdCB0aHJlZURvdHMgPSBjcmVhdGVTcGFuSWNvbignbW9yZV92ZXJ0Jyk7XG4gICAgdGhyZWVEb3RzLmRhdGFzZXQuZHJvcGRvd25CdXR0b24gPSBcIlwiO1xuICAgIGVkaXRDb250YWluZXIuYXBwZW5kQ2hpbGQodGhyZWVEb3RzKTtcblxufVxuXG5mdW5jdGlvbiBwcm9jZXNzRGF0ZURhdGEoZGF0ZSkge1xuICAgIGxldCBmb3JtYXR0ZWREYXRlO1xuICAgIGlmICghZGF0ZSkge1xuICAgICAgICBmb3JtYXR0ZWREYXRlID0gXCJObyBkdWUgZGF0ZVwiO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGZvcm1hdHRlZERhdGUgPSBkYXRlO1xuICAgIH1cblxuICAgIHJldHVybiBmb3JtYXR0ZWREYXRlO1xufVxuLy9mdW5jdGlvbiB0byBmaW5kIHRoZSBkYXRhLXByb2plY3QgaW5kZXggd2hlbiBhZGRpbmcgbmV3IHRhc2tzXG5mdW5jdGlvbiBmaW5kQ3VycmVudERhdGFQcm9qZWN0KCkge1xuICAgIGNvbnN0IHNlbGVjdGVkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlbGVjdGVkJyk7XG4gICAgcmV0dXJuIHNlbGVjdGVkLmRhdGFzZXQucHJvamVjdDtcbn1cblxuZXhwb3J0IHsgdXBkYXRlVGl0bGUsIGxpc3RFdmVudCwgZGlzcGxheVRhc2ssIGlkLCBhZGRUYXNrLCBwcm9jZXNzRGF0ZURhdGEgfTsiLCJpbXBvcnQgeyBkaXNwbGF5VGFzaywgdXBkYXRlVGl0bGUsIGlkIH0gZnJvbSBcIi4vY3JlYXRpbmdUYXNrXCI7XG5pbXBvcnQgeyByZXZlcnRFZGl0Rm9ybUxvY2F0aW9uIH0gZnJvbSBcIi4vZWRpdGluZ1Rhc2tcIjtcbmltcG9ydCB7IHJldmVydE9wdGlvbkxvY2F0aW9uIH0gZnJvbSBcIi4vZWRpdGluZ1Byb2plY3RcIjtcbmltcG9ydCB7IGNoZWNrV2hpY2hIb21lVGlsZSB9IGZyb20gXCIuL2hvbWVTZWN0aW9uXCI7XG5cblxuXG5mdW5jdGlvbiBjcmVhdGVFdmVudExpc3RlbmVyKCkge1xuICAgIC8vZXZlbnQgbGlzdGVybmVyIGZvciBjcmVhdGluZyBhIGZvcm0gZm9yIGFkZGluZyBwcm9qZWN0c1xuICAgIGNvbnN0IGNhbmNlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9qZWN0LWNhbmNlbC1idG4nKTtcbiAgICBjYW5jZWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhpZGVQcm9qZWN0Rm9ybSk7XG5cbiAgICBjb25zdCBhZGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYWRkLXByb2plY3QnKTtcbiAgICBhZGQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHNob3dQcm9qZWN0Rm9ybSk7XG5cbiAgICBjb25zdCBzdWJtaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJvamVjdC1mb3JtJyk7XG4gICAgc3VibWl0LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHByb2Nlc3NQcm9qZWN0SW5wdXQpO1xuXG4gICAgY29uc3QgbGVmdFBhbmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxlZnQtcGFuZWwnKTtcbiAgICBsZWZ0UGFuZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjaGVja1RpbGUpO1xuXG5cblxuICAgIGRpc3BsYXlQcm9qZWN0KHByb2plY3RMaXN0KTtcblxufVxuXG5cbi8vZ2V0IHByb2plY3QgbGlzdCBvZiBvYmplY3RzIGZyb20gbG9jYWsgc3RvcmFnZSBvciBzdGFydCB3aXRoIGVtcHR5XG5sZXQgZGVmYXVsdFByb2plY3RMaXN0ID0gW107XG5sZXQgcHJvamVjdExpc3QgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcIm15UHJvamVjdExpc3RcIik7XG5cbnByb2plY3RMaXN0ID0gSlNPTi5wYXJzZShwcm9qZWN0TGlzdCB8fCBKU09OLnN0cmluZ2lmeShkZWZhdWx0UHJvamVjdExpc3QpKTtcblxuLy9wcm9jZXNzIHRoZSBpbnB1dCBhbmQgcHJlcGFyZSB0byBjcmVhdGUgcHJvamVjdCBlbGVtZW50XG5mdW5jdGlvbiBwcm9jZXNzUHJvamVjdElucHV0KGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgbGV0IHByb2plY3ROYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Byb2plY3QtaW5wdXQnKS52YWx1ZTtcbiAgICBsZXQgZGF0YVByb2plY3QgPSBmaW5kTmV4dERhdGFzZXQoKTtcbiAgICBjb25zdCBuZXdQcm9qZWN0ID0gY3JlYXRlUHJvamVjdChkYXRhUHJvamVjdCwgcHJvamVjdE5hbWUpO1xuXG4gICAgcHJvamVjdExpc3QucHVzaChuZXdQcm9qZWN0KTtcbiAgICBzYXZlVG9Mb2NhbFN0b3JhZ2UoKTtcblxuICAgIGFkZFByb2plY3QoZGF0YVByb2plY3QsIHByb2plY3ROYW1lKTtcbiAgICBoaWRlUHJvamVjdEZvcm0oKTtcblxufVxuXG4vL3NhdmUgcHJvamVjdExpc3QgYW5kIGxhc3QgaWQgZGF0YSBvbiBsb2NhbCBzdG9yYWdlXG5mdW5jdGlvbiBzYXZlVG9Mb2NhbFN0b3JhZ2UoKSB7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJteVByb2plY3RMaXN0XCIsIEpTT04uc3RyaW5naWZ5KHByb2plY3RMaXN0KSk7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJjdXJyZW50SWRcIiwgKGlkKS50b1N0cmluZygpKTtcblxuXG59XG5cbi8vZGlzcGxheSB0aGUgbGlzdCBvZiBhbGwgcHJvamVjdHMgaW4gdGhlIGxlZnQgcGFuZWxcbmZ1bmN0aW9uIGRpc3BsYXlQcm9qZWN0KGFycmF5KSB7XG4gICAgYXJyYXkuZm9yRWFjaChwcm9qZWN0ID0+IHtcbiAgICAgICAgYWRkUHJvamVjdChwcm9qZWN0LmRhdGFQcm9qZWN0LCBwcm9qZWN0Lm5hbWUpO1xuICAgIH0pXG59XG4vL2NyZWF0ZSBhIHByb2plY3QgYW5kIGFkZCBpdCB0byB0aGUgbGlzdCBvZiBwcm9qZWN0cyBpbiBIVE07XG5mdW5jdGlvbiBhZGRQcm9qZWN0KGRhdGFQcm9qZWN0LCB0ZXh0SW5wdXQpIHtcbiAgICBjb25zdCBwcm9qZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3QnKTtcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Byb2plY3QtZm9ybScpO1xuXG4gICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZSgnZGF0YS1wcm9qZWN0JywgYCR7ZGF0YVByb2plY3R9YCk7XG4gICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3RpbGUnLCAnZGF0YS10aWxlJyk7XG4gICAgcHJvamVjdC5pbnNlcnRCZWZvcmUoY29udGFpbmVyLCBmb3JtKTtcblxuICAgIC8vbWVudSB0aHJlZSBsaW5lcyBpY29uXG4gICAgY29uc3QgbWVudUljb24gPSBjcmVhdGVTcGFuSWNvbignbWVudScpO1xuICAgIG1lbnVJY29uLnNldEF0dHJpYnV0ZSgnZGF0YS1kcmFnJywgJycpO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChtZW51SWNvbik7XG4gICAgLy9uYW1lIGFuZCBudW1iZXIgc3RhdHVzXG4gICAgY29uc3QgcHJvamVjdEluZm8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBwcm9qZWN0SW5mby5jbGFzc0xpc3QuYWRkKCdwcm9qZWN0LWluZm8nKTtcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocHJvamVjdEluZm8pO1xuXG4gICAgY29uc3QgcHJvamVjdE5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBwcm9qZWN0TmFtZS5jbGFzc0xpc3QuYWRkKCdwcm9qZWN0LW5hbWUnKTtcbiAgICBwcm9qZWN0TmFtZS50ZXh0Q29udGVudCA9IHRleHRJbnB1dDtcblxuICAgIHByb2plY3RJbmZvLmFwcGVuZENoaWxkKHByb2plY3ROYW1lKTtcbiAgICAvL3RocmVlIGRvdHMgb24gdGhlIHJpZ2h0IHNlY3Rpb25cbiAgICBjb25zdCBlZGl0RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgZWRpdERpdi5jbGFzc0xpc3QuYWRkKCdlZGl0LWNvbnRhaW5lcicpO1xuICAgIGVkaXREaXYuc2V0QXR0cmlidXRlKCdkYXRhLWRyb3Bkb3duJywgJycpO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChlZGl0RGl2KTtcblxuICAgIGNvbnN0IGVkaXRJY29uID0gY3JlYXRlU3Bhbkljb24oJ21vcmVfdmVydCcpO1xuICAgIGVkaXRJY29uLnNldEF0dHJpYnV0ZShcImRhdGEtZHJvcGRvd24tYnV0dG9uXCIsIFwiXCIpO1xuICAgIGVkaXREaXYuYXBwZW5kQ2hpbGQoZWRpdEljb24pO1xuXG59XG4vL2NyZWF0ZSBzcGFuIGljb24gb2YgZ29vZ2xlIG1hdGVyaWFsc1xuZnVuY3Rpb24gY3JlYXRlU3Bhbkljb24obmFtZSkge1xuICAgIGNvbnN0IGljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgaWNvbi5jbGFzc0xpc3QuYWRkKCdtYXRlcmlhbC1pY29ucy1yb3VuZCcpO1xuICAgIGljb24udGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHJldHVybiBpY29uO1xufVxuXG4vL2ZpbmQgbmV4dCBkYXRhLXNldFxuY29uc3QgZmluZE5leHREYXRhc2V0ID0gKCkgPT4ge1xuICAgIGNvbnN0IGFsbHByb2plY3RzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIltkYXRhLXByb2plY3RdXCIpO1xuICAgIHJldHVybiBhbGxwcm9qZWN0cy5sZW5ndGg7XG59XG5cbi8vIHJlbW92ZSBhZGQgdGFzayBCdG4gd2hlbiBob21lVGlsZXMgaXMgc2VsZWN0ZWRcbmZ1bmN0aW9uIGhpZGVBZGRUYXNrQnRuKCkge1xuICAgIGNvbnN0IGFkZFRhc2tCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYWRkLWxpc3QnKTtcbiAgICBhZGRUYXNrQnRuLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xufVxuXG4vL2NoZWNrIHRvIHNlZSB3aGF0IHRpbGUgaXMgc2VsZWN0ZWRcbmZ1bmN0aW9uIGNoZWNrVGlsZShlKSB7XG4gICAgbGV0IGhvbWVUaWxlID0gZS50YXJnZXQuY2xvc2VzdCgnLmhvbWUgLnRpbGUnKTtcbiAgICBsZXQgcHJvamVjdFRpbGUgPSBlLnRhcmdldC5jbG9zZXN0KCcucHJvamVjdCAudGlsZScpO1xuXG5cbiAgICBpZiAoaG9tZVRpbGUgIT0gbnVsbCkge1xuICAgICAgICBjb25zdCB0aXRsZSA9IGhvbWVUaWxlLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLW5hbWVdJyk7XG4gICAgICAgIHNlbGVjdFRpbGUoaG9tZVRpbGUpO1xuICAgICAgICByZXZlcnRPcHRpb25Mb2NhdGlvbigpO1xuICAgICAgICAvLyBjaGVja1doaWNoSG9tZVRpbGUoaG9tZVRpbGUpO1xuICAgICAgICB1cGRhdGVUaXRsZSh0aXRsZSk7XG4gICAgICAgIGhpZGVBZGRUYXNrQnRuKCk7XG4gICAgfSBlbHNlIGlmIChwcm9qZWN0VGlsZSAhPSBudWxsKSB7XG4gICAgICAgIGNvbnN0IHRpdGxlID0gcHJvamVjdFRpbGUucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LW5hbWVcIik7XG4gICAgICAgIGxldCBkYXRhUHJvamVjdCA9IHByb2plY3RUaWxlLmRhdGFzZXQucHJvamVjdDtcblxuICAgICAgICByZXZlcnRPcHRpb25Mb2NhdGlvbigpO1xuXG4gICAgICAgIGRpc3BsYXlUYXNrKGRhdGFQcm9qZWN0KTtcbiAgICAgICAgc2VsZWN0VGlsZShwcm9qZWN0VGlsZSk7XG4gICAgICAgIHVwZGF0ZVRpdGxlKHRpdGxlKTtcbiAgICAgICAgc2hvd0FkZFRhc2tCdG4oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG59XG4vL2NyZWF0ZSBwcm9qZWN0IGZhY3RvcnkgZnVuY3Rpb25cbmNvbnN0IGNyZWF0ZVByb2plY3QgPSAoZGF0YVByb2plY3QsIG5hbWUpID0+IHtcbiAgICBjb25zdCB0YXNrTGlzdCA9IFtdO1xuICAgIGNvbnN0IHRhc2tOdW0gPSB0YXNrTGlzdC5sZW5ndGg7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZGF0YVByb2plY3QsXG4gICAgICAgIG5hbWUsXG4gICAgICAgIHRhc2tMaXN0LFxuICAgICAgICB0YXNrTnVtXG4gICAgfVxufVxuXG5cbi8vcG9wIHVwIHRoZSBwcm9qZWN0IGZvcm1cbmZ1bmN0aW9uIHNob3dQcm9qZWN0Rm9ybSgpIHtcbiAgICBjb25zdCBwcm9qZWN0Rm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9qZWN0LWZvcm0nKTtcbiAgICBwcm9qZWN0Rm9ybS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICAvL2ZvY3VzIG9uIGlucHV0IGZpZWxkXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2plY3QtaW5wdXQnKS5mb2N1cygpO1xufVxuLy9oaWRlIHRoZSBwcm9qZWN0IGZvcm1cbmZ1bmN0aW9uIGhpZGVQcm9qZWN0Rm9ybSgpIHtcbiAgICBjb25zdCBwcm9qZWN0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcm9qZWN0LWZvcm0nKTtcbiAgICBjb25zdCBwcm9qZWN0SW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJvamVjdC1pbnB1dCcpO1xuXG4gICAgcHJvamVjdElucHV0LnZhbHVlID0gXCJcIjtcbiAgICBwcm9qZWN0Rm9ybS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbn1cblxuZnVuY3Rpb24gc2VsZWN0VGlsZShub2RlKSB7XG4gICAgY29uc3Qgc2VsZWN0ZWRUaWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlbGVjdGVkJyk7XG5cbiAgICBzZWxlY3RlZFRpbGUuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKTtcbiAgICBub2RlLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7XG5cbn1cblxuLy9zaG93IGFkZFRhc2tCdG4gd2hlbiBwcmplY3QgdGlsZVxuZnVuY3Rpb24gc2hvd0FkZFRhc2tCdG4oKSB7XG4gICAgY29uc3QgYWRkVGFza0J0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRkLWxpc3RcIik7XG4gICAgYWRkVGFza0J0bi5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZGVuXCIpO1xuXG59XG5cbmV4cG9ydCB7IGNyZWF0ZUV2ZW50TGlzdGVuZXIsIGNyZWF0ZVNwYW5JY29uLCBwcm9qZWN0TGlzdCwgc2F2ZVRvTG9jYWxTdG9yYWdlLCBoaWRlQWRkVGFza0J0biwgY3JlYXRlUHJvamVjdCB9OyIsImltcG9ydCB7IGNyZWF0ZUV2ZW50TGlzdGVuZXIgfSBmcm9tIFwiLi9jcmVhdGluZ1Byb2plY3RcIjtcbmltcG9ydCB7IGxpc3RFdmVudCB9IGZyb20gXCIuL2NyZWF0aW5nVGFza1wiO1xuaW1wb3J0IHsgZWRpdENvbnRhaW5lckV2ZW50TGlzdGVuZXIgfSBmcm9tIFwiLi9lZGl0aW5nUHJvamVjdFwiO1xuXG5cbmNyZWF0ZUV2ZW50TGlzdGVuZXIoKTtcbmxpc3RFdmVudCgpO1xuZWRpdENvbnRhaW5lckV2ZW50TGlzdGVuZXIoKTtcbi8vaGlkZSBzaWRlIG1lbnUgZXZlbnQgbGlzdGVuZXJcbmNvbnN0IGhpZGRlbk1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGlkZGVuLW1lbnUnKTtcbmhpZGRlbk1lbnUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgY29uc3QgbGVmdFBhbmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxlZnQtcGFuZWwnKTtcbiAgICBsZWZ0UGFuZWwuY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJyk7XG59KTsiXSwibmFtZXMiOlsic2hvd0Ryb3BEb3duIiwiZSIsImlzRHJvcERvd25CdXR0b24iLCJ0YXJnZXQiLCJtYXRjaGVzIiwiY2xvc2VzdCIsImN1cnJlbnREcm9wRG93biIsImVkaXRDb250YWluZXIiLCJwcm9qZWN0T3B0aW9uIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiYXBwZW5kQ2hpbGQiLCJsaXN0T3B0aW9uIiwiZ2V0RWxlbWVudEJ5SWQiLCJyZWxvY2F0ZU9wdGlvbiIsInNldFRpbWVvdXQiLCJ0b2dnbGUiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImRyb3Bkb3duIiwic2hvd1JlbmFtZUZvcm0iLCJlZGl0Q29udGFpbmVyTm9kZSIsInBhcmVudE5vZGUiLCJ0aWxlTm9kZSIsImhpZGVEcm9wRG93biIsImNvbnRhaW5zIiwicmV2ZXJ0UmVuYW1lRm9ybUxvY2F0aW9uIiwiZGlzcGxheVJlbmFtZWRQcm9qZWN0IiwicHJvamVjdE5vZGUiLCJyZW5hbWVGb3JtIiwibmFtZSIsInRleHRDb250ZW50IiwidmFsdWUiLCJpbnNlcnRCZWZvcmUiLCJyZWxvY2F0ZVJlbmFtZUZvcm0iLCJmb3JtIiwiYW5pbWF0ZVJlbmFtZUZvcm0iLCJmb2N1cyIsImFkZCIsImRlbGV0ZVByb2plY3QiLCJ0aWxlIiwiaW5kZXgiLCJkYXRhc2V0IiwicHJvamVjdCIsInRvZGF5IiwibmFtZU5vZGUiLCJ1cGRhdGVUaXRsZSIsInJldmVydE9wdGlvbkxvY2F0aW9uIiwiaSIsImRhdGFOdW0iLCJwcm9qZWN0TGlzdCIsImRhdGFQcm9qZWN0Iiwic29ydCIsImEiLCJiIiwic2F2ZVRvTG9jYWxTdG9yYWdlIiwic29ydEFycmF5Iiwic3BsaWNlIiwiZmluZFNlbGVjdGVkVGFzayIsImxpc3RJZCIsInJlZHVjZSIsImFjYyIsImN1cnJlbnRUYXNrIiwidGFza0xpc3QiLCJmaW5kIiwidGFzayIsImlkIiwiaGlkZUxpc3RGb3JtIiwibGlzdEZvcm0iLCJsaXN0SW5wdXQiLCJsaXN0SW5wdXREZXRhaWwiLCJsaXN0SW5wdXREYXRlIiwiTnVtYmVyIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImFkZFRhc2siLCJ0aXRsZSIsImRldGFpbHMiLCJkYXRlIiwiY29tcGxldGVkIiwiaW1wb3J0YW50IiwidWwiLCJsaSIsImNyZWF0ZUVsZW1lbnQiLCJ1bmNoZWNrZWQiLCJsaXN0RGV0YWlscyIsInRhc2tUaXRsZSIsInRhc2tEZXRhaWxzIiwiZGF0ZURpdiIsImxpc3RSaWdodCIsInN0YXJPdXRsaW5lIiwiY3JlYXRlU3Bhbkljb24iLCJzdGFyIiwidGhyZWVEb3RzIiwiZHJvcGRvd25CdXR0b24iLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsImFkZFByb2plY3QiLCJ0ZXh0SW5wdXQiLCJjb250YWluZXIiLCJzZXRBdHRyaWJ1dGUiLCJtZW51SWNvbiIsInByb2plY3RJbmZvIiwicHJvamVjdE5hbWUiLCJlZGl0RGl2IiwiZWRpdEljb24iLCJpY29uIiwicGFyc2UiLCJmaW5kTmV4dERhdGFzZXQiLCJsZW5ndGgiLCJjcmVhdGVQcm9qZWN0IiwidGFza051bSIsImhpZGVQcm9qZWN0Rm9ybSIsInByb2plY3RGb3JtIiwic2VsZWN0VGlsZSIsIm5vZGUiLCJhZGRFdmVudExpc3RlbmVyIiwicHJldmVudERlZmF1bHQiLCJuZXdQcm9qZWN0IiwicHVzaCIsImhvbWVUaWxlIiwicHJvamVjdFRpbGUiLCJkaXNwbGF5VGFzayIsImRhdGVJbnB1dCIsImZvcm1hdHRlZERhdGUiLCJwcm9jZXNzRGF0ZURhdGEiLCJsaXN0SUQiLCJuZXdUYXNrIiwiY3JlYXRlVGFzayIsImlzU3Rhckljb24iLCJpc0NpcmNsZUljb24iLCJpc0RlbGV0ZUJ0biIsImlzRWRpdEJ0biIsIm5leHRFbGVtZW50U2libGluZyIsInN0eWxlSW1wb3J0YW50VGFzayIsInNlbGVjdGVkVGFzayIsInVwZGF0ZUltcG9ydGFudFRhc2siLCJ1bmNoZWNrZWROb2RlIiwic3R5bGVDb21wbGV0ZWRUYXNrIiwidXBkYXRlQ29tcGxldGVkVGFzayIsImxpc3ROb2RlIiwiZmlsdGVyIiwiZGVsZXRlVGFzayIsImVkaXRMaXN0Rm9ybSIsInRhc2tEYXRlIiwidGl0bGVJbnB1dCIsImRldGFpbElucHV0IiwicmVsb2NhdGVFZGl0TGlzdEZvcm0iLCJzaG93RWRpdEZvcm0iLCJvcHRpb24iLCJmaXJzdEVsZW1lbnRDaGlsZCIsImxhc3RFbGVtZW50Q2hpbGQiLCJyZW5hbWVJbnB1dCIsInByb2Nlc3NSZW5hbWVJbnB1dCIsImVkaXRDb250YWluZXJFdmVudExpc3RlbmVyIl0sInNvdXJjZVJvb3QiOiIifQ==